<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ä¸æ­£ç»æ•°æ®ç§‘å­¦å®¶</title>
  
  <subtitle>Enjoy everything fun and challenging</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://frankchen.xyz/"/>
  <updated>2018-05-31T11:39:43.506Z</updated>
  <id>http://frankchen.xyz/</id>
  
  <author>
    <name>æ±Ÿå—æ¶ˆå¤</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Mac åŒå¼€ ss æ–¹æ³•</title>
    <link href="http://frankchen.xyz/2018/05/31/dual-ss-on-mac/"/>
    <id>http://frankchen.xyz/2018/05/31/dual-ss-on-mac/</id>
    <published>2018-05-31T11:24:17.000Z</published>
    <updated>2018-05-31T11:39:43.506Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªä»£ç†ï¼Œè­¬å¦‚ä¸€ä¸ªç”¨æ¥è¿éœ€è¦ç»è¿‡è·³æ¿æœºä»£ç†çš„é›†ç¾¤æœåŠ¡ï¼Œä¸€ä¸ªåˆ™ç”¨æ¥ç§‘å­¦ä¸Šç½‘ï¼Œä¸åœåˆ‡æ¢éº»çƒ¦ä¸”ä»£ä»·æ¯”è¾ƒé«˜ï¼Œé‚£æˆ‘ä»¬é™¤äº†ShadowsocksX-NGå®¢æˆ·ç«¯ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å‘½ä»¤è¡Œçš„æ–¹å¼å†å¼€å¯ä¸€ä¸ªï¼Œ<br><img src="/images/15277663104280.jpg" alt=""></p><p><img src="/images/15277666370736.jpg" alt=""></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># ä½¿ç”¨Homebrewå®‰è£…</span></div><div class="line">brew install shadowsocks-libev</div><div class="line"><span class="comment"># ç¼–è¾‘é…ç½®ä¿¡æ¯</span></div><div class="line">sudo vim /usr/<span class="built_in">local</span>/etc/shadowsocks-libev.json</div><div class="line"><span class="comment"># æ ¼å¼å¦‚ä¸‹ï¼Œæ³¨æ„ä¸ShadowsocksX-NGçš„local_portä¹Ÿå°±æ˜¯socks5ä¸åŒ</span></div><div class="line">&#123;</div><div class="line">    <span class="string">"server"</span>:<span class="string">"107.167.185.234"</span>,</div><div class="line">    <span class="string">"server_port"</span>:11499,</div><div class="line">    <span class="string">"local_port"</span>:1079,</div><div class="line">    <span class="string">"password"</span>:<span class="string">"xxxxxxxx"</span>,</div><div class="line">    <span class="string">"timeout"</span>:600,</div><div class="line">    <span class="string">"method"</span>:<span class="string">"aes-256-gcm"</span></div><div class="line">&#125;</div><div class="line"><span class="comment"># é‡å¯ shadowsocks-libevï¼Œä¼šè‡ªåŠ¨æ·»åŠ å¼€æœºè‡ªå¯</span></div><div class="line">brew services restart shadowsocks-libev</div></pre></td></tr></table></figure><p>å†åœ¨SwitchyOmegaé‡Œé¢è®¾ç½®ä¸¤ä¸ªä¸åŒçš„ä»£ç†å³å¯ï¼Œ<br><img src="/images/15277663992132.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªä»£ç†ï¼Œè­¬å¦‚ä¸€ä¸ªç”¨æ¥è¿éœ€è¦ç»è¿‡è·³æ¿æœºä»£ç†çš„é›†ç¾¤æœåŠ¡ï¼Œä¸€ä¸ªåˆ™ç”¨æ¥ç§‘å­¦ä¸Šç½‘ï¼Œä¸åœåˆ‡æ¢éº»çƒ¦ä¸”ä»£ä»·æ¯”è¾ƒé«˜ï¼Œé‚£æˆ‘ä»¬é™¤äº†ShadowsocksX-NGå®¢æˆ·ç«¯ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å‘½ä»¤è¡Œçš„æ–¹å¼å†å¼€å¯ä¸€ä¸ªï¼Œ&lt;br&gt;&lt;img src=&quot;/images/15277663104280.
      
    
    </summary>
    
    
      <category term="Mac" scheme="http://frankchen.xyz/tags/Mac/"/>
    
  </entry>
  
  <entry>
    <title>ä» spark è·å– è¡¨æ ¼å†…å®¹çš„æ–¹æ³• ğŸ¦„</title>
    <link href="http://frankchen.xyz/2018/05/03/get-table-from-spark/"/>
    <id>http://frankchen.xyz/2018/05/03/get-table-from-spark/</id>
    <published>2018-05-03T12:51:14.000Z</published>
    <updated>2018-05-03T13:14:06.639Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="number">1</span> <span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> *</div><div class="line"> <span class="number">2</span> <span class="keyword">import</span> pyspark</div><div class="line"> <span class="number">3</span> <span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line"> <span class="number">4</span>     spark = SparkSession.builder.master(<span class="string">"yarn"</span>).appName(<span class="string">"pyspark location process"</span>).enableHiveSupport().getOrCreate()</div><div class="line"> <span class="number">5</span>     sc = spark.sparkContext</div><div class="line"> <span class="number">6</span>    <span class="comment"># spark.sql('show databases').show()</span></div><div class="line"> <span class="number">7</span>     spark.sql(<span class="string">'use annals'</span>).show()</div><div class="line"> <span class="number">8</span>    <span class="comment"># spark.sql('describe gps2').show()</span></div><div class="line"> <span class="number">9</span>     spark.sql(<span class="string">'select * from gps2 limit 1'</span>).show()</div><div class="line"><span class="number">10</span>     sql_df = spark.sql(<span class="string">'select uid, lat, lgt, app_adjust_time from gps2 limit 5'</span>)</div><div class="line"><span class="number">11</span>     <span class="comment">#sql_df.show()</span></div><div class="line"><span class="number">12</span>     print(type(sql_df))</div><div class="line"><span class="number">13</span>     sql_df.write.save(<span class="string">"data/GrMWKfDj9eIjsRuh.parquet"</span>)</div></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±åœ¨hdfsä¸Šå¾—åˆ°äº†ä¸€ä»½parquetæ ¼å¼çš„æ–‡ä»¶ã€‚</p><p>ä»hdfs å¤åˆ¶åˆ°è·³æ¿æœº<br><code>hadoop fs  -get GrMWKfDj9eIjsRuh.parquet .</code><br>å†scp ä¹‹ç±»çš„ å¤åˆ¶åˆ°æœ¬åœ°å³å¯ã€‚ğŸ¶ğŸ’</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/d
      
    
    </summary>
    
    
      <category term="spark" scheme="http://frankchen.xyz/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>Mac é€šè¿‡ socks5 ä»£ç† è¿æ¥ ssh çš„æ–¹æ³•ğŸ†</title>
    <link href="http://frankchen.xyz/2018/05/03/mac-ssh-through-socks5-proxy/"/>
    <id>http://frankchen.xyz/2018/05/03/mac-ssh-through-socks5-proxy/</id>
    <published>2018-05-03T09:08:10.000Z</published>
    <updated>2018-05-03T09:15:18.355Z</updated>
    
    <content type="html"><![CDATA[<p>ç»è¿‡ä¸€ç•ªç—›è‹¦çš„æŠ˜è…¾ï¼Œæˆ‘æ‰å‘ç°<strong>socks,httpä»£ç†ç­‰ä½¿ç”¨çš„æ˜¯TCPæˆ–UDPåè®®, è€Œpingå‘½ä»¤åˆ™æ˜¯ICMPåè®®, æ‰€ä»¥proxychains4å¯¹pingå‘½ä»¤æ— æ•ˆ.</strong>ï¼Œæœ€ç»ˆåˆæŠ˜è…¾è¿‡tsocksç­‰å’Œproxychainsä¸€æ ·å¾·è¡Œçš„ä»¥åï¼Œæœ€ç»ˆåœ¨ä¸‡èƒ½çš„Stack Overflowæ‰¾åˆ°<a href="https://serverfault.com/questions/315605/ssh-through-a-socks-proxy-client-openssh-os-x" target="_blank" rel="external">ç­”æ¡ˆ</a>ï¼šå³é€šè¿‡NetCat (nc)è¿æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">vim ~/.ssh/config</div><div class="line"><span class="comment"># æ·»åŠ ä»¥ä¸‹å†…å®¹</span></div><div class="line">Host 52.* <span class="comment"># è¿™é‡Œå¯ä»¥é€šé…ä¹Ÿå¯ä»¥æŒ‡å®šIP</span></div><div class="line">    ProxyCommand nc -X 5 -x 127.0.0.1:1079 %h %p</div><div class="line">    <span class="comment"># "5" æ˜¯ SOCKS 5, "1079" æ˜¯æœ¬åœ°socksç«¯å£</span></div></pre></td></tr></table></figure><p>ä¹‹åç›´æ¥ä½¿ç”¨<code>ssh</code>å‘½ä»¤è¿æ¥å³å¯ğŸ˜ğŸ˜‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç»è¿‡ä¸€ç•ªç—›è‹¦çš„æŠ˜è…¾ï¼Œæˆ‘æ‰å‘ç°&lt;strong&gt;socks,httpä»£ç†ç­‰ä½¿ç”¨çš„æ˜¯TCPæˆ–UDPåè®®, è€Œpingå‘½ä»¤åˆ™æ˜¯ICMPåè®®, æ‰€ä»¥proxychains4å¯¹pingå‘½ä»¤æ— æ•ˆ.&lt;/strong&gt;ï¼Œæœ€ç»ˆåˆæŠ˜è…¾è¿‡tsocksç­‰å’Œproxychainsä¸€æ ·å¾·è¡Œçš„ä»¥åï¼Œæœ€ç»ˆåœ¨
      
    
    </summary>
    
    
      <category term="Mac" scheme="http://frankchen.xyz/tags/Mac/"/>
    
  </entry>
  
  <entry>
    <title>moving averge æ»‘åŠ¨å¹³å‡</title>
    <link href="http://frankchen.xyz/2018/04/25/moving-averge/"/>
    <id>http://frankchen.xyz/2018/04/25/moving-averge/</id>
    <published>2018-04-25T14:58:46.000Z</published>
    <updated>2018-04-26T03:49:59.376Z</updated>
    
    <content type="html"><![CDATA[<p>moving averge å³æ»‘åŠ¨å¹³å‡ï¼Œæ—¶é—´åºåˆ—å¤„ç†ä¸­å¸¸è§çš„æ–¹æ³•ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¯¹äºä¸€ä¸ªç»™å®šæ•°åˆ—ï¼Œè®¾å®šä¸€ä¸ªçª—å£å€¼Nï¼Œä¾æ¬¡å–ç¬¬1é¡¹~ç¬¬Né¡¹ï¼Œç¬¬2é¡¹~ç¬¬N+1é¡¹ï¼Œç¬¬3é¡¹~ç¬¬N+2é¡¹çš„å¹³å‡å€¼ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><a id="more"></a><p>æ•°æ®æ¥è‡ª<a href="http://blog.topspeedsnail.com/wp-content/uploads/2016/12/%E9%93%81%E8%B7%AF%E5%AE%A2%E8%BF%90%E9%87%8F.csv" target="_blank" rel="external">é“è·¯å®¢è¿é‡.csvï¼ˆ2005-2016æœˆåº¦æ•°æ®ï¼‰</a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> io</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> pylab</div><div class="line">pylab.style.use(<span class="string">'bmh'</span>)</div><div class="line"><span class="keyword">from</span> pylab <span class="keyword">import</span> rcParams</div><div class="line">rcParams[<span class="string">'figure.figsize'</span>] = <span class="number">10</span>, <span class="number">8</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">moving_average</span><span class="params">(l, N)</span>:</span></div><div class="line">sum = <span class="number">0</span></div><div class="line">result = list( <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> l)</div><div class="line"> </div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range( <span class="number">0</span>, N ):</div><div class="line">       <span class="comment"># ä»å·¦åˆ°å³é€æ¸æ·»åŠ indexåœ¨Nä¹‹å†…çš„æ•°å­—</span></div><div class="line">sum = sum + l[i]</div><div class="line">result[i] = sum / (i+<span class="number">1</span>)</div><div class="line"> </div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range( N, len(l) ):</div><div class="line">       <span class="comment"># åŠ å…¥æœ€å³è¾¹æ•°å­—å‡å»æœ€å·¦è¾¹æ•°å­—</span></div><div class="line">sum = sum - l[i-N] + l[i]</div><div class="line">result[i] = sum / N</div><div class="line"> </div><div class="line"><span class="keyword">return</span> result</div><div class="line"> </div><div class="line"><span class="comment"># ä½¿ç”¨æ•ˆç‡æ›´é«˜çš„numpy</span></div><div class="line"><span class="comment"># http://stackoverflow.com/questions/13728392/moving-average-or-running-mean</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fast_moving_average</span><span class="params">(x, N)</span>:</span></div><div class="line"><span class="keyword">return</span> np.convolve(x, np.ones((N,))/N)[(N<span class="number">-1</span>):]</div><div class="line"> </div><div class="line">url = <span class="string">'é“è·¯å®¢è¿é‡.csv'</span></div><div class="line"></div><div class="line"> </div><div class="line">df = pd.read_csv(url)  <span class="comment"># python2ä½¿ç”¨StringIO.StringIO</span></div><div class="line"> </div><div class="line">data = np.array(df[<span class="string">'é“è·¯å®¢è¿é‡_å½“æœŸå€¼(ä¸‡äºº)'</span>])</div><div class="line"> </div><div class="line">dic = &#123;&#125;</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">3</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">20</span>]:</div><div class="line">    ma_data = moving_average(data, i)</div><div class="line">    dic[i] = ma_data</div><div class="line">ma_data_df = pd.DataFrame(dic)</div><div class="line"></div><div class="line">ma_data_df.plot()</div></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¶‹åŠ¿é€æ¸å˜å¾—å¹³æ»‘ï¼Œå³å¯¹å±€éƒ¨éœ‡è¡ä¸æ•æ„Ÿã€‚</p><p><img src="/images/download.png" alt="download"></p><p>ä½¿ç”¨numpy.convolveæ˜¯ä¸€ç§æ›´æ–¹ä¾¿çš„æ–¹æ³•ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å…¶æœ‰ä¸‰ç§modeï¼Œåˆ†åˆ«æ˜¯â€™fullâ€™ï¼ˆå•ä¸ªé‡å ä¹Ÿè®¡ç®—ï¼‰, â€˜sameâ€™ï¼ˆå¼ºåˆ¶ç­‰é•¿ï¼‰, â€˜validâ€™ï¼ˆå®Œå…¨é‡å ï¼‰ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fast_moving_average</span><span class="params">(x, N, mode)</span>:</span></div><div class="line"><span class="comment"># return np.convolve(x, np.ones((N,))/N, mode='valid')[(N-1):]</span></div><div class="line"><span class="keyword">return</span> np.convolve(x, np.ones((N,))/N, mode=mode)</div><div class="line">dic = &#123;&#125;</div><div class="line">modes = [<span class="string">'full'</span>, <span class="string">'same'</span>, <span class="string">'valid'</span>]</div><div class="line">i = <span class="number">10</span></div><div class="line"><span class="keyword">for</span> mode <span class="keyword">in</span> modes:</div><div class="line">    ma_data = fast_moving_average(data, i, mode)</div><div class="line">    pylab.plot(ma_data)</div><div class="line">pylab.legend(modes)</div></pre></td></tr></table></figure><p><img src="/images/download%20-1-.png" alt="download -1-"></p><p>å‚è€ƒè‡ªæ–—å¤§ç†Šçš„åšå®¢<a href="http://blog.topspeedsnail.com/archives/11022" target="_blank" rel="external">MovingAverage-æ»‘åŠ¨å¹³å‡ â€“ WTF Daily Blog</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;moving averge å³æ»‘åŠ¨å¹³å‡ï¼Œæ—¶é—´åºåˆ—å¤„ç†ä¸­å¸¸è§çš„æ–¹æ³•ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¯¹äºä¸€ä¸ªç»™å®šæ•°åˆ—ï¼Œè®¾å®šä¸€ä¸ªçª—å£å€¼Nï¼Œä¾æ¬¡å–ç¬¬1é¡¹~ç¬¬Né¡¹ï¼Œç¬¬2é¡¹~ç¬¬N+1é¡¹ï¼Œç¬¬3é¡¹~ç¬¬N+2é¡¹çš„å¹³å‡å€¼ï¼Œä»¥æ­¤ç±»æ¨ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="time series" scheme="http://frankchen.xyz/tags/time-series/"/>
    
  </entry>
  
  <entry>
    <title>keras ä¸­æ¨¡å‹çš„ä¿å­˜åŠé‡ç”¨</title>
    <link href="http://frankchen.xyz/2018/04/19/keras-reuse-model/"/>
    <id>http://frankchen.xyz/2018/04/19/keras-reuse-model/</id>
    <published>2018-04-19T08:50:00.000Z</published>
    <updated>2018-04-25T11:57:18.773Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15135840798621.jpg" alt=""><br>æ·±åº¦å­¦ä¹ ä¸­å¦‚ä½•ä¿å­˜æœ€ä½³æ¨¡å‹ï¼Œå¦‚ä½•é‡ç”¨å·²ç»ä¿å­˜çš„æ¨¡å‹ï¼Ÿæœ¬æ–‡ä¸»è¦ä»‹ç»Keras ä¿å­˜åŠé‡ç”¨æ¨¡å‹çš„æ–¹æ³•<br><a id="more"></a></p><h2 id="ä¿å­˜æ¨¡å‹"><a href="#ä¿å­˜æ¨¡å‹" class="headerlink" title="ä¿å­˜æ¨¡å‹"></a>ä¿å­˜æ¨¡å‹</h2><p>å¦‚ä¸‹ï¼Œæˆ‘ä»¬é¢„å®šä¹‰ä¿å­˜çš„<code>hdf5</code>æ–‡ä»¶åï¼Œå†åˆå§‹åŒ–<code>ModelCheckpoint</code>ï¼Œå°†å…¶åŠ å…¥Kerasçš„callbacké‡Œï¼ˆå³æ¯ä¸ªbatchç»“æŸååšçš„äº‹æƒ…ï¼‰ï¼Œé‚£ä¹ˆæ¨¡å‹å°±ä¼šåœ¨æ¯æ¬¡batchç»“æŸåå¯¹æ¯”ï¼Œä¿å­˜æœ€å¥½çš„æ¨¡å‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> keras.callbacks <span class="keyword">import</span> ModelCheckpoint</div><div class="line"></div><div class="line"><span class="comment"># create model</span></div><div class="line">model = Sequential()</div><div class="line">model.add(...)</div><div class="line">model.add(...)</div><div class="line">model.add(...)</div><div class="line"><span class="comment"># Compile model</span></div><div class="line">model.compile(...)</div><div class="line"><span class="comment"># checkpoint</span></div><div class="line">filepath=<span class="string">"weights-&#123;epoch:02d&#125;-&#123;val_acc:.2f&#125;.hdf5"</span></div><div class="line">checkpoint = ModelCheckpoint(filepath, monitor=<span class="string">'val_acc'</span>, verbose=<span class="number">1</span>, save_best_only=<span class="keyword">True</span>, mode=<span class="string">'max'</span>)</div><div class="line"><span class="comment"># Fit the model</span></div><div class="line">model.fit(X, Y, validation_split=<span class="number">0.33</span>, epochs=<span class="number">150</span>, batch_size=<span class="number">10</span>, callbacks=[checkpoint], verbose=<span class="number">0</span>)</div></pre></td></tr></table></figure><p>ç»“æŸåï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°å¦‚ä¸‹çš„ç»“æœï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">weights-53-0.76.hdf5</div><div class="line">weights-71-0.76.hdf5</div><div class="line">weights-77-0.78.hdf5</div><div class="line">weights-99-0.78.hdf5</div></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬åªæƒ³ä¿å­˜ä¸€ä¸ªæœ€å¥½çš„æ¨¡å‹ï¼Œé‚£ä¹ˆæŠŠä¿å­˜æ–‡ä»¶åå­—å›ºå®šä¸º<code>filepath=&quot;weights.best.hdf5&quot;</code>å³å¯ã€‚</p><h2 id="loadæ¨¡å‹"><a href="#loadæ¨¡å‹" class="headerlink" title="loadæ¨¡å‹"></a>loadæ¨¡å‹</h2><p>æ³¨æ„ï¼Œä¹‹å‰ä¿å­˜çš„åªæ˜¯æ¨¡å‹çš„weightsï¼Œé‡æ–°loadéœ€è¦å†æ¬¡å®šä¹‰æ¨¡å‹ç»“æ„å†load weightså¹¶å†æ¬¡combineï¼Œä¾‹å¦‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> keras.callbacks <span class="keyword">import</span> ModelCheckpoint</div><div class="line"><span class="comment"># create model</span></div><div class="line">model = Sequential()</div><div class="line">model.add(...)</div><div class="line">model.add(...)</div><div class="line">model.add(...)</div><div class="line"><span class="comment"># load weights</span></div><div class="line">model.load_weights(<span class="string">"weights.best.hdf5"</span>)</div><div class="line"><span class="comment"># Compile model </span></div><div class="line">model.compile(...)</div><div class="line"><span class="comment"># estimate accuracy </span></div><div class="line">scores = model.evaluate(X, Y, verbose=<span class="number">0</span>)</div><div class="line">print(<span class="string">'&#123;&#125;: &#123;:.2%&#125;'</span>.format(model.metrics_names[<span class="number">1</span>], scores[<span class="number">1</span>]))</div></pre></td></tr></table></figure><p>å¦‚æœä¹‹å‰é€‰æ‹©äº†è¿æ¨¡å‹ç»“æ„ä¹Ÿä¸€èµ·ä¿å­˜ï¼ˆå³åœ¨<code>ModelCheckpoint</code>ä¸­é€‰æ‹©<code>save_weights_only=False</code>ï¼‰ï¼Œé‚£ä¹ˆloadå°±å¾ˆç®€å•ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> keras.callbacks <span class="keyword">import</span> ModelCheckpoint</div><div class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> load_model</div><div class="line"></div><div class="line"><span class="comment"># create model</span></div><div class="line">model = Sequential()</div><div class="line">model.add(...)</div><div class="line">model.add(...)</div><div class="line">model.add(...)</div><div class="line"><span class="comment"># Compile model</span></div><div class="line">model.compile(...)</div><div class="line"><span class="comment"># checkpoint</span></div><div class="line">filepath=<span class="string">"weights-best.hdf5"</span></div><div class="line">checkpoint = ModelCheckpoint(filepath, monitor=<span class="string">'val_acc'</span>, verbose=<span class="number">1</span>, save_best_only=<span class="keyword">True</span>, mode=<span class="string">'max'</span>, save_weights_only=<span class="keyword">False</span>)</div><div class="line"></div><div class="line"><span class="comment"># Fit the model</span></div><div class="line">model.fit(X, Y, validation_split=<span class="number">0.33</span>, epochs=<span class="number">150</span>, batch_size=<span class="number">10</span>, callbacks=[checkpoint], verbose=<span class="number">0</span>)</div><div class="line"></div><div class="line"><span class="comment"># Load the model</span></div><div class="line">model= load_model(filepath)</div><div class="line">scores=model.evaluate(X, Y,verbose=<span class="number">0</span>)</div><div class="line">print(<span class="string">'&#123;&#125;: &#123;:.2%&#125;'</span>.format(model.metrics_names[<span class="number">1</span>], scores[<span class="number">1</span>]))</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15135840798621.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;æ·±åº¦å­¦ä¹ ä¸­å¦‚ä½•ä¿å­˜æœ€ä½³æ¨¡å‹ï¼Œå¦‚ä½•é‡ç”¨å·²ç»ä¿å­˜çš„æ¨¡å‹ï¼Ÿæœ¬æ–‡ä¸»è¦ä»‹ç»Keras ä¿å­˜åŠé‡ç”¨æ¨¡å‹çš„æ–¹æ³•&lt;br&gt;
    
    </summary>
    
    
      <category term="Keras" scheme="http://frankchen.xyz/tags/Keras/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£ä¸€ç»´å·ç§¯</title>
    <link href="http://frankchen.xyz/2018/04/17/conv1d-in-keras/"/>
    <id>http://frankchen.xyz/2018/04/17/conv1d-in-keras/</id>
    <published>2018-04-17T07:46:36.000Z</published>
    <updated>2018-04-19T08:50:30.253Z</updated>
    
    <content type="html"><![CDATA[<p>ç†è§£ä¸€ç»´å·ç§¯<br><a id="more"></a><br>ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ©ç”¨CNNè¿›è¡ŒNLPä¸­çš„æƒ…æ„Ÿåˆ†ç±»çš„ä¾‹å­ï¼Œ<br><img src="/images/15240224514694.png" alt=""></p><p>ä¸Šå›¾ä¸­ï¼Œè¾“å…¥ä¸ºè¡¨ç¤ºä¸ºè¯è¡¨ä¸ºd=5ï¼Œé•¿åº¦ä¸º7çš„çŸ©é˜µçš„å¥å­ï¼Œ1Då·ç§¯æ ¸ä¸ºé•¿åº¦åˆ†åˆ«ä¸º(2,3,4)çš„å„ä¸¤ä¸ªï¼Œç»è¿‡å·ç§¯å¹¶æ¿€æ´»å‡½æ•°åï¼Œå„è‡ªäº§ç”Ÿäº†(4x1, 5x1, 6x1)çš„å„ä¸¤ä¸ªfeature mapï¼Œæ¯ä¸ªfeature mapç»è¿‡ä¸€æ¬¡1D max poolingåï¼ˆå³å–æ¯ä¸ªfeature mapçš„æœ€å¤§å€¼ï¼‰å†concatenateä¸ºä¸€ä¸ª6x1çš„1Då‘é‡ï¼Œç»è¿‡ä¸€ä¸ªå…¨è¿æ¥å±‚å†softmaxæ¿€æ´»å³å¯è¿›è¡Œæƒ…æ„Ÿåˆ†ç±»é¢„æµ‹ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç†è§£ä¸€ç»´å·ç§¯&lt;br&gt;
    
    </summary>
    
    
      <category term="Deep Learning" scheme="http://frankchen.xyz/tags/Deep-Learning/"/>
    
  </entry>
  
  <entry>
    <title>å¤„ç†å¤§æ•°æ®é›†çš„å»ºè®®</title>
    <link href="http://frankchen.xyz/2018/04/10/handle-big-datasets/"/>
    <id>http://frankchen.xyz/2018/04/10/handle-big-datasets/</id>
    <published>2018-04-10T07:07:34.000Z</published>
    <updated>2018-04-10T08:15:51.972Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘çš„ä¸€äº›æ¯”èµ›å¦‚<a href="https://www.kaggle.com/c/talkingdata-adtracking-fraud-detection" target="_blank" rel="external">TalkingData AdTracking Fraud Detection Challenge | Kaggle</a>æä¾›äº†å¾ˆå¤§çš„æ•°æ®é›†ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œåªæœ‰16Gçš„å†…å­˜çš„â€œå°â€ç”µè„‘éƒ½æ— æ³•ç›´æ¥å¤„ç†è¿™ç§æ•°æ®é›†äº†ï¼Œæœ¬æ–‡æ”¶é›†äº†ä¸€äº›å…³äºå¤„ç†è¿™ç§æ•°æ®çš„å»ºè®®ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚<br><a id="more"></a></p><h2 id="1-åŠæ—¶åˆ é™¤æ— ç”¨å˜é‡å¹¶åƒåœ¾å›æ”¶"><a href="#1-åŠæ—¶åˆ é™¤æ— ç”¨å˜é‡å¹¶åƒåœ¾å›æ”¶" class="headerlink" title="1.åŠæ—¶åˆ é™¤æ— ç”¨å˜é‡å¹¶åƒåœ¾å›æ”¶"></a>1.åŠæ—¶åˆ é™¤æ— ç”¨å˜é‡å¹¶åƒåœ¾å›æ”¶</h2><p>é€šå¸¸æˆ‘ä»¬åœ¨ç‰¹å¾å·¥ç¨‹ä¸­ä¼šæ¶‰åŠå¤§é‡çš„è½¬æ¢æ“ä½œï¼Œäº§ç”Ÿå¾ˆå¤šçš„ä¸­é—´å˜é‡ç­‰ï¼Œé™¤äº†ä½¿ç”¨<code>del</code>ä»¥å¤–ï¼Œä½¿ç”¨<code>gc.collect()</code>ä¹Ÿæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">temp = pd.read_csv(<span class="string">'../input/train_sample.csv'</span>)</div><div class="line"></div><div class="line"><span class="comment">#do something to the file</span></div><div class="line">temp[<span class="string">'os'</span>] = temp[<span class="string">'os'</span>].astype(<span class="string">'str'</span>)</div><div class="line"><span class="comment">#delete when no longer needed</span></div><div class="line"><span class="keyword">del</span> temp</div><div class="line"><span class="comment">#collect residual garbage</span></div><div class="line">gc.collect()</div></pre></td></tr></table></figure><h2 id="2-é¢„å®šä¹‰æ•°æ®ç±»å‹"><a href="#2-é¢„å®šä¹‰æ•°æ®ç±»å‹" class="headerlink" title="2.é¢„å®šä¹‰æ•°æ®ç±»å‹"></a>2.é¢„å®šä¹‰æ•°æ®ç±»å‹</h2><p>pandasä¸€èˆ¬ä¼šè‡ªå·±æ¨æ–­æ•°æ®ç±»å‹ï¼Œä¸è¿‡å€¾å‘äºä½¿ç”¨è€—è´¹ç©ºé—´å¤§çš„ï¼Œå¦‚ä¸‹é¢ä¾‹å­æ‰€ç¤ºï¼Œé¢„å®šä¹‰æ•°æ®ç±»å‹èŠ‚çœäº†è¶…è¿‡ä¸€åŠçš„ç©ºé—´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line">dtypes = &#123;</div><div class="line">        <span class="string">'ip'</span>            : <span class="string">'uint32'</span>,</div><div class="line">        <span class="string">'app'</span>           : <span class="string">'uint16'</span>,</div><div class="line">        <span class="string">'device'</span>        : <span class="string">'uint16'</span>,</div><div class="line">        <span class="string">'os'</span>            : <span class="string">'uint16'</span>,</div><div class="line">        <span class="string">'channel'</span>       : <span class="string">'uint16'</span>,</div><div class="line">        <span class="string">'is_attributed'</span> : <span class="string">'uint8'</span>,</div><div class="line">        &#125;</div><div class="line"></div><div class="line">dtypes2 = &#123;</div><div class="line">        <span class="string">'ip'</span>            : <span class="string">'int32'</span>,</div><div class="line">        <span class="string">'app'</span>           : <span class="string">'int16'</span>,</div><div class="line">        <span class="string">'device'</span>        : <span class="string">'int16'</span>,</div><div class="line">        <span class="string">'os'</span>            : <span class="string">'int16'</span>,</div><div class="line">        <span class="string">'channel'</span>       : <span class="string">'int16'</span>,</div><div class="line">        <span class="string">'is_attributed'</span> : <span class="string">'int8'</span>,</div><div class="line">        &#125;</div><div class="line"></div><div class="line">train = pd.read_csv(train_sample_file,parse_dates=[<span class="string">'click_time'</span>])</div><div class="line"></div><div class="line"><span class="comment">#check datatypes:</span></div><div class="line">train.info()</div><div class="line"></div><div class="line">train = pd.read_csv(train_sample_file,dtype=dtypes,parse_dates=[<span class="string">'click_time'</span>])</div><div class="line"></div><div class="line"><span class="comment">#check datatypes:</span></div><div class="line">train.info()</div><div class="line"></div><div class="line"></div><div class="line">train = pd.read_csv(train_sample_file,dtype=dtypes2,parse_dates=[<span class="string">'click_time'</span>])</div><div class="line"></div><div class="line"><span class="comment">#check datatypes:</span></div><div class="line">train.info()</div><div class="line"></div><div class="line"><span class="string">'''</span></div><div class="line">&lt;class 'pandas.core.frame.DataFrame'&gt;</div><div class="line">RangeIndex: 100000 entries, 0 to 99999</div><div class="line">Data columns (total 8 columns):</div><div class="line">ip                 100000 non-null int64</div><div class="line">app                100000 non-null int64</div><div class="line">device             100000 non-null int64</div><div class="line">os                 100000 non-null int64</div><div class="line">channel            100000 non-null int64</div><div class="line">click_time         100000 non-null datetime64[ns]</div><div class="line">attributed_time    227 non-null object</div><div class="line">is_attributed      100000 non-null int64</div><div class="line">dtypes: datetime64[ns](1), int64(6), object(1)</div><div class="line">memory usage: 6.1+ MB</div><div class="line">&lt;class 'pandas.core.frame.DataFrame'&gt;</div><div class="line">RangeIndex: 100000 entries, 0 to 99999</div><div class="line">Data columns (total 8 columns):</div><div class="line">ip                 100000 non-null uint32</div><div class="line">app                100000 non-null uint16</div><div class="line">device             100000 non-null uint16</div><div class="line">os                 100000 non-null uint16</div><div class="line">channel            100000 non-null uint16</div><div class="line">click_time         100000 non-null datetime64[ns]</div><div class="line">attributed_time    227 non-null object</div><div class="line">is_attributed      100000 non-null uint8</div><div class="line">dtypes: datetime64[ns](1), object(1), uint16(4), uint32(1), uint8(1)</div><div class="line">memory usage: 2.8+ MB</div><div class="line">&lt;class 'pandas.core.frame.DataFrame'&gt;</div><div class="line">RangeIndex: 100000 entries, 0 to 99999</div><div class="line">Data columns (total 8 columns):</div><div class="line">ip                 100000 non-null int32</div><div class="line">app                100000 non-null int16</div><div class="line">device             100000 non-null int16</div><div class="line">os                 100000 non-null int16</div><div class="line">channel            100000 non-null int16</div><div class="line">click_time         100000 non-null datetime64[ns]</div><div class="line">attributed_time    227 non-null object</div><div class="line">is_attributed      100000 non-null int8</div><div class="line">dtypes: datetime64[ns](1), int16(4), int32(1), int8(1), object(1)</div><div class="line">memory usage: 2.8+ MB</div><div class="line">'''</div></pre></td></tr></table></figure><h2 id="3-åªä½¿ç”¨csvæ–‡ä»¶å†…çš„æŒ‡å®šè¡Œ"><a href="#3-åªä½¿ç”¨csvæ–‡ä»¶å†…çš„æŒ‡å®šè¡Œ" class="headerlink" title="3.åªä½¿ç”¨csvæ–‡ä»¶å†…çš„æŒ‡å®šè¡Œ"></a>3.åªä½¿ç”¨csvæ–‡ä»¶å†…çš„æŒ‡å®šè¡Œ</h2><h3 id="a-æŒ‡å®šè¡Œæ•°"><a href="#a-æŒ‡å®šè¡Œæ•°" class="headerlink" title="a) æŒ‡å®šè¡Œæ•°"></a>a) æŒ‡å®šè¡Œæ•°</h3><p>ç›´æ¥ä½¿ç”¨nrowsæŒ‡å®š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">train = pd.read_csv(<span class="string">'../input/train.csv'</span>, nrows=<span class="number">1e5</span>, dtype=dtypes)</div></pre></td></tr></table></figure><h3 id="b-è·³è¿‡è¡Œæ•°"><a href="#b-è·³è¿‡è¡Œæ•°" class="headerlink" title="b) è·³è¿‡è¡Œæ•°"></a>b) è·³è¿‡è¡Œæ•°</h3><p>æ¯”å¦‚æˆ‘ä»¬è·³è¿‡å‰500wå–100wä¸‹é¢ä¿ç•™äº†headï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">train = pd.read_csv(<span class="string">'../input/train.csv'</span>, skiprows=range(<span class="number">1</span>, <span class="number">5000000</span>), nrows=<span class="number">1000000</span>, dtype=dtypes)</div></pre></td></tr></table></figure><h3 id="c-sampling"><a href="#c-sampling" class="headerlink" title="c) sampling"></a>c) sampling</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> subprocess</div><div class="line">print(<span class="string">'# Line count:'</span>)</div><div class="line"><span class="keyword">for</span> file <span class="keyword">in</span> [<span class="string">'train.csv'</span>, <span class="string">'test.csv'</span>, <span class="string">'train_sample.csv'</span>]:</div><div class="line">    lines = subprocess.run([<span class="string">'wc'</span>, <span class="string">'-l'</span>, <span class="string">'../input/&#123;&#125;'</span>.format(file)], stdout=subprocess.PIPE).stdout.decode(<span class="string">'utf-8'</span>)</div><div class="line">    print(lines, end=<span class="string">''</span>, flush=<span class="keyword">True</span>)</div><div class="line"><span class="string">'''</span></div><div class="line"># Line count:</div><div class="line">184903891 ../input/train.csv</div><div class="line">18790470 ../input/test.csv</div><div class="line">100001 ../input/train_sample.csv</div><div class="line">'''</div></pre></td></tr></table></figure><p>trainä¸€å…±æœ‰<code>lines=184903891</code> è¡Œï¼Œé‚£ä¹ˆå‡è®¾æˆ‘ä»¬éœ€è¦é‡‡æ ·å‡º100wè¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è·³è¿‡<code>lines - 1 - 1000000</code>è¡Œï¼Œå³</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#generate list of lines to skip</span></div><div class="line">skiplines = np.random.choice(np.arange(<span class="number">1</span>, lines), size=lines<span class="number">-1</span><span class="number">-1000000</span>, replace=<span class="keyword">False</span>)</div><div class="line"></div><div class="line"><span class="comment">#sort the list</span></div><div class="line">skiplines=np.sort(skiplines)</div><div class="line"><span class="comment">#check our list</span></div><div class="line">print(<span class="string">'lines to skip:'</span>, len(skiplines))</div><div class="line">print(<span class="string">'remaining lines in sample:'</span>, lines-len(skiplines), <span class="string">'(remember that it includes the heading!)'</span>)</div><div class="line"></div><div class="line"><span class="comment">###################SANITY CHECK###################</span></div><div class="line"><span class="comment">#find lines that weren't skipped by checking difference between each consecutive line</span></div><div class="line"><span class="comment">#how many out of first 100000 will be imported into the csv?</span></div><div class="line">diff = skiplines[<span class="number">1</span>:<span class="number">100000</span>]-skiplines[<span class="number">2</span>:<span class="number">100001</span>]</div><div class="line">remain = sum(diff!=<span class="number">-1</span>)</div><div class="line">print(<span class="string">'Ratio of lines from first 100000 lines:'</span>,  <span class="string">'&#123;0:.5f&#125;'</span>.format(remain/<span class="number">100000</span>) ) </div><div class="line">print(<span class="string">'Ratio imported from all lines:'</span>, <span class="string">'&#123;0:.5f&#125;'</span>.format((lines-len(skiplines))/lines) )</div><div class="line">train = pd.read_csv(<span class="string">'../input/train.csv'</span>, skiprows=skiplines, dtype=dtypes)</div><div class="line">train.head()</div><div class="line"><span class="keyword">del</span> skiplines</div><div class="line">gc.collect()</div></pre></td></tr></table></figure><h2 id="4-ä½¿ç”¨pandas-çš„ç”Ÿæˆå™¨ï¼Œç”¨chunkå¤„ç†"><a href="#4-ä½¿ç”¨pandas-çš„ç”Ÿæˆå™¨ï¼Œç”¨chunkå¤„ç†" class="headerlink" title="4.ä½¿ç”¨pandas çš„ç”Ÿæˆå™¨ï¼Œç”¨chunkå¤„ç†"></a>4.ä½¿ç”¨pandas çš„ç”Ÿæˆå™¨ï¼Œç”¨chunkå¤„ç†</h2><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨np.whereè¿‡æ»¤æ‰â€˜is_attributedâ€™ä¸º0çš„éƒ¨åˆ†ï¼ˆä¾‹å¦‚<code>[xv if c else yv for (c,xv,yv) in zip(condition,x,y)]</code>ï¼‰<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#set up an empty dataframe</span></div><div class="line">df_converted = pd.DataFrame()</div><div class="line"></div><div class="line"><span class="comment">#we are going to work with chunks of size 1 million rows</span></div><div class="line">chunksize = <span class="number">10</span> ** <span class="number">6</span></div><div class="line"></div><div class="line"><span class="comment">#in each chunk, filter for values that have 'is_attributed'==1, and merge these values into one dataframe</span></div><div class="line"><span class="keyword">for</span> chunk <span class="keyword">in</span> pd.read_csv(<span class="string">'../input/train.csv'</span>, chunksize=chunksize, dtype=dtypes):</div><div class="line">    filtered = (chunk[(np.where(chunk[<span class="string">'is_attributed'</span>]==<span class="number">1</span>, <span class="keyword">True</span>, <span class="keyword">False</span>))])</div><div class="line">    df_converted = pd.concat([df_converted, filtered], ignore_index=<span class="keyword">True</span>, )</div></pre></td></tr></table></figure></p><h2 id="5-åªè½½å…¥è‹¥å¹²åˆ—"><a href="#5-åªè½½å…¥è‹¥å¹²åˆ—" class="headerlink" title="5.åªè½½å…¥è‹¥å¹²åˆ—"></a>5.åªè½½å…¥è‹¥å¹²åˆ—</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#wanted columns</span></div><div class="line">columns = [<span class="string">'ip'</span>, <span class="string">'click_time'</span>, <span class="string">'is_attributed'</span>]</div><div class="line">dtypes = &#123;</div><div class="line">        <span class="string">'ip'</span>            : <span class="string">'uint32'</span>,</div><div class="line">        <span class="string">'is_attributed'</span> : <span class="string">'uint8'</span>,</div><div class="line">        &#125;</div><div class="line"></div><div class="line">ips_df = pd.read_csv(<span class="string">'../input/train.csv'</span>, usecols=columns, dtype=dtypes)</div><div class="line">print(ips_df.info())</div><div class="line">ips_df.head()</div><div class="line"><span class="string">'''</span></div><div class="line">&lt;class 'pandas.core.frame.DataFrame'&gt;</div><div class="line">RangeIndex: 184903890 entries, 0 to 184903889</div><div class="line">Data columns (total 3 columns):</div><div class="line">ip               uint32</div><div class="line">click_time       object</div><div class="line">is_attributed    uint8</div><div class="line">dtypes: object(1), uint32(1), uint8(1)</div><div class="line">memory usage: 2.2+ GB</div><div class="line">None'''</div></pre></td></tr></table></figure><h2 id="6-ç»“åˆå¤šç§æ–¹æ³•åˆ›æ„æ€§çš„å¤„ç†æ•°æ®"><a href="#6-ç»“åˆå¤šç§æ–¹æ³•åˆ›æ„æ€§çš„å¤„ç†æ•°æ®" class="headerlink" title="6.ç»“åˆå¤šç§æ–¹æ³•åˆ›æ„æ€§çš„å¤„ç†æ•°æ®"></a>6.ç»“åˆå¤šç§æ–¹æ³•åˆ›æ„æ€§çš„å¤„ç†æ•°æ®</h2><p>ä¾‹å¦‚æ— æ³•ä½¿ç”¨æ•´ä¸ªæ•°æ®æ¥groupbyé‚£ä¹ˆå¯ä»¥åˆ†å—æ¥åšï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">size=<span class="number">100000</span></div><div class="line">all_rows = len(ips_df)</div><div class="line">num_parts = all_rows//size</div><div class="line"></div><div class="line"><span class="comment">#generate the first batch</span></div><div class="line">ip_sums = ips_df[<span class="number">0</span>:size][[<span class="string">'ip'</span>, <span class="string">'is_attributed'</span>]].groupby(<span class="string">'ip'</span>, as_index=<span class="keyword">False</span>).sum()</div><div class="line"></div><div class="line"><span class="comment">#add remaining batches</span></div><div class="line"><span class="keyword">for</span> p <span class="keyword">in</span> range(<span class="number">1</span>,num_parts):</div><div class="line">    start = p*size</div><div class="line">    end = p*size + size</div><div class="line">    <span class="keyword">if</span> end &lt; all_rows:</div><div class="line">        group = ips_df[start:end][[<span class="string">'ip'</span>, <span class="string">'is_attributed'</span>]].groupby(<span class="string">'ip'</span>, as_index=<span class="keyword">False</span>).sum()</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        group = ips_df[start:][[<span class="string">'ip'</span>, <span class="string">'is_attributed'</span>]].groupby(<span class="string">'ip'</span>, as_index=<span class="keyword">False</span>).sum()</div><div class="line">    ip_sums = ip_sums.merge(group, on=<span class="string">'ip'</span>, how=<span class="string">'outer'</span>)</div><div class="line">    ip_sums.columns = [<span class="string">'ip'</span>, <span class="string">'sum1'</span>,<span class="string">'sum2'</span>]</div><div class="line">    ip_sums[<span class="string">'conversions_per_ip'</span>] = np.nansum((ip_sums[<span class="string">'sum1'</span>], ip_sums[<span class="string">'sum2'</span>]), axis = <span class="number">0</span>)</div><div class="line">    ip_sums.drop(columns=[<span class="string">'sum1'</span>, <span class="string">'sum2'</span>], axis = <span class="number">0</span>, inplace=<span class="keyword">True</span>)</div></pre></td></tr></table></figure><h2 id="7-ä½¿ç”¨daskä»£æ›¿pandas"><a href="#7-ä½¿ç”¨daskä»£æ›¿pandas" class="headerlink" title="7.ä½¿ç”¨daskä»£æ›¿pandas"></a>7.ä½¿ç”¨daskä»£æ›¿pandas</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">import dask</div><div class="line">import dask.dataframe as dd</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘çš„ä¸€äº›æ¯”èµ›å¦‚&lt;a href=&quot;https://www.kaggle.com/c/talkingdata-adtracking-fraud-detection&quot;&gt;TalkingData AdTracking Fraud Detection Challenge | Kaggle&lt;/a&gt;æä¾›äº†å¾ˆå¤§çš„æ•°æ®é›†ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œåªæœ‰16Gçš„å†…å­˜çš„â€œå°â€ç”µè„‘éƒ½æ— æ³•ç›´æ¥å¤„ç†è¿™ç§æ•°æ®é›†äº†ï¼Œæœ¬æ–‡æ”¶é›†äº†ä¸€äº›å…³äºå¤„ç†è¿™ç§æ•°æ®çš„å»ºè®®ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="python" scheme="http://frankchen.xyz/tags/python/"/>
    
      <category term="Data Science" scheme="http://frankchen.xyz/tags/Data-Science/"/>
    
      <category term="Kaggle" scheme="http://frankchen.xyz/tags/Kaggle/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ ä¹‹ sklearnä¸­çš„pipeline</title>
    <link href="http://frankchen.xyz/2018/04/08/pipeline-in-machine-learning/"/>
    <id>http://frankchen.xyz/2018/04/08/pipeline-in-machine-learning/</id>
    <published>2018-04-08T08:13:42.000Z</published>
    <updated>2018-04-11T07:25:07.449Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15231874915799.jpg" alt=""><br><a id="more"></a><br>å¦‚å›¾æ‰€ç¤ºï¼Œåˆ©ç”¨pipelineæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„å‡å°‘ä»£ç é‡åŒæ—¶è®©æœºå™¨å­¦ä¹ çš„æµç¨‹å˜å¾—ç›´è§‚ï¼Œ<br><img src="/images/15231783974167.jpg" alt=""></p><p>ä¾‹å¦‚æˆ‘ä»¬éœ€è¦åšå¦‚ä¸‹æ“ä½œï¼Œå®¹æ˜“çœ‹å‡ºï¼Œè®­ç»ƒæµ‹è¯•é›†é‡å¤äº†ä»£ç ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">vect = CountVectorizer()</div><div class="line">tfidf = TfidfTransformer()</div><div class="line">clf = SGDClassifier()</div><div class="line"></div><div class="line">vX = vect.fit_transform(Xtrain)</div><div class="line">tfidfX = tfidf.fit_transform(vX)</div><div class="line">predicted = clf.fit_predict(tfidfX)</div><div class="line"></div><div class="line"><span class="comment"># Now evaluate all steps on test set</span></div><div class="line">vX = vect.fit_transform(Xtest)</div><div class="line">tfidfX = tfidf.fit_transform(vX)</div><div class="line">predicted = clf.fit_predict(tfidfX)</div></pre></td></tr></table></figure><p>åˆ©ç”¨pipelineï¼Œä¸Šé¢ä»£ç å¯ä»¥æŠ½è±¡ä¸ºï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">pipeline = Pipeline([</div><div class="line">    (<span class="string">'vect'</span>, CountVectorizer()),</div><div class="line">    (<span class="string">'tfidf'</span>, TfidfTransformer()),</div><div class="line">    (<span class="string">'clf'</span>, SGDClassifier()),</div><div class="line">])</div><div class="line">predicted = pipeline.fit(Xtrain).predict(Xtrain)</div><div class="line"><span class="comment"># Now evaluate all steps on test set</span></div><div class="line">predicted = pipeline.predict(Xtest)</div></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œpipelineæœ€åä¸€æ­¥å¦‚æœæœ‰predict()æ–¹æ³•æˆ‘ä»¬æ‰å¯ä»¥å¯¹pipelineä½¿ç”¨fit_predict()ï¼ŒåŒç†ï¼Œæœ€åä¸€æ­¥å¦‚æœæœ‰transform()æ–¹æ³•æˆ‘ä»¬æ‰å¯ä»¥å¯¹pipelineä½¿ç”¨fit_transform()æ–¹æ³•ã€‚</p><h2 id="ä½¿ç”¨pipelineåšcross-validation"><a href="#ä½¿ç”¨pipelineåšcross-validation" class="headerlink" title="ä½¿ç”¨pipelineåšcross validation"></a>ä½¿ç”¨pipelineåšcross validation</h2><p>çœ‹å¦‚ä¸‹æ¡ˆä¾‹ï¼Œå³å…ˆå¯¹è¾“å…¥æ‰‹å†™æ•°å­—çš„æ•°æ®è¿›è¡ŒPCAé™ç»´ï¼Œå†é€šè¿‡é€»è¾‘å›å½’é¢„æµ‹æ ‡ç­¾ã€‚å…¶ä¸­æˆ‘ä»¬é€šè¿‡pipelineå¯¹<br>PCAçš„é™ç»´ç»´æ•°n_componentså’Œé€»è¾‘å›å½’çš„æ­£åˆ™é¡¹Cå¤§å°åšäº¤å‰éªŒè¯ï¼Œä¸»è¦æ­¥éª¤æœ‰ï¼š</p><ol><li>ä¾æ¬¡å®ä¾‹åŒ–å„æˆåˆ†å¯¹è±¡å¦‚<code>pca = decomposition.PCA()</code></li><li>ä»¥(name, object)çš„tubleä¸ºå…ƒç´ ç»„è£…pipelineå¦‚<code>Pipeline(steps=[(&#39;pca&#39;, pca), (&#39;logistic&#39;, logistic)])</code></li><li>åˆå§‹åŒ–CVå‚æ•°å¦‚<code>n_components = [20, 40, 64]</code></li><li>å®ä¾‹åŒ–CVå¯¹è±¡å¦‚<code>estimator = GridSearchCV(pipe, dict(pca__n_components=n_components, logistic__C=Cs))</code>ï¼Œå…¶ä¸­æ³¨æ„å‚æ•°çš„ä¼ é€’æ–¹å¼ï¼Œå³keyä¸ºpipelineå…ƒç´ å+å‡½æ•°å‚æ•°</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> linear_model, decomposition, datasets</div><div class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</div><div class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</div><div class="line">logistic = linear_model.LogisticRegression()</div><div class="line"></div><div class="line">pca = decomposition.PCA()</div><div class="line">pipe = Pipeline(steps=[(<span class="string">'pca'</span>, pca), (<span class="string">'logistic'</span>, logistic)])</div><div class="line"></div><div class="line">digits = datasets.load_digits()</div><div class="line">X_digits = digits.data</div><div class="line">y_digits = digits.target</div><div class="line"></div><div class="line"><span class="comment"># Prediction</span></div><div class="line">n_components = [<span class="number">20</span>, <span class="number">40</span>, <span class="number">64</span>]</div><div class="line">Cs = np.logspace(<span class="number">-4</span>, <span class="number">4</span>, <span class="number">3</span>)</div><div class="line"></div><div class="line">pca.fit(X_digits)</div><div class="line">estimator = GridSearchCV(pipe,</div><div class="line">                         dict(pca__n_components=n_components, logistic__C=Cs))</div><div class="line">estimator.fit(X_digits, y_digits)</div><div class="line"></div><div class="line">plt.figure(<span class="number">1</span>, figsize=(<span class="number">4</span>, <span class="number">3</span>))</div><div class="line">plt.clf()</div><div class="line">plt.axes([<span class="number">.2</span>, <span class="number">.2</span>, <span class="number">.7</span>, <span class="number">.7</span>])</div><div class="line">plt.plot(pca.explained_variance_, linewidth=<span class="number">2</span>)</div><div class="line">plt.axis(<span class="string">'tight'</span>)</div><div class="line">plt.xlabel(<span class="string">'n_components'</span>)</div><div class="line">plt.ylabel(<span class="string">'explained_variance_'</span>)</div><div class="line">plt.axvline(</div><div class="line">    estimator.best_estimator_.named_steps[<span class="string">'pca'</span>].n_components,</div><div class="line">    linestyle=<span class="string">':'</span>,</div><div class="line">    label=<span class="string">'n_components chosen'</span>)</div><div class="line">plt.legend(prop=dict(size=<span class="number">12</span>))</div><div class="line">plt.show()</div></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰transformer"><a href="#è‡ªå®šä¹‰transformer" class="headerlink" title="è‡ªå®šä¹‰transformer"></a>è‡ªå®šä¹‰transformer</h2><p>æˆ‘ä»¬å¯ä»¥å¦‚ä¸‹è‡ªå®šä¹‰transformerï¼ˆæ¥è‡ª<a href="http://michelleful.github.io/code-blog/2015/06/20/pipelines/" target="_blank" rel="external">Using Pipelines and FeatureUnions in scikit-learn - Michelle Fullwood</a>ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.base <span class="keyword">import</span> BaseEstimator, TransformerMixin</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SampleExtractor</span><span class="params">(BaseEstimator, TransformerMixin)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, vars)</span>:</span></div><div class="line">        self.vars = vars  <span class="comment"># e.g. pass in a column name to extract</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(self, X, y=None)</span>:</span></div><div class="line">        <span class="keyword">return</span> do_something_to(X, self.vars)  <span class="comment"># where the actual feature extraction happens</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, X, y=None)</span>:</span></div><div class="line">        <span class="keyword">return</span> self  <span class="comment"># generally does nothing</span></div></pre></td></tr></table></figure><p>å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹æ¯ä¸ªfeatureå•ç‹¬å¤„ç†ï¼Œä¾‹å¦‚ä¸‹é¢çš„è¿™ä¸ªæ¯”è¾ƒå¤§çš„æµæ°´çº¿ï¼ˆæ¥è‡ª<a href="http://zacstewart.com/2014/08/05/pipelines-of-featureunions-of-pipelines.html" target="_blank" rel="external">Using scikit-learn Pipelines and FeatureUnions | zacstewart.com</a>ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä½œè€…çš„pipelineä¸­ï¼Œé¦–å…ˆæ˜¯ä¸€ä¸ªå«åš<code>features</code>çš„FeatureUnionï¼Œå…¶ä¸­ï¼Œæ¯ä¸ªç‰¹å¾åˆ†åˆ«ä»¥ä¸€ä¸ªpipelineæ¥å¤„ç†ï¼Œè¿™ä¸ªpipelineé¦–å…ˆæ˜¯ä¸€ä¸ª<code>ColumnExtractor</code>æå–å‡ºè¿™ä¸ªç‰¹å¾ï¼Œåç»­è¿›è¡Œä¸€ç³»åˆ—å¤„ç†è½¬æ¢ï¼Œæœ€ç»ˆè¿™äº›pipelineç»„åˆä¸ºç‰¹å¾ç»„åˆï¼Œå†å–‚ç»™ä¸€ç³»åˆ—<code>ModelTransformer</code>åŒ…è£…çš„æ¨¡å‹æ¥predictï¼Œæœ€ç»ˆä½¿ç”¨<code>KNeighborsRegressor</code>é¢„æµ‹ï¼ˆç›¸å½“äºä¸¤å±‚stackingï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">pipeline = Pipeline([</div><div class="line">    (<span class="string">'features'</span>, FeatureUnion([</div><div class="line">        (<span class="string">'continuous'</span>, Pipeline([</div><div class="line">            (<span class="string">'extract'</span>, ColumnExtractor(CONTINUOUS_FIELDS)),</div><div class="line">            (<span class="string">'scale'</span>, Normalizer())</div><div class="line">        ])),</div><div class="line">        (<span class="string">'factors'</span>, Pipeline([</div><div class="line">            (<span class="string">'extract'</span>, ColumnExtractor(FACTOR_FIELDS)),</div><div class="line">            (<span class="string">'one_hot'</span>, OneHotEncoder(n_values=<span class="number">5</span>)),</div><div class="line">            (<span class="string">'to_dense'</span>, DenseTransformer())</div><div class="line">        ])),</div><div class="line">        (<span class="string">'weekday'</span>, Pipeline([</div><div class="line">            (<span class="string">'extract'</span>, DayOfWeekTransformer()),</div><div class="line">            (<span class="string">'one_hot'</span>, OneHotEncoder()),</div><div class="line">            (<span class="string">'to_dense'</span>, DenseTransformer())</div><div class="line">        ])),</div><div class="line">        (<span class="string">'hour_of_day'</span>, HourOfDayTransformer()),</div><div class="line">        (<span class="string">'month'</span>, Pipeline([</div><div class="line">            (<span class="string">'extract'</span>, ColumnExtractor([<span class="string">'datetime'</span>])),</div><div class="line">            (<span class="string">'to_month'</span>, DateTransformer()),</div><div class="line">            (<span class="string">'one_hot'</span>, OneHotEncoder()),</div><div class="line">            (<span class="string">'to_dense'</span>, DenseTransformer())</div><div class="line">        ])),</div><div class="line">        (<span class="string">'growth'</span>, Pipeline([</div><div class="line">            (<span class="string">'datetime'</span>, ColumnExtractor([<span class="string">'datetime'</span>])),</div><div class="line">            (<span class="string">'to_numeric'</span>, MatrixConversion(int)),</div><div class="line">            (<span class="string">'regression'</span>, ModelTransformer(LinearRegression()))</div><div class="line">        ]))</div><div class="line">    ])),</div><div class="line">    (<span class="string">'estimators'</span>, FeatureUnion([</div><div class="line">        (<span class="string">'knn'</span>, ModelTransformer(KNeighborsRegressor(n_neighbors=<span class="number">5</span>))),</div><div class="line">        (<span class="string">'gbr'</span>, ModelTransformer(GradientBoostingRegressor())),</div><div class="line">        (<span class="string">'dtr'</span>, ModelTransformer(DecisionTreeRegressor())),</div><div class="line">        (<span class="string">'etr'</span>, ModelTransformer(ExtraTreesRegressor())),</div><div class="line">        (<span class="string">'rfr'</span>, ModelTransformer(RandomForestRegressor())),</div><div class="line">        (<span class="string">'par'</span>, ModelTransformer(PassiveAggressiveRegressor())),</div><div class="line">        (<span class="string">'en'</span>, ModelTransformer(ElasticNet())),</div><div class="line">        (<span class="string">'cluster'</span>, ModelTransformer(KMeans(n_clusters=<span class="number">2</span>)))</div><div class="line">    ])),</div><div class="line">    (<span class="string">'estimator'</span>, KNeighborsRegressor())</div><div class="line">])</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HourOfDayTransformer</span><span class="params">(TransformerMixin)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(self, X, **transform_params)</span>:</span></div><div class="line">        hours = DataFrame(X[<span class="string">'datetime'</span>].apply(<span class="keyword">lambda</span> x: x.hour))</div><div class="line">        <span class="keyword">return</span> hours</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, X, y=None, **fit_params)</span>:</span></div><div class="line">        <span class="keyword">return</span> self</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ModelTransformer</span><span class="params">(TransformerMixin)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, model)</span>:</span></div><div class="line">        self.model = model</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span><span class="params">(self, *args, **kwargs)</span>:</span></div><div class="line">        self.model.fit(*args, **kwargs)</div><div class="line">        <span class="keyword">return</span> self</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(self, X, **transform_params)</span>:</span></div><div class="line">        <span class="keyword">return</span> DataFrame(self.model.predict(X))</div></pre></td></tr></table></figure><h2 id="FeatureUnion"><a href="#FeatureUnion" class="headerlink" title="FeatureUnion"></a>FeatureUnion</h2><p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.pipeline.FeatureUnion.html" target="_blank" rel="external">sklearn.pipeline.FeatureUnion â€” scikit-learn 0.19.1 documentation</a> å’Œpipelineçš„åºåˆ—æ‰§è¡Œä¸åŒï¼ŒFeatureUnionæŒ‡çš„æ˜¯å¹¶è¡Œåœ°åº”ç”¨è®¸å¤štransformeråœ¨inputä¸Šï¼Œå†å°†ç»“æœåˆå¹¶ï¼Œæ‰€ä»¥è‡ªç„¶åœ°é€‚åˆç‰¹å¾å·¥ç¨‹ä¸­çš„å¢åŠ ç‰¹å¾ï¼Œè€ŒFeatureUnionä¸pipelineç»„åˆå¯ä»¥æ–¹ä¾¿çš„å®Œæˆè®¸å¤šå¤æ‚çš„æ“ä½œï¼Œä¾‹å¦‚å¦‚ä¸‹çš„ä¾‹å­ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">pipeline = Pipeline([</div><div class="line">  (<span class="string">'extract_essays'</span>, EssayExractor()),</div><div class="line">  (<span class="string">'features'</span>, FeatureUnion([</div><div class="line">    (<span class="string">'ngram_tf_idf'</span>, Pipeline([</div><div class="line">      (<span class="string">'counts'</span>, CountVectorizer()),</div><div class="line">      (<span class="string">'tf_idf'</span>, TfidfTransformer())</div><div class="line">    ])),</div><div class="line">    (<span class="string">'essay_length'</span>, LengthTransformer()),</div><div class="line">    (<span class="string">'misspellings'</span>, MispellingCountTransformer())</div><div class="line">  ])),</div><div class="line">  (<span class="string">'classifier'</span>, MultinomialNB())</div><div class="line">])</div></pre></td></tr></table></figure><p>æ•´ä¸ª<code>features</code>æ˜¯ä¸€ä¸ªFeatureUnionï¼Œè€Œå…¶ä¸­çš„ngram_tf_idfåˆæ˜¯ä¸€ä¸ªåŒ…æ‹¬ä¸¤æ­¥çš„pipelineã€‚<br><img src="/images/15233302459256.jpg" alt=""></p><p>ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨FeatureUnionç»“åˆPCAé™ç»´åç‰¹å¾ä»¥åŠé€‰æ‹©åŸç‰¹å¾ä¸­çš„å‡ ä¸ªä½œä¸ºç‰¹å¾ç»„åˆå†å–‚ç»™SVMåˆ†ç±»ï¼Œæœ€åç”¨grid_search åšäº† pcaçš„<code>n_components</code>ã€SelectKBestçš„<code>k</code>ä»¥åŠSVMçš„<code>C</code>çš„CVã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline, FeatureUnion</div><div class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</div><div class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</div><div class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</div><div class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</div><div class="line"><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> SelectKBest</div><div class="line"></div><div class="line">iris = load_iris()</div><div class="line"></div><div class="line">X, y = iris.data, iris.target</div><div class="line"></div><div class="line">print(X.shape, y.shape)</div><div class="line"></div><div class="line"><span class="comment"># This dataset is way too high-dimensional. Better do PCA:</span></div><div class="line">pca = PCA()</div><div class="line"></div><div class="line"><span class="comment"># Maybe some original features where good, too?</span></div><div class="line">selection = SelectKBest()</div><div class="line"></div><div class="line"><span class="comment"># Build estimator from PCA and Univariate selection:</span></div><div class="line"></div><div class="line">svm = SVC(kernel=<span class="string">"linear"</span>)</div><div class="line"></div><div class="line"><span class="comment"># Do grid search over k, n_components and C:</span></div><div class="line"></div><div class="line">pipeline = Pipeline([(<span class="string">"features"</span>,</div><div class="line">                      FeatureUnion([(<span class="string">"pca"</span>, pca), (<span class="string">"univ_select"</span>,</div><div class="line">                                                   selection)])), (<span class="string">"svm"</span>,</div><div class="line">                                                                   svm)])</div><div class="line"></div><div class="line">param_grid = dict(</div><div class="line">    features__pca__n_components=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">    features__univ_select__k=[<span class="number">1</span>, <span class="number">2</span>],</div><div class="line">    svm__C=[<span class="number">0.1</span>, <span class="number">1</span>, <span class="number">10</span>])</div><div class="line"></div><div class="line">grid_search = GridSearchCV(pipeline, param_grid=param_grid, verbose=<span class="number">10</span>)</div><div class="line">grid_search.fit(X, y)</div><div class="line"></div><div class="line">grid_search.best_estimator_</div><div class="line">grid_search.best_params_</div><div class="line">grid_search.best_score_</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15231874915799.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Data Science" scheme="http://frankchen.xyz/tags/Data-Science/"/>
    
  </entry>
  
  <entry>
    <title>VPSæ­å»ºç§äººBTç¦»çº¿æœåŠ¡å™¨</title>
    <link href="http://frankchen.xyz/2018/04/08/private-BT-server/"/>
    <id>http://frankchen.xyz/2018/04/08/private-BT-server/</id>
    <published>2018-04-08T03:13:51.000Z</published>
    <updated>2018-04-08T03:47:02.802Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15231584798585.jpg" alt=""><br>ä½¿ç”¨é—²ç½®çš„VPSæ­å»ºç§äººBTç¦»çº¿æœåŠ¡å™¨çš„æ–¹æ³•ï¼Œäº¦æˆ–è€…æ¨å¹¿è‡³æ ‘è“æ´¾æˆ–è€…å®¶ç”¨è·¯ç”±å™¨äº¦å¯ã€‚<br><a id="more"></a> </p><h2 id="å®‰è£…åŠé…ç½®-Transmission"><a href="#å®‰è£…åŠé…ç½®-Transmission" class="headerlink" title="å®‰è£…åŠé…ç½® Transmission"></a>å®‰è£…åŠé…ç½® Transmission</h2><ul><li>å®‰è£… <code>sudo apt-get install transmission-daemon</code></li><li>é…ç½® åœæ­¢æœåŠ¡ï¼ˆå¦åˆ™é…ç½®æ–‡ä»¶é”å®šï¼Œæ— æ³•ä¿®æ”¹ï¼‰<code>sudo service transmission-daemon stop</code></li><li>ç¼–è¾‘é…ç½®æ–‡ä»¶</li></ul><p><code>sudo vim /etc/transmission-daemon/settings.json</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="string">"ratio-limit"</span>: 0.0100, </div><div class="line">    <span class="string">"ratio-limit-enabled"</span>: <span class="literal">true</span>,  </div><div class="line">    <span class="string">"rpc-password"</span>: <span class="string">"*******"</span>,   </div><div class="line">    <span class="string">"rpc-username"</span>: <span class="string">"frank"</span>,</div><div class="line">    <span class="string">"download-dir"</span>: <span class="string">"/var/www/html/Downloads"</span>, </div><div class="line">&#125;</div></pre></td></tr></table></figure><p> æˆ‘åªåˆ—å‡ºäº†æˆ‘ä¿®æ”¹è¿‡ä¸”æ— æ³•åœ¨ Transmission Web-GUI ä¸­æ— æ³•å®Œæˆä¿®æ”¹çš„å‡ é¡¹ï¼Œå››é¡¹ä¾æ¬¡æ˜¯ä¸‹è½½å®Œæˆåšç§ç‡ï¼Œå¼€å¯é™åˆ¶åšç§ç‡ï¼ŒWeb-GUI å¯†ç ï¼ŒWeb-GUI ç”¨æˆ·åã€‚åƒä¿å­˜è·¯å¾„ï¼Œä¸‹è½½/ ä¸Šä¼ é€Ÿåº¦é™åˆ¶ï¼Œéƒ½å¯ä»¥åœ¨ Web-GUI ä¸­ç›´æ¥è®¾å®šï¼Œä¸ºäº†æ–¹ä¾¿ä¹‹åå¯¹ä¸‹è½½æ–‡ä»¶çš„ Web ç®¡ç†ï¼Œæˆ‘ç›´æ¥å°†ä¿å­˜è·¯å¾„æ”¹åˆ°äº† Web å‘å¸ƒè·¯å¾„ä¸‹çš„ä¸€ä¸ªå­ç›®å½•ã€‚</p><p> é‡å¯æœåŠ¡</p><p> <code>sudo service transmission-daemon start</code></p><p> æ­¤æ—¶åœ¨æµè§ˆå™¨æ‰“å¼€<code>VPSçš„IPåœ°å€/åŸŸå:9091</code>å¹¶è¾“å…¥åˆšåˆšè®¾ç½®çš„ç”¨æˆ·ååŠå¯†ç åº”è¯¥å°±å¯ä»¥è®¿é—® Transmission çš„ Web-GUIäº†ã€‚<br> <img src="/images/Screen%20Shot%202018-04-08%20at%2011.25.35.png" alt="Screen Shot 2018-04-08 at 11.25.35"></p><p> å¯æ˜¯åœ¨æ·»åŠ äº†ç¬¬ä¸€ä¸ªä»»åŠ¡åå‡ºç°ä¿å­˜è·¯å¾„å†™å…¥æƒé™çš„é—®é¢˜ã€‚<br>è§£å†³åŠæ³•å¦‚<a href="https://askubuntu.com/questions/221081/permission-denied-when-downloading-with-transmission-deamon" target="_blank" rel="external">Permission denied when downloading with transmission deamon - Ask Ubuntu</a>æ‰€ç¤ºï¼š</p><p>æˆ‘ä»¬çš„ä¸‹è½½åœ°å€æ˜¯ <code>/var/www/html/Downloads</code> ç”¨æˆ·åæ˜¯<code>znwindy</code>:<br>é‚£ä¹ˆ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># å°†æœ¬ç”¨æˆ·åŠ å…¥ `debian-transmission`ç»„</span></div><div class="line">sudo usermod <span class="_">-a</span> -G debian-transmission znwindy</div><div class="line"><span class="comment"># æ–‡ä»¶å¤¹æ‰€æœ‰è€…</span></div><div class="line">sudo chgrp debian-transmission /var/www/html/Downloads</div><div class="line"><span class="comment"># ç»„æ·»åŠ å†™æƒé™</span></div><div class="line">sudo chmod -R 755 /var/www</div><div class="line"><span class="comment"># åœæ­¢åå°deamon </span></div><div class="line"></div><div class="line">sudo service transmission-daemon stop</div><div class="line"><span class="comment"># æ›´æ”¹ file creation mask</span></div><div class="line">sudo vim /etc/transmission-daemon/settings.json</div><div class="line"><span class="comment"># æŠŠ"umask": 18 æ”¹ä¸º "umask": 2</span></div><div class="line"><span class="comment"># é‡å¯æœåŠ¡</span></div><div class="line">sudo service transmission-daemon start</div></pre></td></tr></table></figure><p>å³å¯è§£å†³å†™çš„é—®é¢˜ã€‚</p><h2 id="é…ç½®-Apache-åŠ å¯†åŒºåŸŸ"><a href="#é…ç½®-Apache-åŠ å¯†åŒºåŸŸ" class="headerlink" title="é…ç½® Apache åŠ å¯†åŒºåŸŸ"></a>é…ç½® Apache åŠ å¯†åŒºåŸŸ</h2><p>å®‰è£…apache2</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update</div><div class="line">sudo apt-get install apache2</div></pre></td></tr></table></figure><p>Adjust the Firewall</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo ufw app list</div><div class="line">sudo ufw allow <span class="string">'Apache Full'</span></div><div class="line">sudo ufw status</div><div class="line">sudo systemctl status apache2</div></pre></td></tr></table></figure><p>å¯†ç ç”Ÿæˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo htpasswd -c /etc/apache2/.htpasswd ç”¨æˆ·å</div></pre></td></tr></table></figure><p>ç„¶åä¼šè¢«æç¤ºè¾“å…¥ä¸¤æ¬¡è¯¥ â€œç”¨æˆ·åâ€ çš„å¯†ç ã€‚</p><p>ä¿®æ”¹è™šæ‹Ÿ host çš„é…ç½®æ–‡ä»¶<br><code>sudo vim /etc/apache2/sites-enabled/000-default.conf</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;Directory <span class="string">"/var/www/html"</span>&gt;</div><div class="line">        AuthType Basic</div><div class="line">        AuthName <span class="string">"Restricted Content"</span></div><div class="line">        AuthUserFile /etc/apache2/.htpasswd</div><div class="line">        Require valid-user</div><div class="line">&lt;/Directory&gt;</div></pre></td></tr></table></figure><p>ä¿å­˜åé‡å¯</p><p><code>sudo service apache2 restart</code></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€šè¿‡ HTTP å°†ä¸‹è½½çš„ä»»åŠ¡å–å›æœ¬åœ°ï¼Œé€Ÿåº¦ä¹Ÿå¾ˆå¿«ï¼è¿™æ ·ï¼Œé€šè¿‡è®¿é—® Transmission Web-GUI â€œæŠ•å–‚â€ ç§å­ï¼Œç£åŠ›é“¾ï¼Œç„¶ååœ¨ä¸‹è½½å®Œæˆåé€šè¿‡ HTTP æ–¹å¼ä» VPS å°†èµ„æºå–å›æœ¬åœ°ï¼Œç”šè‡³ç›´æ¥å¯¹ .mp3ã€.mp4 ç­‰æ–‡ä»¶æ ¼å¼è¿›è¡Œåœ¨çº¿æ’­æ”¾ï¼Œå®ç°äº†ä¸€ä¸ªç®€åŒ–ç‰ˆçš„è¿…é›·ç¦»çº¿ä¸‹è½½ï¼Œå¯æ˜¯å®ƒå´åœ¨ä¸‹è½½æŸäº›ç‰¹å®šèµ„æºæ—¶è¿œæ¯”è¿…é›·ç¦»çº¿ç®¡ç”¨ã€‚</p><h2 id="å‚è€ƒè‡ª"><a href="#å‚è€ƒè‡ª" class="headerlink" title="å‚è€ƒè‡ª"></a>å‚è€ƒè‡ª</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/24478342" target="_blank" rel="external">åœ¨ VPS ä¸Šæ­å»ºç§äººç¦»çº¿ä¸‹è½½</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15231584798585.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;ä½¿ç”¨é—²ç½®çš„VPSæ­å»ºç§äººBTç¦»çº¿æœåŠ¡å™¨çš„æ–¹æ³•ï¼Œäº¦æˆ–è€…æ¨å¹¿è‡³æ ‘è“æ´¾æˆ–è€…å®¶ç”¨è·¯ç”±å™¨äº¦å¯ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="http://frankchen.xyz/tags/Linux/"/>
    
      <category term="Old Driver" scheme="http://frankchen.xyz/tags/Old-Driver/"/>
    
  </entry>
  
  <entry>
    <title>numpy ä¸­å¢åŠ channelçš„æ–¹æ³•</title>
    <link href="http://frankchen.xyz/2018/03/29/numpy-add-channel/"/>
    <id>http://frankchen.xyz/2018/03/29/numpy-add-channel/</id>
    <published>2018-03-29T12:15:30.000Z</published>
    <updated>2018-03-29T12:48:49.127Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15223277046847.jpg" alt=""><br>numpy æ•°ç»„ä¸­ä¸€ç»´æ€ä¹ˆè½¬äºŒç»´å’Œå¤šç»´ï¼Ÿç®€è¿° numpy ä¸­å¢åŠ channelçš„æ–¹æ³•ã€‚</p><a id="more"></a><p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯å‘é‡å’ŒçŸ©é˜µï¼Œè€Œæ€ä¹ˆæ ¹æ®æˆ‘ä»¬æ‰€è¦è§£å†³çš„é—®é¢˜æ¥è°ƒæ•´æ¨¡å‹ä»¥åŠæ•°æ®çš„æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯çŸ©é˜µçš„ç»´åº¦å’Œå¤§å°æ˜¯ä¸€é¡¹é‡è¦çš„åŸºæœ¬åŠŸï¼Œé‚£ä¹ˆæœ¬æ–‡å°±å…·ä½“ä»‹ç»ä¸‹numpyä¸­æ•°ç»„çš„è½¬æ¢ï¼Œä¹Ÿå°±æ˜¯å¢åŠ channelçš„æ–¹æ³•ã€‚</p><h2 id="ä¸€ç»´è½¬äºŒç»´"><a href="#ä¸€ç»´è½¬äºŒç»´" class="headerlink" title="ä¸€ç»´è½¬äºŒç»´"></a>ä¸€ç»´è½¬äºŒç»´</h2><p>ä¾‹å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸€ç»´çš„numpy arrayï¼Œæœ‰å¦‚ä¸‹æ–¹æ³•å¯ä»¥è½¬ä¸ºäºŒç»´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">a = np.arange(<span class="number">10</span>)</div><div class="line">a</div><div class="line">a.shape</div><div class="line">b = a[:,<span class="keyword">None</span>]</div><div class="line">b</div><div class="line">b.shape</div><div class="line"><span class="string">'''</span></div><div class="line">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</div><div class="line">(10,)</div><div class="line">array([[0],</div><div class="line">       [1],</div><div class="line">       [2],</div><div class="line">       [3],</div><div class="line">       [4],</div><div class="line">       [5],</div><div class="line">       [6],</div><div class="line">       [7],</div><div class="line">       [8],</div><div class="line">       [9]])</div><div class="line">(10, 1)</div><div class="line">'''</div></pre></td></tr></table></figure><p> å¯ä»¥çœ‹åˆ°ï¼Œ<code>a</code>ç¡®å®è¢«è½¬ä¸ºäº†äºŒç»´ï¼Œä»¥ä¸‹æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line">c = a[:,np.newaxis]</div><div class="line">c</div><div class="line">(c == b).all()</div><div class="line">np.newaxis == <span class="keyword">None</span></div><div class="line"><span class="string">'''</span></div><div class="line">array([[0],</div><div class="line">       [1],</div><div class="line">       [2],</div><div class="line">       [3],</div><div class="line">       [4],</div><div class="line">       [5],</div><div class="line">       [6],</div><div class="line">       [7],</div><div class="line">       [8],</div><div class="line">       [9]])</div><div class="line">True</div><div class="line">True</div><div class="line">'''</div></pre></td></tr></table></figure><h2 id="è½¬ä¸ºå¤šç»´"><a href="#è½¬ä¸ºå¤šç»´" class="headerlink" title="è½¬ä¸ºå¤šç»´"></a>è½¬ä¸ºå¤šç»´</h2><p>æ—¶é—´åºåˆ—é¢„æµ‹ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éœ€è¦çš„æ˜¯(sampleï¼Œtime_stampï¼Œfeature)çš„3 ä¸ªchannelçš„æ•°æ®ï¼Œå³ä¸€ä¸ªä¸‰ç»´çŸ©é˜µï¼ŒåŒ…å«è‹¥å¹²ä¸ªsampleï¼Œæ¯ä¸ªsampleåŒ…å«è‹¥å¹²ä¸ªæ—¶é—´åºåˆ—ç‚¹ï¼Œè€Œæ¯ä¸ªæ—¶é—´åºåˆ—ç‚¹æœ‰åŒ…æ‹¬è‹¥å¹²ä¸ªfeatureï¼Œå“ªæ€•æˆ‘ä»¬åªæ˜¯åšå•å˜é‡çš„æ—¶é—´åºåˆ—é¢„æµ‹ï¼Œè¾“å…¥RNNç½‘ç»œä¾‹å¦‚LSTMçš„æ—¶å€™ï¼Œæ•°æ®ä¹Ÿå¿…é¡»æ˜¯ä¸‰ç»´çš„æ ¼å¼ï¼Œä¸‹é¢æˆ‘ä»¬è®²ä¸€è®²è¿™ä¹ˆåšçš„æ–¹æ³•ã€‚</p><p>ä¾‹å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªè‹¥å¹²ä¸ªæ—¶é—´ç‚¹æ¯ä¸ªæ—¶é—´ç‚¹æœ‰ä¸¤ä¸ªç‰¹å¾çš„æ•°æ®ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">a = np.arange(<span class="number">24</span>).reshape((<span class="number">-1</span>,<span class="number">2</span>))</div><div class="line">a.shape</div><div class="line">a</div><div class="line"><span class="string">'''</span></div><div class="line">(12, 2)</div><div class="line">array([[ 0,  1],</div><div class="line">       [ 2,  3],</div><div class="line">       [ 4,  5],</div><div class="line">       [ 6,  7],</div><div class="line">       [ 8,  9],</div><div class="line">       [10, 11],</div><div class="line">       [12, 13],</div><div class="line">       [14, 15],</div><div class="line">       [16, 17],</div><div class="line">       [18, 19],</div><div class="line">       [20, 21],</div><div class="line">       [22, 23]])</div><div class="line">'''</div></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†aè½¬åŒ–ä¸ºä¸‰ä¸ªchannelï¼Œå³å¯ä»¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">b = a[:,<span class="keyword">None</span>,:]</div><div class="line">b.shape</div><div class="line">b</div><div class="line"><span class="string">'''</span></div><div class="line">(12, 1, 2)</div><div class="line">array([[[ 0,  1]],</div><div class="line"></div><div class="line">       [[ 2,  3]],</div><div class="line"></div><div class="line">       [[ 4,  5]],</div><div class="line"></div><div class="line">       [[ 6,  7]],</div><div class="line"></div><div class="line">       [[ 8,  9]],</div><div class="line"></div><div class="line">       [[10, 11]],</div><div class="line"></div><div class="line">       [[12, 13]],</div><div class="line"></div><div class="line">       [[14, 15]],</div><div class="line"></div><div class="line">       [[16, 17]],</div><div class="line"></div><div class="line">       [[18, 19]],</div><div class="line"></div><div class="line">       [[20, 21]],</div><div class="line"></div><div class="line">       [[22, 23]]])</div><div class="line">       '''</div></pre></td></tr></table></figure><p>ä»¥ä¸Šå¯¹åº”ç€pandasçš„Dataframeï¼ŒåŠæˆ‘ä»¬å¯¹Dataframeå–valueså±æ€§ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªäºŒç»´çŸ©é˜µï¼Œåšæ³•å°±å¦‚åŒä¸Šé¢ä¸€æ ·ï¼Œä½†æ˜¯å¦‚æœæ˜¯Seriesçš„è¯ï¼Œå–valueså±æ€§å¾—åˆ°çš„æ˜¯ä¸€ä¸ªä¸€ç»´çš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬çš„åšæ³•åˆ™æ˜¯ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">c = np.arange(<span class="number">12</span>)</div><div class="line">c</div><div class="line">d = c[:,<span class="keyword">None</span>,<span class="keyword">None</span>]</div><div class="line">d.shape</div><div class="line">d</div><div class="line"><span class="string">'''</span></div><div class="line">array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])</div><div class="line">(12, 1, 1)</div><div class="line">array([[[ 0]],</div><div class="line"></div><div class="line">       [[ 1]],</div><div class="line"></div><div class="line">       [[ 2]],</div><div class="line"></div><div class="line">       [[ 3]],</div><div class="line"></div><div class="line">       [[ 4]],</div><div class="line"></div><div class="line">       [[ 5]],</div><div class="line"></div><div class="line">       [[ 6]],</div><div class="line"></div><div class="line">       [[ 7]],</div><div class="line"></div><div class="line">       [[ 8]],</div><div class="line"></div><div class="line">       [[ 9]],</div><div class="line"></div><div class="line">       [[10]],</div><div class="line"></div><div class="line">       [[11]]])</div><div class="line">'''</div></pre></td></tr></table></figure><h2 id="å‡å°‘ç»´åº¦"><a href="#å‡å°‘ç»´åº¦" class="headerlink" title="å‡å°‘ç»´åº¦"></a>å‡å°‘ç»´åº¦</h2><p>è‹¥è¦å‡å°‘æ•°æ®çš„ç»´åº¦ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨çš„æ–¹æ³•å¦‚ä¸‹ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">d = np.arange(<span class="number">12</span>)[:,<span class="keyword">None</span>,<span class="keyword">None</span>]</div><div class="line">d.shape</div><div class="line">d</div><div class="line">e = np.squeeze(d)</div><div class="line">e.shape</div><div class="line">e</div><div class="line"><span class="string">'''(12, 1, 1)</span></div><div class="line">array([[[ 0]],</div><div class="line"></div><div class="line">       [[ 1]],</div><div class="line"></div><div class="line">       [[ 2]],</div><div class="line"></div><div class="line">       [[ 3]],</div><div class="line"></div><div class="line">       [[ 4]],</div><div class="line"></div><div class="line">       [[ 5]],</div><div class="line"></div><div class="line">       [[ 6]],</div><div class="line"></div><div class="line">       [[ 7]],</div><div class="line"></div><div class="line">       [[ 8]],</div><div class="line"></div><div class="line">       [[ 9]],</div><div class="line"></div><div class="line">       [[10]],</div><div class="line"></div><div class="line">       [[11]]])</div><div class="line">(12,)</div><div class="line">array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])'''</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15223277046847.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;numpy æ•°ç»„ä¸­ä¸€ç»´æ€ä¹ˆè½¬äºŒç»´å’Œå¤šç»´ï¼Ÿç®€è¿° numpy ä¸­å¢åŠ channelçš„æ–¹æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="python" scheme="http://frankchen.xyz/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>python æ­£åˆ™å®ç”¨ä¾‹å­</title>
    <link href="http://frankchen.xyz/2018/02/24/re-basic-of-python/"/>
    <id>http://frankchen.xyz/2018/02/24/re-basic-of-python/</id>
    <published>2018-02-24T10:52:00.000Z</published>
    <updated>2018-02-24T11:09:45.871Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15194705842254.png" alt=""></p><p>æœ¬æ–‡ä¸»è¦å…³äºpythonçš„æ­£åˆ™è¡¨è¾¾å¼çš„ç¬¦å·ä¸æ–¹æ³•ã€‚</p><a id="more"></a><ul><li>findall: æ‰¾å¯»æ‰€æœ‰åŒ¹é…ï¼Œè¿”å›æ‰€æœ‰ç»„åˆçš„åˆ—è¡¨</li><li>search: æ‰¾å¯»ç¬¬ä¸€ä¸ªåŒ¹é…å¹¶è¿”å›</li><li>sub: æ›¿æ¢ç¬¦åˆè§„å¾‹çš„å†…å®¹ï¼Œå¹¶è¿”å›æ›¿æ¢åçš„å†…å®¹</li></ul><p><strong>.</strong>ï¼šåŒ¹é…é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">a = <span class="string">'xy123'</span></div><div class="line">b = re.findall(<span class="string">'x...'</span>,a)</div><div class="line">print(b)</div><div class="line"><span class="comment"># ['xy12']</span></div></pre></td></tr></table></figure><p><strong>*</strong>ï¼šåŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦0æ¬¡æˆ–è€…æ— é™æ¬¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">a = <span class="string">'xyxy123'</span></div><div class="line">b = re.findall(<span class="string">'x*'</span>,a)</div><div class="line">print(b)</div><div class="line"><span class="comment"># ['x', '', 'x', '', '', '', '', '']</span></div></pre></td></tr></table></figure><p><strong>?</strong>ï¼šåŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦0æ¬¡æˆ–è€…1æ¬¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">a = <span class="string">'xy123'</span></div><div class="line">b = re.findall(<span class="string">'x?'</span>,a)</div><div class="line">print(b)</div><div class="line"><span class="comment"># ['x', '', '', '', '', '']</span></div></pre></td></tr></table></figure><p><strong>.*</strong>ï¼šè´ªå¿ƒç®—æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">b = re.findall(<span class="string">'xx.*xx'</span>,secret_code)</div><div class="line">print(b)</div><div class="line"><span class="comment"># ['xxIxxfasdjifja134xxlovexx23345sdfxxyouxx']</span></div></pre></td></tr></table></figure><p><strong>.*?</strong>ï¼šéè´ªå¿ƒç®—æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">c = re.findall(<span class="string">'xx.*?xx'</span>,secret_code)</div><div class="line">print(c)</div><div class="line"><span class="comment"># ['xxIxx', 'xxlovexx', 'xxyouxx']</span></div></pre></td></tr></table></figure><p><strong>()</strong>ï¼šæ‹¬å·å†…ç»“æœè¿”å›</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">d = re.findall(<span class="string">'xx(.*?)xx'</span>,secret_code)</div><div class="line">print(d)</div><div class="line"><span class="keyword">for</span> each <span class="keyword">in</span> d:</div><div class="line">    print(each)</div><div class="line"><span class="comment"># ['I', 'love', 'you']</span></div><div class="line"><span class="comment"># I</span></div><div class="line"><span class="comment"># love</span></div><div class="line"><span class="comment"># you</span></div></pre></td></tr></table></figure><p><strong>re.S</strong>ä½¿å¾—.çš„ä½œç”¨åŸŸåŒ…æ‹¬æ¢è¡Œç¬¦â€\nâ€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">s = <span class="string">'''sdfxxhello</span></div><div class="line">xxfsdfxxworldxxasdf'''</div><div class="line"></div><div class="line">d = re.findall(<span class="string">'xx(.*?)xx'</span>,s,re.S)</div><div class="line">print(d)</div><div class="line"><span class="comment">#  ['hello\n', 'world']</span></div></pre></td></tr></table></figure><p>å¯¹æ¯”findallä¸searchçš„åŒºåˆ«</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">s2 = <span class="string">'asdfxxIxx123xxlovexxdfd'</span></div><div class="line">f = re.search(<span class="string">'xx(.*?)xx123xx(.*?)xx'</span>,s2).group(<span class="number">2</span>)</div><div class="line">print(f)</div><div class="line">f2 = re.findall(<span class="string">'xx(.*?)xx123xx(.*?)xx'</span>,s2)</div><div class="line">print(f2[<span class="number">0</span>][<span class="number">1</span>])</div><div class="line"><span class="comment"># love</span></div><div class="line"><span class="comment"># love</span></div></pre></td></tr></table></figure><p>è™½ç„¶ä¸¤è€…ç»“æœç›¸åŒï¼Œä½†æ˜¯searchæ˜¯æ­é…groupæ¥å¾—åˆ°ç¬¬äºŒä¸ªåŒ¹é…ï¼Œè€Œfindallçš„ç»“æœæ˜¯[(â€˜Iâ€™, â€˜loveâ€™)]ï¼ŒåŒ…å«å…ƒç»„çš„åˆ—è¡¨ï¼Œæ‰€ä»¥éœ€è¦f2[0][1]æ¥å¼•å…¥ã€‚</p><p><strong>sub</strong>çš„ä½¿ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">s = <span class="string">'123rrrrr123'</span></div><div class="line">output = re.sub(<span class="string">'123(.*?)123'</span>,<span class="string">'123%d123'</span>%<span class="number">789</span>,s)</div><div class="line">print(output)</div><div class="line"><span class="comment"># 123789123</span></div></pre></td></tr></table></figure><p>ä¾‹å¦‚æˆ‘ä»¬éœ€è¦å°†æ–‡æ¡£ä¸­çš„æ‰€æœ‰çš„pngå›¾ç‰‡æ”¹å˜è·¯å¾„ï¼Œå³éœ€è¦æ‰¾åˆ°æ‰€æœ‰çš„<code>.png</code>ç»“å°¾ï¼Œå†å°†å…¶éƒ½åŠ ä¸Šè·¯å¾„ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">multiply</span><span class="params">(m)</span>:</span></div><div class="line">    <span class="comment"># Convert group 0 to an integer.</span></div><div class="line">    v = m.group(<span class="number">0</span>)</div><div class="line">    print(v)</div><div class="line">    <span class="comment"># Multiply integer by 2.</span></div><div class="line">    <span class="comment"># ... Convert back into string and return it.</span></div><div class="line">    print(<span class="string">'basic/'</span>+v)</div><div class="line">    <span class="keyword">return</span> <span class="string">'basic/'</span>+v</div></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>autoencoder.png</div><div class="line">    basic/autoencoder.png</div><div class="line">    RNN.png</div><div class="line">    basic/RNN.png</div><div class="line">    rnn_step_forward.png</div><div class="line">    basic/rnn_step_forward.png</div><div class="line">    rnns.png</div><div class="line">    basic/rnns.png</div><div class="line">    rnn_cell_backprop.png</div><div class="line">    basic/rnn_cell_backprop.png</div><div class="line">    LSTM.png</div><div class="line">    basic/LSTM.png</div><div class="line">    LSTM_rnn.png</div><div class="line">    basic/LSTM_rnn.png</div><div class="line">    attn_mechanism.png</div><div class="line">    basic/attn_mechanism.png</div><div class="line">    attn_model.png</div><div class="line">    basic/attn_model.png</div></pre></td></tr></table></figure><p>ä»¿ç…§ä¸Šé¢æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„å¯¹æˆ‘ä»¬çš„ä»»åŠ¡è¿›è¡Œå®šåˆ¶ã€‚</p><p><strong>subn</strong> ç›¸æ¯”subï¼Œsubnè¿”å›å…ƒç»„ï¼Œç¬¬äºŒä¸ªå…ƒç´ è¡¨ç¤ºæ›¿æ¢å‘ç”Ÿçš„æ¬¡æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(m)</span>:</span></div><div class="line">    <span class="comment"># Convert.</span></div><div class="line">    v = int(m.group(<span class="number">0</span>))</div><div class="line">    <span class="comment"># Add 2.</span></div><div class="line">    <span class="keyword">return</span> str(v + <span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="comment"># Call re.subn.</span></div><div class="line">result = re.subn(<span class="string">"\d+"</span>, add, <span class="string">"1 2 3 4 5"</span>)</div><div class="line"></div><div class="line">print(<span class="string">"Result string:"</span>, result[<span class="number">0</span>])</div><div class="line">print(<span class="string">"Number of substitutions:"</span>, result[<span class="number">1</span>])</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span></div><div class="line">Result string: <span class="number">11</span> <span class="number">21</span> <span class="number">31</span> <span class="number">41</span> <span class="number">51</span></div><div class="line">Number of substitutions: <span class="number">5</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15194705842254.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦å…³äºpythonçš„æ­£åˆ™è¡¨è¾¾å¼çš„ç¬¦å·ä¸æ–¹æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="python" scheme="http://frankchen.xyz/tags/python/"/>
    
      <category term="re" scheme="http://frankchen.xyz/tags/re/"/>
    
  </entry>
  
  <entry>
    <title>Tex å†™ï¼ˆä¸­æ–‡ï¼‰æ¯•ä¸šè®ºæ–‡å…¨æ”»ç•¥</title>
    <link href="http://frankchen.xyz/2018/02/08/Writing-Graduation-Thesis-in-Tex/"/>
    <id>http://frankchen.xyz/2018/02/08/Writing-Graduation-Thesis-in-Tex/</id>
    <published>2018-02-07T17:36:41.000Z</published>
    <updated>2018-02-07T18:11:41.628Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15180252634406.png" alt=""></p><p>ç”¨ Tex å†™ï¼ˆä¸­æ–‡ï¼‰æ¯•ä¸šè®ºæ–‡å…¨æ”»ç•¥ï¼Œé«˜æ•ˆã€ä¾¿æ·ã€ä¼˜é›…ï¼</p><a id="more"></a><p>è¿™é‡Œæˆ‘ä»¬å¹¶ä¸å­˜åœ¨é„™è§†é“¾ï¼Œè¯´ä»€ä¹ˆTex ä¼˜äº Wordä¹‹ç±»çš„ï¼Œå…¶å®Wordä½œä¸ºæå…¶å¤æ‚çš„æ–‡æœ¬å¤„ç†è½¯ä»¶ï¼Œæˆ‘ç›¸ä¿¡Texèƒ½åšåˆ°çš„ï¼ŒWordä¸€å®šæœ‰å…¶å®ç°æ–¹å¼ï¼Œåªä¸è¿‡å¤§éƒ¨åˆ†äººéƒ½åªä¼šç”¨åˆ°Wordçš„ä¸€å°éƒ¨åˆ†åŠŸèƒ½ï¼Œç›¸æ¯”Wordï¼ŒTexè§£å†³æ–¹æ¡ˆæ›´åŠ ä¾¿æ·ä¼˜é›…ï¼Œæ¯”å¦‚è‡ªåŠ¨æ’å·ï¼ˆç« èŠ‚ã€è¡¨æ ¼ã€å‚è€ƒæ–‡çŒ®çš„ç¼–å·ï¼‰ï¼Œå…¨å±€è®¾ç½®çš„å­—ä½“ã€é—´è·æ ¼å¼ç­‰ç­‰ã€‚ç›¸æ¯”Wordäº‹æ— å·¨ç»†çš„ç»´æŠ¤ä¿®æ”¹æˆæœ¬ï¼ŒTex çš„è§£å†³æ–¹æ¡ˆæ›´åŠ programmerï¼Œå³è½¯ä»¶å¼€å‘ï¼ŒåæœŸä¸»è¦å·¥ä½œæ˜¯è¿­ä»£ç»´æŠ¤ï¼Œè‹¥èƒ½åœ¨å‰æœŸå³è€ƒè™‘è¿™ç‚¹ï¼ŒåæœŸèƒ½çœä¸‹æå¤šçš„è„‘ç»†èƒå’Œç²¾åŠ›ã€‚å¥½äº†ä¸è¯´å¤šï¼Œå‘è½¦å§~</p><h2 id="æ€»è®º"><a href="#æ€»è®º" class="headerlink" title="æ€»è®º"></a>æ€»è®º</h2><p> æ€»ä½“æ¥è¯´ï¼Œæ˜¯ç”¨ä¸Šäº¤Texæ¨¡æ¿ç»“åˆAtomç¼–è¾‘å™¨åœ¨æœ¬åœ°ç¼–è¾‘<a href="https://atom.io/" target="_blank" rel="external">Atom</a>ï¼ˆè¿™ä¸ªç”¨ä»€ä¹ˆç¼–è¾‘å™¨éšæ„ï¼‰ä»¥åŠDropboxåŒæ­¥åˆ°äº‘ç«¯<a href="https://www.dropbox.com/h" target="_blank" rel="external">Dropbox</a>ä»¥åŠäº‘ç«¯ä¸Šåœ¨sharelatexæœåŠ¡å™¨ä¸Šå³æ—¶ç¼–è¯‘æ‰€è§å³æ‰€å¾—ã€‚</p><h2 id="å·¥å…·ä½¿ç”¨æ–¹æ³•"><a href="#å·¥å…·ä½¿ç”¨æ–¹æ³•" class="headerlink" title="å·¥å…·ä½¿ç”¨æ–¹æ³•"></a>å·¥å…·ä½¿ç”¨æ–¹æ³•</h2><p>é¦–å…ˆæˆ‘ä»¬åœ¨sharelatexå®˜ç½‘<a href="https://www.sharelatex.com/project" target="_blank" rel="external">Your Projects - ShareLaTeX, Online LaTeX Editor</a>æ³¨å†Œè´¦å·ï¼Œå…è´¹è´¦å·å³å¯ï¼Œå¦‚æœéœ€è¦å¤šäººåä½œå¯ä»¥ç”¨é‚€è¯·å°å·çš„æ–¹å¼è®©è‡ªå·±å¢åŠ æƒé™ï¼ˆsharelatexæ–°å»ºè´¦å·ä¸éªŒè¯é‚®ç®±ã€‚ã€‚æ‰€ä»¥ä½ æ‡‚çš„ï¼‰ï¼Œæ¥ä¸‹æ¥åœ¨ä¸Šäº¤æ¨¡æ¿<a href="https://github.com/sjtug/SJTUThesis" target="_blank" rel="external">sjtug/SJTUThesis: ä¸Šæµ·äº¤é€šå¤§å­¦ XeLaTeX å­¦ä½è®ºæ–‡æ¨¡æ¿ A XeLaTeX template for Shanghai Jiao Tong University (SJTU) thesis.</a>å¤„ç‚¹å‡»æ­¤å¤„æ·»åŠ æœ€æ–°ç‰ˆæ¨¡æ¿åˆ°æˆ‘ä»¬çš„sharelatexé¡¹ç›®ï¼Œ<br><img src="/images/Screen%20Shot%202018-02-08%20at%2001.58.25.png" alt="Screen Shot 2018-02-08 at 01.58.25"></p><p><img src="/images/Screen%20Shot%202018-02-08%20at%2001.58.56.png" alt="Screen Shot 2018-02-08 at 01.58.56"></p><p>å¦‚å›¾ï¼Œå†ç‚¹è¿›å»ï¼Œå…ˆåˆ«æ€¥ç€ä¿®æ”¹ï¼Œæˆ‘ä»¬å…ˆè®¾ç½®ä¸ªç½‘ç›˜åŒæ­¥ï¼ŒDropboxéœ€è¦æ¢¯å­ï¼Œåœ¨sharelatexçš„è´¦å·è®¾ç½®å¤„é“¾æ¥åˆ°Dropboxï¼Œ<br><img src="/images/Screen%20Shot%202018-02-08%20at%2002.00.57.png" alt="Screen Shot 2018-02-08 at 02.00.57"></p><p>åŒæ—¶Dropboxå®‰è£…ä¸€ä¸ªæ¡Œé¢ç‰ˆï¼Œéœ€è¦è®¾ç½®ä»£ç†ï¼Œ<br><img src="/images/Screen%20Shot%202018-02-08%20at%2002.02.29.png" alt="Screen Shot 2018-02-08 at 02.02.29"><br>å¦‚å›¾ï¼Œæˆ‘ä»¬ä½¿ç”¨ssä½œä¸ºä»£ç†ã€‚</p><p>æ¥ä¸‹æ¥å®‰è£…Atomç¼–è¾‘å™¨ï¼Œåœ¨æ’ä»¶é‡Œè£…ä¸€ä¸ªå¦‚ä¸‹æ’ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å®ƒåªæ˜¯ä¸ºäº†æ³¨é‡Šè¿™ä¸€ä¸ªåŠŸèƒ½ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦æœ¬åœ°ç¼–è¯‘ã€‚<br><img src="/images/Screen%20Shot%202018-02-08%20at%2002.03.38.png" alt="Screen Shot 2018-02-08 at 02.03.38"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥åœ¨æœ¬åœ°ç”¨Atomç¼–è¾‘Dropboxç½‘ç›˜åœ¨æœ¬åœ°çš„Texé¡¹ç›®ï¼Œåªè¦æˆ‘ä»¬ä¿å­˜ï¼ŒDropboxå°±ä¼šåŒæ­¥åˆ°sharelatexï¼Œå¦‚æœå¼€å¯è‡ªåŠ¨ç¼–è¯‘äº‘ç«¯å°±ä¼šå±•ç¤ºå½“ä¸‹ç¼–è¯‘çš„PDFæ•ˆæœï¼Œå¦‚å›¾<br><img src="/images/Screen%20Shot%202018-02-08%20at%2002.07.11.png" alt="Screen Shot 2018-02-08 at 02.07.11"></p><h2 id="Texæ¨¡æ¿ä½¿ç”¨è¯´æ˜"><a href="#Texæ¨¡æ¿ä½¿ç”¨è¯´æ˜" class="headerlink" title="Texæ¨¡æ¿ä½¿ç”¨è¯´æ˜"></a>Texæ¨¡æ¿ä½¿ç”¨è¯´æ˜</h2><p>è¯¦è§æ­¤å¤„<a href="http://sjtug.org/SJTUThesis/README.pdf" target="_blank" rel="external">README.pdf</a>ï¼Œä¸»è¦æ€è·¯å°±æ˜¯æŠŠå„ç« ã€æ‘˜è¦ã€å‚è€ƒæ–‡çŒ®ç­‰åˆ†ä¸ºä¸åŒçš„texæ–‡ä»¶ï¼Œå›¾è¡¨ç­‰èµ„æºæ”¾åœ¨ä¸€å¤„æ–‡ä»¶å¤¹å†…ï¼Œé€ä¸ªå¼•ç”¨ï¼Œæœ‰å…¨å±€çš„çš„è®¾ç½®æ–‡ä»¶ï¼Œç¼–è¯‘æ—¶å°†è¿™äº›é›¶ä»¶æ‹¼æ¥ä¸ºpdfï¼Œåç»­ä¼šæ·»åŠ æ›´å¤šå¿ƒå¾—ã€‚</p><h2 id="èµ„æ–™"><a href="#èµ„æ–™" class="headerlink" title="èµ„æ–™"></a>èµ„æ–™</h2><ol><li><a href="https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference" target="_blank" rel="external">MathJax basic tutorial and quick reference - Mathematics Meta Stack Exchange</a>ï¼šä¸€ä¸ªå¸¸ç”¨Latexå…¬å¼ç¬¦å·çš„å…¨é›†</li><li>å¦‚æœä¸Šé¢æ²¡æ‰¾åˆ°ï¼Œå¯ä»¥è¯•è¯•è¿™é‡Œï¼Œæ‰‹å†™è¯†åˆ«latexå­—ç¬¦<a href="http://detexify.kirelabs.org/classify.html" target="_blank" rel="external">Detexify LaTeX handwritten symbol recognition</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15180252634406.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;ç”¨ Tex å†™ï¼ˆä¸­æ–‡ï¼‰æ¯•ä¸šè®ºæ–‡å…¨æ”»ç•¥ï¼Œé«˜æ•ˆã€ä¾¿æ·ã€ä¼˜é›…ï¼&lt;/p&gt;
    
    </summary>
    
    
      <category term="Tex" scheme="http://frankchen.xyz/tags/Tex/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£TSNEç®—æ³•</title>
    <link href="http://frankchen.xyz/2018/01/30/Understanding-TSNE/"/>
    <id>http://frankchen.xyz/2018/01/30/Understanding-TSNE/</id>
    <published>2018-01-30T03:39:39.000Z</published>
    <updated>2018-01-30T08:17:42.455Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15172836269060.jpg" alt=""></p><p>ç»“åˆ<a href="http://lvdmaaten.github.io/publications/papers/JMLR_2008.pdf" target="_blank" rel="external">è®ºæ–‡</a>å…¬å¼ä¸å‡ ä¸ªpythonå®ç°ç†è§£t-SNEç®—æ³•ã€‚<br><a id="more"></a></p><p>t-SNE æ˜¯ä¸€ç§æ•°æ®å¯è§†åŒ–å·¥å…·ï¼Œå®ƒå¯ä»¥å°†é«˜ç»´æ•°æ®é™ç»´åˆ°2-3ç»´ä»¥ç”¨äºç”»å›¾ï¼Œå±€éƒ¨ç›¸ä¼¼æ€§è¢«è¿™ç§embeddingæ‰€ä¿ç•™ã€‚</p><p>t-SNEæŠŠåŸç©ºé—´çš„æ•°æ®ç‚¹ä¹‹é—´çš„è·ç¦»è½¬æ¢ä¸ºé«˜æ–¯åˆ†å¸ƒæ¦‚ç‡ï¼Œå¦‚æœä¸¤ç‚¹åœ¨é«˜ç»´ç©ºé—´è·ç¦»è¶Šè¿‘ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¦‚ç‡å€¼è¶Šå¤§ã€‚æ³¨æ„åˆ°é«˜æ–¯åˆ†å¸ƒçš„è¿™ä¸ªæ ‡å‡†å·®$\sigma_i$ å¯¹æ¯ä¸ªç‚¹éƒ½æ˜¯ä¸åŒçš„ï¼Œè¿™ä¹Ÿæ˜¯ç®—æ³•çš„åˆ›æ–°ç‚¹ä¹‹ä¸€ï¼Œå› ä¸ºç†è®ºä¸Šç©ºé—´ä¸åŒä½ç½®çš„ç‚¹çš„å¯†åº¦æ˜¯ä¸åŒçš„ï¼Œæ¡ä»¶æ¦‚ç‡å¦‚æ­¤è®¡ç®—ï¼Œ</p><p>$$p_{j|i} = \frac{\exp{(-d(\boldsymbol{x}_i, \boldsymbol{x}_j) / (2 \sigma_i^2)})}{\sum_{i \neq k} \exp{(-d(\boldsymbol{x}_i, \boldsymbol{x}_k) / (2 \sigma_i^2)})}, \quad p_{i|i} = 0,$$<br><img src="/images/Screen%20Shot%202018-01-30%20at%2015.18.45.png" alt="Screen Shot 2018-01-30 at 15.18.45"></p><p>å›¾ä¸­å…¬å¼æ˜¯ç†è®ºæ–¹å¼ï¼Œå®é™…æ˜¯å…ˆè®¡ç®—æ¡ä»¶æ¦‚ç‡å†ç”¨ä¸‹é¢å…¬å¼æ¥äº§ç”Ÿè”åˆåˆ†å¸ƒï¼Œ</p><p>$$p_{ij} = \frac{p_{j|i} + p_{i|j}}{2N}.$$</p><p>å…¶ä¸­ $\sigma_i$ å°†è‡ªåŠ¨ç¡®å®šã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥é€šè¿‡è®¾ç½®ç®—æ³•çš„å›°æƒ‘æ€§æ¥å½±å“ã€‚</p><p>ç”¨ä¸€ä¸ªé•¿å°¾åˆ†å¸ƒ(Student-t Distributionï¼Œç®€ç§°ä¸ºtåˆ†å¸ƒ)æ¥è¡¨ç¤º embedç©ºé—´çš„ç›¸ä¼¼æ€§<br>$$q_{ij} = \frac{(1 + ||\boldsymbol{y}_i - \boldsymbol{y}_j)||^2)^{-1}}{\sum_{k \neq l} (1 + ||\boldsymbol{y}_k - \boldsymbol{y}_l)||^2)^{-1}},$$<br><img src="/images/Screen%20Shot%202018-01-30%20at%2015.28.56.png" alt="Screen Shot 2018-01-30 at 15.28.56"></p><p>æŸå¤±å‡½æ•°æ˜¯ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„ Kullback-Leibler divergenceï¼ˆKLæ•£åº¦ï¼‰</p><p>$$KL(P|Q) = \sum_{i \neq j} p_{ij} \log \frac{p_{ij}}{q_{ij}}$$</p><p>è€Œä¸ºä»€ä¹ˆè¯´tsneä¿ç•™çš„æ˜¯å±€éƒ¨ç›¸ä¼¼æ€§å‘¢ï¼Ÿæˆ‘ä»¬ä»KLæ•£åº¦çš„å…¬å¼å‡ºå‘æ¥è§£é‡Šï¼Œ<br><img src="/images/Screen%20Shot%202018-01-30%20at%2015.33.19.png" alt="Screen Shot 2018-01-30 at 15.33.19"><br>å¯ä»¥çœ‹åˆ°ï¼Œå½“$p_{ij}$å¾ˆå¤§è€Œ$q_{ij}$å¾ˆå°ï¼ˆé«˜ç»´ç©ºé—´è·ç¦»è¿‘ï¼Œä½ç»´ç©ºé—´è·ç¦»è¿œï¼‰æƒ©ç½šå¾ˆå¤§ï¼Œåä¹‹æƒ©ç½šå°ï¼ˆé«˜ç»´ç©ºé—´è·ç¦»è¿œï¼Œä½ç»´ç©ºé—´è·ç¦»è¿‘ï¼‰ã€‚</p><p>è€Œä¸ºä»€ä¹ˆé«˜ç»´ç©ºé—´ç”¨é«˜æ–¯åˆ†å¸ƒï¼Œä½ç»´ç©ºé—´ç”¨Student-t Distributionå‘¢ï¼Ÿ</p><p><img src="/images/Screen%20Shot%202018-01-30%20at%2015.41.32.png" alt="Screen Shot 2018-01-30 at 15.41.32"><img src="/images/Screen%20Shot%202018-01-30%20at%2015.41.43.png" alt="Screen Shot 2018-01-30 at 15.41.43"><br>åŸå› å°±æ˜¯å› ä¸ºé™ç»´æ˜¯å¿…ç„¶è¦å¸¦æ¥ä¿¡æ¯æŸå¤±ï¼Œæˆ‘ä»¬è¦ä¿å­˜å±€éƒ¨ä¿¡æ¯é‚£ä¹ˆå¿…ç„¶è¦æŸå¤±å…¨å±€ä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦æŠŠä¸Šé¢çš„è¿™ä¸ª2ç»´ç©ºé—´çš„ä¸‰ä¸ªæˆç›´è§’è¾¹çš„ç‚¹é™ç»´åˆ°1ç»´ï¼Œé‚£ä¹ˆæŠŠå®ƒä»¬æ”¾å¹³å°±ä¿å­˜äº†å±€éƒ¨ä¿¡æ¯ï¼ˆå·¦ä¸­å’Œä¸­å³ä¹‹é—´çš„è·ç¦»ä¿æŒä¸å˜ï¼‰ï¼Œä½†æ˜¯ç‰ºç‰²äº†å…¨å±€ä¿¡æ¯ï¼ˆå·¦å³ä¹‹é—´çš„è·ç¦»å˜å¤§äº†ï¼‰ã€‚è€ŒStudent-t Distributionå°±èƒ½æ”¾å¤§è¿™ç§å¯†åº¦ï¼Œå¦‚ä¸‹å›¾ï¼ˆtsneé»˜è®¤tåˆ†å¸ƒè‡ªç”±åº¦ä¸º1ï¼‰ï¼Œtåˆ†å¸ƒç›¸æ¯”é«˜æ–¯åˆ†å¸ƒæ›´åŠ é•¿å°¾ã€‚<br><img src="/images/Screen%20Shot%202018-01-30%20at%2015.48.47.png" alt="Screen Shot 2018-01-30 at 15.48.47"><br>æ¢¯åº¦è®¡ç®—æ—¶æœ‰ä¼˜åŒ–æŠ€å·§ï¼Œå¦‚æœæŒ‰ä¸‹å›¾ä¸­çš„åŸå…¬å¼è®¡ç®—ï¼Œå¤æ‚åº¦ä¸º$O(N^2)$ Barnes-Hut æ ‘æ–¹æ³•å°±å¯ä»¥ä¼˜åŒ–åˆ°$ O(NlogN)$<br><img src="/images/Screen%20Shot%202018-01-30%20at%2015.59.02.png" alt="Screen Shot 2018-01-30 at 15.59.02"><br><img src="/images/Screen%20Shot%202018-01-30%20at%2016.01.17.png" alt="Screen Shot 2018-01-30 at 16.01.17"><br>åŸç†ç±»ä¼¼äºç”¨ä¸Šå›¾ä¸­ABCä¸‰ç‚¹ä¸­å¿ƒçš„è·ç¦»ä¹˜ä»¥ä¸‰æ¥ä»£æ›¿è®¡ç®—ä¸‰è€…å„è‡ªçš„è·ç¦»ã€‚<br>é‚£ä¹ˆæŠŠç”¨barnesæ ‘ç»“æ„æ¥è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œåˆ†åˆ«åˆ¤æ–­å…¶è·ç¦»æ˜¯å¦å¤§äºé˜ˆå€¼ï¼Œåˆ†å—è®¡ç®—è·ç¦»ï¼Œè¿™æ ·å¤æ‚åº¦å°±é™ä½äº†ã€‚<br><img src="/images/Screen%20Shot%202018-01-30%20at%2016.01.38.png" alt="Screen Shot 2018-01-30 at 16.01.38"></p><p>ä»¥ä¸‹æ˜¯è®¡ç®—æŸå¤±KLæ•£åº¦çš„å…¬å¼ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">_kl_divergence</span><span class="params">(params, P, degrees_of_freedom, n_samples, n_components,</span></span></div><div class="line">                   skip_num_points=<span class="number">0</span>):</div><div class="line">    <span class="string">"""t-SNE objective function: gradient of the KL divergence</span></div><div class="line">    of p_ijs and q_ijs and the absolute error."""</div><div class="line">    X_embedded = params.reshape(n_samples, n_components)</div><div class="line"></div><div class="line">    <span class="comment"># Q is a heavy-tailed distribution: Student's t-distribution</span></div><div class="line">    n = pdist(X_embedded, <span class="string">"sqeuclidean"</span>)</div><div class="line">    n += <span class="number">1.</span></div><div class="line">    n /= degrees_of_freedom</div><div class="line">    n **= (degrees_of_freedom + <span class="number">1.0</span>) / <span class="number">-2.0</span></div><div class="line">    Q = np.maximum(n / (<span class="number">2.0</span> * np.sum(n)), MACHINE_EPSILON)</div><div class="line"></div><div class="line">    <span class="comment"># Optimization trick below: np.dot(x, y) is faster than</span></div><div class="line">    <span class="comment"># np.sum(x * y) because it calls BLAS</span></div><div class="line"></div><div class="line">    <span class="comment"># Objective: C (Kullback-Leibler divergence of P and Q)</span></div><div class="line">    kl_divergence = <span class="number">2.0</span> * np.dot(P, np.log(P / Q))</div><div class="line"></div><div class="line">    <span class="comment"># Gradient: dC/dY</span></div><div class="line">    grad = np.ndarray((n_samples, n_components))</div><div class="line">    PQd = squareform((P - Q) * n)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(skip_num_points, n_samples):</div><div class="line">        np.dot(_ravel(PQd[i]), X_embedded[i] - X_embedded, out=grad[i])</div><div class="line">    grad = grad.ravel()</div><div class="line">    c = <span class="number">2.0</span> * (degrees_of_freedom + <span class="number">1.0</span>) / degrees_of_freedom</div><div class="line">    grad *= c</div></pre></td></tr></table></figure><p>ç”¨æ¢¯åº¦ä¸‹é™ï¼ˆå’Œä¸€äº›tricksï¼‰ä¼˜åŒ–ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯æŸå¤±å‡½æ•°éå¯¹ç§°ï¼Œå¹¶ä¸”ä¸åŒçš„è®­ç»ƒä¼šå¯¼è‡´ç»“æœçš„ä¸åŒã€‚</p><p>sklearné‡Œå¯¹äºbinary searchè®¡ç®— è”åˆåˆ†å¸ƒä¸‹é¢çš„(<a href="https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/manifold/_utils.pyx" target="_blank" rel="external">_utils._binary_search_perplexity</a>)å’ŒBarnes-Hut æ ‘è®¡ç®—æ¢¯åº¦(<a href="https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/manifold/_barnes_hut_tsne.pyx" target="_blank" rel="external">_barnes_hut_tsne.gradient</a>)éƒ½æ˜¯Cå®ç°ï¼Œæœ‰ç©ºå†æ¥ç ”ç©¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">_joint_probabilities</span><span class="params">(distances, desired_perplexity, verbose)</span>:</span></div><div class="line">    <span class="string">"""Compute joint probabilities p_ij from distances."""</span></div><div class="line">    <span class="comment"># Compute conditional probabilities such that they approximately match</span></div><div class="line">    <span class="comment"># the desired perplexity</span></div><div class="line">    distances = astype(distances, np.float32, copy=<span class="keyword">False</span>)</div><div class="line">    </div><div class="line">    conditional_P = _utils._binary_search_perplexity(</div><div class="line">        distances, <span class="keyword">None</span>, desired_perplexity, verbose)</div><div class="line">    P = conditional_P + conditional_P.T</div><div class="line">    sum_P = np.maximum(np.sum(P), MACHINE_EPSILON)</div><div class="line">    P = np.maximum(squareform(P) / sum_P, MACHINE_EPSILON)</div><div class="line">    <span class="keyword">return</span> P</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">_kl_divergence_bh</span><span class="params">(params, P, neighbors, degrees_of_freedom, n_samples,</span></span></div><div class="line">                      n_components, angle=<span class="number">0.5</span>, skip_num_points=<span class="number">0</span>,</div><div class="line">                      verbose=False):</div><div class="line">    <span class="string">"""t-SNE objective function: KL divergence of p_ijs and q_ijs."""</span></div><div class="line">    params = astype(params, np.float32, copy=<span class="keyword">False</span>)</div><div class="line">    X_embedded = params.reshape(n_samples, n_components)</div><div class="line">    neighbors = astype(neighbors, np.int64, copy=<span class="keyword">False</span>)</div><div class="line">    <span class="keyword">if</span> len(P.shape) == <span class="number">1</span>:</div><div class="line">        sP = squareform(P).astype(np.float32)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        sP = P.astype(np.float32)</div><div class="line"></div><div class="line">    grad = np.zeros(X_embedded.shape, dtype=np.float32)</div><div class="line">    error = _barnes_hut_tsne.gradient(sP, X_embedded, neighbors,</div><div class="line">                                      grad, angle, n_components, verbose,</div><div class="line">                                      dof=degrees_of_freedom)</div><div class="line">    c = <span class="number">2.0</span> * (degrees_of_freedom + <span class="number">1.0</span>) / degrees_of_freedom</div><div class="line">    grad = grad.ravel()</div><div class="line">    grad *= c</div><div class="line"></div><div class="line">    <span class="keyword">return</span> error, grad</div></pre></td></tr></table></figure><p><a href="http://lvdmaaten.github.io/tsne/" target="_blank" rel="external">t-SNE â€“ Laurens van der Maaten</a>è¿™ä¸ªé“¾æ¥æ˜¯ä½œè€…æ”¶é›†çš„å„ç§tsneå˜ç§åŠç›¸å…³å®ç°ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15172836269060.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;ç»“åˆ&lt;a href=&quot;http://lvdmaaten.github.io/publications/papers/JMLR_2008.pdf&quot;&gt;è®ºæ–‡&lt;/a&gt;å…¬å¼ä¸å‡ ä¸ªpythonå®ç°ç†è§£t-SNEç®—æ³•ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="python" scheme="http://frankchen.xyz/tags/python/"/>
    
      <category term="Algorithm" scheme="http://frankchen.xyz/tags/Algorithm/"/>
    
  </entry>
  
  <entry>
    <title>Data Science Pipelines |  ç‰¹å¾å·¥ç¨‹ä¸­çš„ç®¡é“</title>
    <link href="http://frankchen.xyz/2018/01/12/Data-Science-Notes/"/>
    <id>http://frankchen.xyz/2018/01/12/Data-Science-Notes/</id>
    <published>2018-01-12T06:22:50.000Z</published>
    <updated>2018-04-08T08:13:01.013Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15161698020879.png" alt=""></p><p>æš‚å®šä¸ºè®°å½•å„å¼æ•°æ®ç§‘å­¦é¡¹ç›®ã€Kaggleç«èµ›é‡Œé¢å¸¸ç”¨ã€æœ‰ç”¨çš„ä»£ç ç‰‡æ®µã€APIã€ç¥æ“ä½œç­‰ï¼Œé€šå¸¸æ˜¯Numpyã€Pandasã€Matplotlibã€Seabornç­‰ç›¸å…³ï¼Œé€šå¸¸æ¥è¯´ï¼Œé¡¹ç›®åŸºæœ¬æ­¥éª¤å¯ä»¥åˆ†ä¸ºEDAã€ç‰¹å¾å·¥ç¨‹ä»¥åŠè°ƒå‚ã€‚</p><a id="more"></a><h2 id="åŸºæœ¬æµç¨‹"><a href="#åŸºæœ¬æµç¨‹" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h2><ol><li><p>ä»¥ä¸€ä¸ªKaggleä¸Šçš„House Priceä¸ºæ¡ˆä¾‹ï¼Œæœºå™¨å­¦ä¹ æµç¨‹åˆ†æˆä¸¤ä¸ªå¤§æ­¥éª¤ ï¼šå³<br>EDAä¸ç‰¹å¾å·¥ç¨‹ï¼ˆåªä½¿ç”¨Pandas, StatsModelï¼Œscipy,numpy, seabornç­‰åº“ï¼‰</p><ul><li><p>è¾“å…¥ï¼š åŸå§‹Train, Test æ•°æ®é›†ï¼Œå°†åŸå§‹Trainå’ŒTest åˆå¹¶æˆä¸€ä¸ªæ•°æ®é›†combined</p></li><li><p>å¤„ç†ï¼š Pandas Pipe</p><p>  æ ¹æ®å„ç§å¯èƒ½å’Œå„ç§ç‰¹å¾å·¥ç¨‹æ–¹æ³•å®šä¹‰å„ç§å‡½æ•°ï¼ˆè¾“å…¥combined, è¾“å…¥pre_combined)<br>  ç”¨PandasPipe å°†è¿™ä¸ªå‡½æ•°åƒæ­ç§¯æœ¨ä¸€æ ·è¿åœ¨ä¸€èµ·ã€‚ç”¨åˆ—è¡¨æŒ‰åºå­˜æ”¾è¿™äº›å‡½æ•°ï¼‰<br>  è¿™ä¸ªåˆ—è¡¨å°±æ˜¯ï¼Œ1. åŸºæœ¬çš„å¡«å……ç©ºå€¼, 2. è½¬æ¢æ•°æ®ç±»å‹ï¼Œ 3. ç©ºç™½å‡½æ•°ï¼ˆä¸ºäº†å¯¹é½ç¾è§‚è€Œä»¥ï¼Œå•¥äº‹ä¸åšï¼‰ï¼Œ4. log è½¬æ¢ï¼Œç±»åˆ«æ•°æ®å“‘å…ƒå¤„ç†ï¼Œ 5. å¯¼å‡ºåˆ°hdf5æ–‡ä»¶ï¼Œ 6.æ£€æŸ¥R2å€¼<br>  åˆ©ç”¨å„ç§æ’åˆ—ç»„åˆï¼Œæˆ–è€…å„ç§å‚æ•°ç»„åˆï¼Œå¯ä»¥äº§ç”Ÿä¸°å¯Œçš„pipesï¼Œæ¯ä¸€ä¸ªpipeséƒ½å¯ä»¥äº§ç”Ÿä¸€ä¸ªé¢„å¤„ç†è¿‡çš„æ–‡ä»¶ã€‚</p></li><li><p>è¾“å‡ºï¼šæŸæ–‡ä»¶å¤¹ä¸‹ çš„Nä¸ªé¢„å¤„ç†è¿‡çš„hdf5æ–‡ä»¶ã€‚ é’ˆå¯¹å„ç§ç‰¹å¾å·¥ç¨‹çš„æ’åˆ—ç»„åˆï¼Œæˆ–è€…æ˜¯Kaggleä¸Šé¢çš„å„ç§æ–°å¥‡çš„ç‰¹å¾å·¥ç¨‹æ–¹æ³•ã€‚</p></li></ul></li><li><p>æœºå™¨å­¦ä¹ é˜¶æ®µï¼ˆè®­ç»ƒå’Œäº§ç”Ÿæ¨¡å‹ï¼Œç›®æ ‡æ˜¯å°½å¯èƒ½è·å¾—å°½å¯èƒ½ä½çš„RMSEå€¼ï¼ˆé’ˆå¯¹è®­ç»ƒæ•°æ®ï¼‰ï¼ŒåŒæ—¶è¦å…·æœ‰èŒƒåŒ–çš„èƒ½åŠ›ï¼ˆé’ˆå¯¹æµ‹è¯•æ•°æ®ï¼‰ï¼‰</p><ul><li>ç¬¬ä¸€æ­¥ï¼Œå»ºç«‹åŸºå‡†ï¼Œç­›é€‰å‡ºæœ€å¥½çš„ä¸€ä¸ªï¼ˆå‡ ä¸ªï¼‰é¢„å¤„ç†æ–‡ä»¶ï¼ˆéšæœºæ•°è®¾æˆå›ºå®šå€¼ï¼‰</li><li>ç¬¬äºŒæ­¥ï¼Œé’ˆå¯¹ç­›é€‰å‡ºæ¥çš„é¢„å¤„ç†æ–‡ä»¶ï¼Œè¿›è¡Œè°ƒå‚ã€‚æ‰¾åˆ°æœ€åˆé€‚çš„å‡ ä¸ªç®—æ³•ï¼ˆé€šå¸¸æ˜¯RMSEå€¼æœ€ä½ï¼Œä¸”ä¸åŒKernelï¼‰ï¼ˆéšæœºæ•°è®¾æˆå›ºå®šå€¼ï¼‰    </li><li>ç¬¬ä¸‰æ­¥ï¼Œç”¨è°ƒå¥½çš„å‚æ•°æ¥é¢„å¤„ç†æ–‡ä»¶ä¸­çš„Traingæ•°æ®çš„åšaverage å’Œstacking</li><li>ç¬¬å››éƒ¨ï¼Œç”Ÿæˆcsvæ–‡ä»¶ï¼Œæäº¤åˆ°Kaggle çœ‹çœ‹å¾—åˆ†å¦‚ä½•ã€‚</li></ul></li></ol><h2 id="å‡†å¤‡é˜¶æ®µ-ä¸-NoteBook-Head"><a href="#å‡†å¤‡é˜¶æ®µ-ä¸-NoteBook-Head" class="headerlink" title="å‡†å¤‡é˜¶æ®µ ä¸ NoteBook Head"></a>å‡†å¤‡é˜¶æ®µ ä¸ NoteBook Head</h2><p>è¿‡æ»¤warningï¼šæœ‰å¥è¯è¯´çš„å¥½ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦é‡Œï¼Œæˆ‘ä»¬åªåœ¨æ„é”™è¯¯ä¸åœ¨æ„warning</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> warnings</div><div class="line">warnings.filterwarnings(<span class="string">"ignore"</span>)</div></pre></td></tr></table></figure><hr><p>å·¥ä½œç›®å½•åˆ‡æ¢åˆ°å½“å‰pythonæ–‡ä»¶æ‰€åœ¨ç›®å½•<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line">os.chdir(os.path.dirname(os.path.abspath(__file__)))</div></pre></td></tr></table></figure></p><hr><p>Notebookäº¤äº’è¾“å‡ºæ‰€æœ‰ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> IPython.core.interactiveshell <span class="keyword">import</span> InteractiveShell</div><div class="line">InteractiveShell.ast_node_interactivity=<span class="string">'all'</span></div></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹<br><img src="/images/Screen%20Shot%202018-01-12%20at%2015.27.58.png" alt="Screen Shot 2018-01-12 at 15.27.58"></p><p>ä»¥ä¸Šå¯ä»¥é€šè¿‡è®¾ç½®å›ºå®šä¸‹æ¥ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p><p><img src="/images/Screen%20Shot%202018-02-05%20at%2014.51.01.png" alt="Screen Shot 2018-02-05 at 14.51.01"></p><p><img src="/images/Screen%20Shot%202018-02-05%20at%2014.50.29.png" alt="Screen Shot 2018-02-05 at 14.50.29"></p><hr><p>ä¸€èˆ¬å¯¹trainä»¥åŠteståšä¸€ä¸ªconcatï¼Œå¹¶è®°å½•trainçš„æ¡æ•°ntrain<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">train = pd.read_csv(<span class="string">"train.csv.gz"</span>)</div><div class="line">test = pd.read_csv(<span class="string">"test.csv.gz"</span>)</div><div class="line"></div><div class="line">combined = pd.concat([train,test],axis =<span class="number">0</span>, ignore_index =<span class="keyword">True</span>)</div><div class="line">ntrain = train.shape[<span class="number">0</span>]</div><div class="line">Y_train = train[<span class="string">"SalePrice"</span>]</div><div class="line">X_train = train.drop([<span class="string">"Id"</span>,<span class="string">"SalePrice"</span>],axis=<span class="number">1</span>)</div><div class="line">print(<span class="string">"train data shape:\t "</span>,train.shape)</div><div class="line">print(<span class="string">"test data shape:\t "</span>,test.shape)</div><div class="line">print(<span class="string">"combined data shape:\t"</span>,combined.shape)</div></pre></td></tr></table></figure></p><h2 id="EDAç›¸å…³"><a href="#EDAç›¸å…³" class="headerlink" title="EDAç›¸å…³"></a>EDAç›¸å…³</h2><p>1D Scatter</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">nca = NCA(num_dims=<span class="number">1</span>)</div><div class="line">nca.fit(xx_t, yy)</div><div class="line">xxxxx = nca.transform(xx)</div><div class="line">zeros=np.zeros_like(xxxxx)</div><div class="line">plt.scatter(xxxxx, zeros+<span class="number">1</span>,c=yy[:,np.newaxis])</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/myplot.png" alt="myplot"></p><hr><p>ç¼ºå¤±å€¼åˆ†æ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cols_missing_value = combined.isnull().sum()/combined.shape[<span class="number">0</span>]</div><div class="line">cols_missing_value = cols_missing_value[cols_missing_value&gt;<span class="number">0</span>]</div><div class="line">print(<span class="string">"How many features is bad/missing value? The answer is:"</span>,cols_missing_value.shape[<span class="number">0</span>])</div><div class="line">cols_missing_value.sort_values(ascending=<span class="keyword">False</span>).head(<span class="number">10</span>).plot.barh()</div></pre></td></tr></table></figure><p><img src="/images/15161679439549.jpg" alt=""></p><p>æœ‰ç¼ºå¤± - éœ€è¦å¡«å……æˆ–è€…åˆ é™¤ï¼Œé€šå¸¸ç”¨å‡å€¼æˆ–è€…ä¸­æŒ‡ï¼Œæˆ–è€…ç”¨äººå·¥åˆ†æï¼ˆäººå·¥åˆ†ææ˜¯æåˆ†å…³é”®ï¼‰</p><hr><p>å°†è‹¥å¹²ä¸ªDataframeç”»åœ¨åŒä¸€ä¸ªå›¾é‡Œé¢ç›¸åŒåæ ‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">fig, ax = plt.subplots()</div><div class="line"><span class="comment"># desc, group æ˜¯ä¸€ä¸ªDataframe groupby desc å‡ºçš„ç»“æœ</span></div><div class="line"><span class="keyword">for</span> desc, group <span class="keyword">in</span> Energy_sources:</div><div class="line">    group.plot(x = group.index, y=<span class="string">'Value'</span>, label=desc,ax = ax, title=<span class="string">'Carbon Emissions per Energy Source'</span>, fontsize = <span class="number">20</span>)</div><div class="line">    ax.set_xlabel(<span class="string">'Time(Monthly)'</span>)</div><div class="line">    ax.set_ylabel(<span class="string">'Carbon Emissions in MMT'</span>)</div><div class="line">    ax.xaxis.label.set_size(<span class="number">20</span>)</div><div class="line">    ax.yaxis.label.set_size(<span class="number">20</span>)</div><div class="line">    ax.legend(fontsize = <span class="number">16</span>)</div></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹å›¾ï¼Œ<br><img src="/images/15157398435931.jpg" alt=""></p><hr><p>ç”»a*bçš„å­å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">fig, axes = plt.subplots(<span class="number">3</span>,<span class="number">3</span>, figsize = (<span class="number">30</span>, <span class="number">20</span>))</div><div class="line"><span class="comment"># desc, group æ˜¯ä¸€ä¸ªDataframe groupby desc å‡ºçš„ç»“æœ ä¹Ÿå°±æ˜¯ä¸‹é¢çš„Energy_sources</span></div><div class="line"><span class="keyword">for</span> (desc, group), ax <span class="keyword">in</span> zip(Energy_sources, axes.flatten()):</div><div class="line">    group.plot(x = group.index, y=<span class="string">'Value'</span>,ax = ax, title=desc, fontsize = <span class="number">18</span>)</div><div class="line">    ax.set_xlabel(<span class="string">'Time(Monthly)'</span>)</div><div class="line">    ax.set_ylabel(<span class="string">'Carbon Emissions in MMT'</span>)</div><div class="line">    ax.xaxis.label.set_size(<span class="number">18</span>)</div><div class="line">    ax.yaxis.label.set_size(<span class="number">18</span>)</div></pre></td></tr></table></figure><p><img src="/images/15157402388676.jpg" alt=""></p><hr><p>ç”»æŸ±çŠ¶å›¾</p><p><img src="/images/Screen%20Shot%202018-01-12%20at%2015.19.32.png" alt="Screen Shot 2018-01-12 at 15.19.32"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">fig = plt.figure(figsize = (<span class="number">16</span>,<span class="number">9</span>))</div><div class="line"><span class="comment"># CO2_per_sourceçš„æ¥æºä¸ç»“æ„å¦‚ä¸Šå›¾</span></div><div class="line">x_label = map(<span class="keyword">lambda</span> x: x[:<span class="number">20</span>],CO2_per_source.index)</div><div class="line">x_tick = np.arange(len(cols))</div><div class="line">plt.bar(x_tick, CO2_per_source, align = <span class="string">'center'</span>, alpha = <span class="number">0.5</span>)</div><div class="line">fig.suptitle(<span class="string">"CO2 Emissions by Electric Power Sector"</span>, fontsize= <span class="number">25</span>)</div><div class="line">plt.xticks(x_tick, x_label, rotation = <span class="number">70</span>, fontsize = <span class="number">15</span>)</div><div class="line">plt.yticks(fontsize = <span class="number">20</span>)</div><div class="line">plt.xlabel(<span class="string">'Carbon Emissions in MMT'</span>, fontsize = <span class="number">20</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15157416530029.jpg" alt=""></p><hr><p>é‡å å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> statsmodels.tsa.seasonal <span class="keyword">import</span> seasonal_decompose</div><div class="line">decomposition = seasonal_decompose(mte)</div><div class="line"></div><div class="line">trend = decomposition.trend</div><div class="line">seasonal = decomposition.seasonal</div><div class="line">residual = decomposition.resid</div><div class="line"></div><div class="line">plt.subplot(<span class="number">411</span>)</div><div class="line">plt.plot(mte, label=<span class="string">'Original'</span>)</div><div class="line">plt.legend(loc=<span class="string">'best'</span>)</div><div class="line">plt.subplot(<span class="number">412</span>)</div><div class="line">plt.plot(trend, label=<span class="string">'Trend'</span>)</div><div class="line">plt.legend(loc=<span class="string">'best'</span>)</div><div class="line">plt.subplot(<span class="number">413</span>)</div><div class="line">plt.plot(seasonal,label=<span class="string">'Seasonality'</span>)</div><div class="line">plt.legend(loc=<span class="string">'best'</span>)</div><div class="line">plt.subplot(<span class="number">414</span>)</div><div class="line">plt.plot(residual, label=<span class="string">'Residuals'</span>)</div><div class="line">plt.legend(loc=<span class="string">'best'</span>)</div><div class="line">plt.tight_layout()</div></pre></td></tr></table></figure><p><img src="/images/15157543822442.jpg" alt=""></p><hr><p>ç¯å½¢å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">plt.subplots(figsize=(<span class="number">15</span>,<span class="number">15</span>))</div><div class="line">data=response[<span class="string">'PublicDatasetsSelect'</span>].str.split(<span class="string">','</span>)</div><div class="line">dataset=[]</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data.dropna():</div><div class="line">    dataset.extend(i)</div><div class="line">pd.Series(dataset).value_counts().plot.pie(autopct=<span class="string">'%1.1f%%'</span>,colors=sns.color_palette(<span class="string">'Paired'</span>,<span class="number">10</span>),startangle=<span class="number">90</span>,wedgeprops = &#123; <span class="string">'linewidth'</span> : <span class="number">2</span>, <span class="string">'edgecolor'</span> : <span class="string">'white'</span> &#125;)</div><div class="line">plt.title(<span class="string">'Dataset Source'</span>)</div><div class="line">my_circle=plt.Circle( (<span class="number">0</span>,<span class="number">0</span>), <span class="number">0.7</span>, color=<span class="string">'white'</span>)</div><div class="line">p=plt.gcf()</div><div class="line">p.gca().add_artist(my_circle)</div><div class="line">plt.ylabel(<span class="string">''</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159953413652.jpg" alt=""></p><hr><p>é¥¼çŠ¶å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">f,ax=plt.subplots(<span class="number">1</span>,<span class="number">2</span>,figsize=(<span class="number">18</span>,<span class="number">8</span>))</div><div class="line">response[<span class="string">'JobSkillImportancePython'</span>].value_counts().plot.pie(ax=ax[<span class="number">0</span>],autopct=<span class="string">'%1.1f%%'</span>,explode=[<span class="number">0.1</span>,<span class="number">0</span>,<span class="number">0</span>],shadow=<span class="keyword">True</span>,colors=[<span class="string">'g'</span>,<span class="string">'lightblue'</span>,<span class="string">'r'</span>])</div><div class="line">ax[<span class="number">0</span>].set_title(<span class="string">'Python Necessity'</span>)</div><div class="line">ax[<span class="number">0</span>].set_ylabel(<span class="string">''</span>)</div><div class="line">response[<span class="string">'JobSkillImportanceR'</span>].value_counts().plot.pie(ax=ax[<span class="number">1</span>],autopct=<span class="string">'%1.1f%%'</span>,explode=[<span class="number">0</span>,<span class="number">0.1</span>,<span class="number">0</span>],shadow=<span class="keyword">True</span>,colors=[<span class="string">'lightblue'</span>,<span class="string">'g'</span>,<span class="string">'r'</span>])</div><div class="line">ax[<span class="number">1</span>].set_title(<span class="string">'R Necessity'</span>)</div><div class="line">ax[<span class="number">1</span>].set_ylabel(<span class="string">''</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159954686370.jpg" alt=""></p><hr><p>ç»´æ©å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">f,ax=plt.subplots(<span class="number">1</span>,<span class="number">2</span>,figsize=(<span class="number">18</span>,<span class="number">8</span>))</div><div class="line">pd.Series([python.shape[<span class="number">0</span>],R.shape[<span class="number">0</span>],both.shape[<span class="number">0</span>]],index=[<span class="string">'Python'</span>,<span class="string">'R'</span>,<span class="string">'Both'</span>]).plot.bar(ax=ax[<span class="number">0</span>])</div><div class="line">ax[<span class="number">0</span>].set_title(<span class="string">'Number of Users'</span>)</div><div class="line">venn2(subsets = (python.shape[<span class="number">0</span>],R.shape[<span class="number">0</span>],both.shape[<span class="number">0</span>]), set_labels = (<span class="string">'Python Users'</span>, <span class="string">'R Users'</span>))</div><div class="line">plt.title(<span class="string">'Venn Diagram for Users'</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159955616741.jpg" alt=""></p><h2 id="Seaborn"><a href="#Seaborn" class="headerlink" title="Seaborn"></a>Seaborn</h2><p>count plot</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">plt.subplots(figsize=(<span class="number">22</span>,<span class="number">12</span>))</div><div class="line">sns.countplot(y=response[<span class="string">'GenderSelect'</span>],order=response[<span class="string">'GenderSelect'</span>].value_counts().index)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159941639903.jpg" alt=""></p><hr><p>åˆ©ç”¨squarifyç”»æ ‘å½¢å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> squarify</div><div class="line">tree=response[<span class="string">'Country'</span>].value_counts().to_frame()</div><div class="line">squarify.plot(sizes=tree[<span class="string">'Country'</span>].values,label=tree.index,color=sns.color_palette(<span class="string">'RdYlGn_r'</span>,<span class="number">52</span>))</div><div class="line">plt.rcParams.update(&#123;<span class="string">'font.size'</span>:<span class="number">20</span>&#125;)</div><div class="line">fig=plt.gcf()</div><div class="line">fig.set_size_inches(<span class="number">40</span>,<span class="number">15</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159945932245.jpg" alt=""></p><hr><p>snsç”»åˆ†å¸ƒå›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">plt.subplots(figsize=(<span class="number">15</span>,<span class="number">8</span>))</div><div class="line">salary=salary[salary[<span class="string">'Salary'</span>]&lt;<span class="number">1000000</span>]</div><div class="line">sns.distplot(salary[<span class="string">'Salary'</span>])</div><div class="line">plt.title(<span class="string">'Salary Distribution'</span>,size=<span class="number">15</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159947979455.jpg" alt=""></p><hr><p>snså­å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">f,ax=plt.subplots(<span class="number">1</span>,<span class="number">2</span>,figsize=(<span class="number">18</span>,<span class="number">8</span>))</div><div class="line">sal_coun=salary.groupby(<span class="string">'Country'</span>)[<span class="string">'Salary'</span>].median().sort_values(ascending=<span class="keyword">False</span>)[:<span class="number">15</span>].to_frame()</div><div class="line">sns.barplot(<span class="string">'Salary'</span>,sal_coun.index,data=sal_coun,palette=<span class="string">'RdYlGn'</span>,ax=ax[<span class="number">0</span>])</div><div class="line">ax[<span class="number">0</span>].axvline(salary[<span class="string">'Salary'</span>].median(),linestyle=<span class="string">'dashed'</span>)</div><div class="line">ax[<span class="number">0</span>].set_title(<span class="string">'Highest Salary Paying Countries'</span>)</div><div class="line">ax[<span class="number">0</span>].set_xlabel(<span class="string">''</span>)</div><div class="line">max_coun=salary.groupby(<span class="string">'Country'</span>)[<span class="string">'Salary'</span>].median().to_frame()</div><div class="line">max_coun=max_coun[max_coun.index.isin(resp_coun.index)]</div><div class="line">max_coun.sort_values(by=<span class="string">'Salary'</span>,ascending=<span class="keyword">True</span>).plot.barh(width=<span class="number">0.8</span>,ax=ax[<span class="number">1</span>],color=sns.color_palette(<span class="string">'RdYlGn'</span>))</div><div class="line">ax[<span class="number">1</span>].axvline(salary[<span class="string">'Salary'</span>].median(),linestyle=<span class="string">'dashed'</span>)</div><div class="line">ax[<span class="number">1</span>].set_title(<span class="string">'Compensation of Top 15 Respondent Countries'</span>)</div><div class="line">ax[<span class="number">1</span>].set_xlabel(<span class="string">''</span>)</div><div class="line">ax[<span class="number">1</span>].set_ylabel(<span class="string">''</span>)</div><div class="line">plt.subplots_adjust(wspace=<span class="number">0.8</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159948678550.jpg" alt=""></p><hr><p>seabornç®±å‹å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">plt.subplots(figsize=(<span class="number">10</span>,<span class="number">8</span>))</div><div class="line">sns.boxplot(y=<span class="string">'GenderSelect'</span>,x=<span class="string">'Salary'</span>,data=salary)</div><div class="line">plt.ylabel(<span class="string">''</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159949427978.jpg" alt=""></p><hr><p>seaborn count_plot</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">f,ax=plt.subplots(<span class="number">1</span>,<span class="number">2</span>,figsize=(<span class="number">25</span>,<span class="number">15</span>))</div><div class="line">sns.countplot(y=response[<span class="string">'MajorSelect'</span>],ax=ax[<span class="number">0</span>],order=response[<span class="string">'MajorSelect'</span>].value_counts().index)</div><div class="line">ax[<span class="number">0</span>].set_title(<span class="string">'Major'</span>)</div><div class="line">ax[<span class="number">0</span>].set_ylabel(<span class="string">''</span>)</div><div class="line">sns.countplot(y=response[<span class="string">'CurrentJobTitleSelect'</span>],ax=ax[<span class="number">1</span>],order=response[<span class="string">'CurrentJobTitleSelect'</span>].value_counts().index)</div><div class="line">ax[<span class="number">1</span>].set_title(<span class="string">'Current Job'</span>)</div><div class="line">ax[<span class="number">1</span>].set_ylabel(<span class="string">''</span>)</div><div class="line">plt.subplots_adjust(wspace=<span class="number">0.8</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159950249702.jpg" alt=""></p><hr><p>seaborn å›¾ä¸­æ·»åŠ æ–‡å­—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">sal_job=salary.groupby(<span class="string">'CurrentJobTitleSelect'</span>)[<span class="string">'Salary'</span>].median().to_frame().sort_values(by=<span class="string">'Salary'</span>,ascending=<span class="keyword">False</span>)</div><div class="line">ax=sns.barplot(sal_job.Salary,sal_job.index,palette=sns.color_palette(<span class="string">'inferno'</span>,<span class="number">20</span>))</div><div class="line">plt.title(<span class="string">'Compensation By Job Title'</span>,size=<span class="number">15</span>)</div><div class="line"><span class="keyword">for</span> i, v <span class="keyword">in</span> enumerate(sal_job.Salary): </div><div class="line">    ax.text(<span class="number">.5</span>, i, v,fontsize=<span class="number">10</span>,color=<span class="string">'white'</span>,weight=<span class="string">'bold'</span>)</div><div class="line">fig=plt.gcf()</div><div class="line">fig.set_size_inches(<span class="number">8</span>,<span class="number">8</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159951024672.jpg" alt=""></p><hr><p>è¯äº‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> wordcloud <span class="keyword">import</span> WordCloud, STOPWORDS</div><div class="line"><span class="keyword">import</span> nltk</div><div class="line"><span class="keyword">from</span> nltk.corpus <span class="keyword">import</span> stopwords</div><div class="line">free=pd.read_csv(<span class="string">'../input/freeformResponses.csv'</span>)</div><div class="line">stop_words=set(stopwords.words(<span class="string">'english'</span>))</div><div class="line">stop_words.update(<span class="string">','</span>,<span class="string">';'</span>,<span class="string">'!'</span>,<span class="string">'?'</span>,<span class="string">'.'</span>,<span class="string">'('</span>,<span class="string">')'</span>,<span class="string">'$'</span>,<span class="string">'#'</span>,<span class="string">'+'</span>,<span class="string">':'</span>,<span class="string">'...'</span>)</div><div class="line">motivation=free[<span class="string">'KaggleMotivationFreeForm'</span>].dropna().apply(nltk.word_tokenize)</div><div class="line">motivate=[]</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> motivation:</div><div class="line">    motivate.extend(i)</div><div class="line">motivate=pd.Series(motivate)</div><div class="line">motivate=([i <span class="keyword">for</span> i <span class="keyword">in</span> motivate.str.lower() <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> stop_words])</div><div class="line">f1=open(<span class="string">"kaggle.png"</span>, <span class="string">"wb"</span>)</div><div class="line">f1.write(codecs.decode(kaggle,<span class="string">'base64'</span>))</div><div class="line">f1.close()</div><div class="line">img1 = imread(<span class="string">"kaggle.png"</span>)</div><div class="line">hcmask1 = img1</div><div class="line">wc = WordCloud(background_color=<span class="string">"black"</span>, max_words=<span class="number">4000</span>, mask=hcmask1, </div><div class="line">               stopwords=STOPWORDS, max_font_size= <span class="number">60</span>,width=<span class="number">1000</span>,height=<span class="number">1000</span>)</div><div class="line">wc.generate(<span class="string">" "</span>.join(motivate))</div><div class="line">plt.imshow(wc)</div><div class="line">plt.axis(<span class="string">'off'</span>)</div><div class="line">fig=plt.gcf()</div><div class="line">fig.set_size_inches(<span class="number">10</span>,<span class="number">10</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15159971204332.jpg" alt=""></p><hr><p>ç®€å•æƒ…å†µä¸‹çš„åˆ†ç±»å±•ç¤º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> IPython <span class="keyword">import</span> display</div><div class="line"></div><div class="line">h = <span class="number">0.01</span></div><div class="line">x_min, x_max = X[:, <span class="number">0</span>].min() - <span class="number">1</span>, X[:, <span class="number">0</span>].max() + <span class="number">1</span></div><div class="line">y_min, y_max = X[:, <span class="number">1</span>].min() - <span class="number">1</span>, X[:, <span class="number">1</span>].max() + <span class="number">1</span></div><div class="line">xx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">visualize</span><span class="params">(X, y, w, history)</span>:</span></div><div class="line">    <span class="string">"""draws classifier prediction with matplotlib magic"""</span></div><div class="line">    Z = probability(expand(np.c_[xx.ravel(), yy.ravel()]), w)</div><div class="line">    Z = Z.reshape(xx.shape)</div><div class="line">    plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>)</div><div class="line">    plt.contourf(xx, yy, Z, alpha=<span class="number">0.8</span>)</div><div class="line">    plt.scatter(X[:, <span class="number">0</span>], X[:, <span class="number">1</span>], c=y, cmap=plt.cm.Paired)</div><div class="line">    plt.xlim(xx.min(), xx.max())</div><div class="line">    plt.ylim(yy.min(), yy.max())</div><div class="line">    </div><div class="line">    plt.subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>)</div><div class="line">    plt.plot(history)</div><div class="line">    plt.grid()</div><div class="line">    ymin, ymax = plt.ylim()</div><div class="line">    plt.ylim(<span class="number">0</span>, ymax)</div><div class="line">    display.clear_output(wait=<span class="keyword">True</span>)</div><div class="line">    plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15163355887784.jpg" alt=""></p><hr><p>å›¾ä¸­æ’å…¥LaTeXå…¬å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line">%matplotlib inline</div><div class="line"></div><div class="line">x = np.linspace(<span class="number">-3</span>, <span class="number">3</span>)</div><div class="line">x_squared, x_squared_der = s.run([scalar_squared, derivative[<span class="number">0</span>]],</div><div class="line">                                 &#123;my_scalar:x&#125;)</div><div class="line"></div><div class="line">plt.plot(x, x_squared,label=<span class="string">"$x^2$"</span>)</div><div class="line">plt.plot(x, x_squared_der, label=<span class="string">r"$\frac&#123;dx^2&#125;&#123;dx&#125;$"</span>)</div><div class="line">plt.legend();</div></pre></td></tr></table></figure><p><img src="/images/15163465540386.jpg" alt=""></p><hr><p>ç”»å¤šå¼ å­å›¾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># show random images from train</span></div><div class="line">cols = <span class="number">8</span></div><div class="line">rows = <span class="number">2</span></div><div class="line">fig = plt.figure(figsize=(<span class="number">2</span> * cols - <span class="number">1</span>, <span class="number">2.5</span> * rows - <span class="number">1</span>))</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(cols):</div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(rows):</div><div class="line">        random_index = np.random.randint(<span class="number">0</span>, len(y_train))</div><div class="line">        ax = fig.add_subplot(rows, cols, i * rows + j + <span class="number">1</span>)</div><div class="line">        ax.grid(<span class="string">'off'</span>)</div><div class="line">        ax.axis(<span class="string">'off'</span>)</div><div class="line">        ax.imshow(x_train[random_index, :])</div><div class="line">        ax.set_title(cifar10_classes[y_train[random_index, <span class="number">0</span>]])</div><div class="line">plt.show()</div></pre></td></tr></table></figure><p><img src="/images/15167635233971.jpg" alt=""></p><h2 id="ç‰¹å¾å·¥ç¨‹é˜¶æ®µ"><a href="#ç‰¹å¾å·¥ç¨‹é˜¶æ®µ" class="headerlink" title="ç‰¹å¾å·¥ç¨‹é˜¶æ®µ"></a>ç‰¹å¾å·¥ç¨‹é˜¶æ®µ</h2><p>NumpyåŒºé—´ç™¾åˆ†æ¯”åˆ‡åˆ†å¼‚å¸¸å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># cut off long distance trips</span></div><div class="line">lat_low, lat_hgh = np.percentile(latlong[:,<span class="number">0</span>], [<span class="number">2</span>, <span class="number">98</span>])</div><div class="line">lon_low, lon_hgh = np.percentile(latlong[:,<span class="number">1</span>], [<span class="number">2</span>, <span class="number">98</span>])</div></pre></td></tr></table></figure><hr><p>åˆå§‹åŒ–åŒshapeå‘é‡<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">g2 = np.zeros_like(w)</div><div class="line">``</div><div class="line"></div><div class="line">-------</div><div class="line"></div><div class="line">ç´¯ç§¯sum</div><div class="line">``` python</div><div class="line">a = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>np.cumsum(a,axis=<span class="number">1</span>)      <span class="comment"># sum over columns for each of the 2 rows</span></div><div class="line">array([[ <span class="number">1</span>,  <span class="number">3</span>,  <span class="number">6</span>],</div><div class="line">       [ <span class="number">4</span>,  <span class="number">9</span>, <span class="number">15</span>]])</div><div class="line">``` </div><div class="line"></div><div class="line">-------</div><div class="line">numpy array æ‰©å±•ç»´åº¦ï¼Œå¾ˆç®€å•åœ°å°†Numpyå‘é‡æ‰©å±•ä¸ºäºŒç»´çŸ©é˜µ</div><div class="line">![](/images/<span class="number">15167894435840.</span>png)</div><div class="line">![Screen Shot <span class="number">2018</span><span class="number">-01</span><span class="number">-24</span> at <span class="number">19.02</span><span class="number">.32</span>](/images/Screen%<span class="number">20</span>Shot%<span class="number">202018</span><span class="number">-01</span><span class="number">-24</span>%<span class="number">20</span>at%<span class="number">2019.02</span><span class="number">.32</span>.png)</div><div class="line"></div><div class="line">-------</div><div class="line">Numpy ç«–ç€å æ”¾å‘é‡</div><div class="line">`np.column_stack`</div><div class="line"></div><div class="line">-------</div><div class="line"></div><div class="line">``` python</div><div class="line"><span class="comment"># ç”¨äºæŸ¥çœ‹Dataframeå„åˆ—æ•°æ®ç±»å‹</span></div><div class="line">ts.dtypes</div></pre></td></tr></table></figure></p><hr><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#skewæ˜¯å•å˜é‡å·¥å…·ï¼Œç”¨æ¥ç›‘æµ‹æ•°æ®æ˜¯å¦æœ‰é•¿å°¾ï¼Œå·¦åæˆ–è€…å³å</span></div><div class="line">print(Y_train.skew())</div><div class="line">``` </div><div class="line"></div><div class="line">``` python</div><div class="line"><span class="comment">#np.abs æ˜¯ç»å¯¹å€¼å‡½æ•°ï¼Œç”¨æ¥å–æ•´ä¸ªå‘é‡ç»å¯¹å€¼</span></div><div class="line"><span class="comment"># è¿™é‡Œå¯¹æ‰€æœ‰trainé‡Œçš„ç‰¹å¾æ±‚ååº¦å¹¶æ’åº</span></div><div class="line">np.abs(combined[:ntrain].skew()).sort_values(ascending = <span class="keyword">False</span> ).head(<span class="number">20</span>)</div></pre></td></tr></table></figure><p>æœ‰ååº¦ - éœ€è¦å¤„ç†ã€‚é€šå¸¸æ˜¯ç”¨log1p </p><hr><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># ç”¨äºå°†Dataframeä¸­è¢«è¯»å–ä¸ºobjectçš„æ•°æ®è½¬æ¢ä¸ºæ•°å€¼å‹ï¼Œerrors='coerce'ä»£è¡¨é”™è¯¯å°†è¢«ç½®ä¸ºNaN</span></div><div class="line">ts[<span class="string">'Value'</span>] = pd.to_numeric(ts[<span class="string">'Value'</span>] , errors=<span class="string">'coerce'</span>)</div></pre></td></tr></table></figure><hr><p>è¿‡æ»¤index é‡Œé¢çš„NaNå€¼ï¼Œæ¨å¹¿ä¹Ÿå¯ä»¥è¿‡æ»¤å…¶ä»–åˆ—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ts = df.loc[pd.Series(pd.to_datetime(df.index, errors=<span class="string">'coerce'</span>)).notnull().values]</div></pre></td></tr></table></figure><hr><p>æŒ‰æœˆgroupbyï¼Œä»¥åŠunstackè§£æ„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Emissions.groupby([<span class="string">'Description'</span>, pd.TimeGrouper(<span class="string">'M'</span>)])[<span class="string">'Value'</span>].sum().unstack(level = <span class="number">0</span>)</div></pre></td></tr></table></figure><p><img src="/images/Screen%20Shot%202018-01-12%20at%2016.16.30.png" alt="Screen Shot 2018-01-12 at 16.16.30"></p><hr><p>å°†value_countsã€groupbyç­‰Seriesè½¬æ¢ä¸ºDataframe<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tree=response[<span class="string">'Country'</span>].value_counts().to_frame()</div></pre></td></tr></table></figure></p><hr><p>ç‰¹å¾å·¥ç¨‹å¤§æ€å™¨ï¼Œ<a href="http://pandas.pydata.org/pandas-docs/stable/basics.html?highlight=pipe#tablewise-function-application" target="_blank" rel="external">Pandas Pipe</a><br>è¿™é‡Œæœ‰ä¸ªç®€å•çš„ä¾‹å­ï¼Œ,æ¯ä¸ªpipesé‡Œé¢éƒ½æœ‰è‹¥å¹²ä¸ªç‰¹å¾å¤„ç†å‡½æ•°å’Œä¸€ä¸ªå¿«é€Ÿæµ‹è¯•çš„å‡½æ•°ï¼Œå…¶ä¸­ä¸ºäº†å¯¹é½ç¾è§‚ï¼Œç”¨bypasså‡½æ•°æ¥å¡«å……ç©ºç™½çš„åœ°æ–¹ï¼ˆæ— ç”¨ä½†æ˜¯ä¸ºäº†å¼ºè¡Œè®©pipesé•¿åº¦ç›¸åŒï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">pipe_basic = [pipe_basic_fillna,pipe_bypass,\</div><div class="line">              pipe_bypass,pipe_bypass,\</div><div class="line">              pipe_bypass,pipe_bypass,\</div><div class="line">              pipe_log_getdummies,pipe_bypass, \</div><div class="line">              pipe_export,pipe_r2test]</div><div class="line"></div><div class="line"></div><div class="line">pipe_ascat = [pipe_fillna_ascat,pipe_drop_cols,\</div><div class="line">              pipe_drop4cols,pipe_outliersdrop,\</div><div class="line">              pipe_extract,pipe_bypass,\</div><div class="line">              pipe_log_getdummies,pipe_drop_dummycols, \</div><div class="line">              pipe_export,pipe_r2test]</div><div class="line"></div><div class="line">pipe_ascat_unitprice = [pipe_fillna_ascat,pipe_drop_cols,\</div><div class="line">              pipe_drop4cols,pipe_outliersdrop,\</div><div class="line">              pipe_extract,pipe_unitprice,\</div><div class="line">              pipe_log_getdummies,pipe_drop_dummycols, \</div><div class="line">              pipe_export,pipe_r2test]</div><div class="line"></div><div class="line">pipes = [pipe_basic,pipe_ascat,pipe_ascat_unitprice ]</div></pre></td></tr></table></figure><p>è·‘çš„ä»£ç ä¸º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(pipes)):</div><div class="line">    print(<span class="string">"*"</span>*<span class="number">10</span>,<span class="string">"\n"</span>)</div><div class="line">    pipe_output=pipes[i]</div><div class="line">    output_name =<span class="string">"_"</span>.join([x.__name__[<span class="number">5</span>:] <span class="keyword">for</span> x <span class="keyword">in</span> pipe_output <span class="keyword">if</span> x.__name__ <span class="keyword">is</span> <span class="keyword">not</span> <span class="string">"pipe_bypass"</span>])</div><div class="line">    output_name = <span class="string">"PIPE_"</span> +output_name</div><div class="line">    print(output_name)</div><div class="line">    (combined.pipe(pipe_output[<span class="number">0</span>])</div><div class="line">             .pipe(pipe_output[<span class="number">1</span>])</div><div class="line">             .pipe(pipe_output[<span class="number">2</span>])</div><div class="line">             .pipe(pipe_output[<span class="number">3</span>])</div><div class="line">             .pipe(pipe_output[<span class="number">4</span>])</div><div class="line">             .pipe(pipe_output[<span class="number">5</span>])          </div><div class="line">             .pipe(pipe_output[<span class="number">6</span>])</div><div class="line">             .pipe(pipe_output[<span class="number">7</span>])</div><div class="line">             .pipe(pipe_output[<span class="number">8</span>],name=output_name)</div><div class="line">             .pipe(pipe_output[<span class="number">9</span>])</div><div class="line">             ï¼‰</div></pre></td></tr></table></figure><p>åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆæ­¥çœ‹åˆ°ä¸‰ä¸ªç‰¹å¾å·¥ç¨‹çš„æ€§èƒ½ã€‚å¹¶ä¸”æ–‡ä»¶å·²ç»è¾“å‡ºåˆ°hd5æ ¼å¼æ–‡ä»¶ã€‚åæœŸåœ¨è®­ç»ƒå’Œé¢„æµ‹æ—¶ï¼Œç›´æ¥å–å‡ºé¢„å¤„ç†çš„æ–‡ä»¶å°±å¯ä»¥ã€‚å„ä¸ªpipeä»£ç å¯è§<a href="https://gist.github.com/frankchen0130/5950eaa4d98ea4f93deed707b027b517" target="_blank" rel="external">æ­¤å¤„</a>ã€‚</p><h2 id="è°ƒå‚é˜¶æ®µ"><a href="#è°ƒå‚é˜¶æ®µ" class="headerlink" title="è°ƒå‚é˜¶æ®µ"></a>è°ƒå‚é˜¶æ®µ</h2><p>åœ¨æ•°æ®å‡†å¤‡å¥½åè®­ç»ƒæ—¶ï¼Œæœ€åŸºæœ¬çš„å°±æ˜¯è¦è°ƒæ•´è¶…å‚ï¼ˆHyperparameterï¼‰è€—æ—¶è€—åŠ›ï¼Œå¹¶ä¸”å’Œå‘ç”Ÿé”™è¯¯å’Œé—æ¼æƒ…å†µã€‚<br>Stackoverflowä¸Šå¸¸è§çš„ç®—æ³•è®­ç»ƒé”™è¯¯æœ‰ï¼š</p><ul><li>ç®—æ³•é¢„æµ‹çš„ç»“æœå·®å¼‚éå¸¸å¤§ã€‚ å…¶ä¸­ä¸€ä¸ªå¯èƒ½å°±æ˜¯è®­ç»ƒæ—¶çš„æ ‡å‡†åŒ–æ­¥éª¤ï¼Œåœ¨é¢„æµ‹æ—¶é—æ¼äº†ã€‚</li><li>ç®—æ³•çš„è°ƒå‚ç»“æœå·®å¼‚éå¸¸å¤§ã€‚ï¼ˆæœ‰çš„æ˜¯0.01,æœ‰çš„å°±æ˜¯10ï¼‰ã€‚å…¶ä¸­çš„ä¸€ä¸ªå¯èƒ½å°±æ˜¯ä¸åŒçš„è®­ç»ƒæ­¥éª¤ä¸­é‡‡ç”¨çš„æ ‡å‡†åŒ–ç®—æ³•ä¸åŒï¼ˆä¾‹å¦‚,ä¸€æ¬¡ç”¨äº†StandardScaler, å¦ä¸€æ¬¡ç”¨äº†RobustScaler)</li><li>æ­¤å¤–ï¼Œç¹å¤šçš„è¶…å‚æ•°è°ƒæ•´èµ·æ¥å¼‚å¸¸ç¹çã€‚æ¯”è¾ƒå®¹æ˜“é”™è¯¯æˆ–è€…å†™é”™ã€‚</li></ul><p><strong>è§£å†³æ–¹æ³•ï¼šPipeline + Gridsearch + å‚æ•°å­—å…¸ + å®¹å™¨ã€‚</strong><br>ä½¿ç”¨Pipelineçš„ä¾‹å­</p><p>é’ˆå¯¹çº¿å½¢å›å½’é—®é¢˜ï¼ŒSklearnæä¾›äº†è¶…è¿‡15ç§å›å½’ç®—æ³•ã€‚åˆ©ç”¨Pipeline å¤§æ³•å¯ä»¥ç»¼åˆæµ‹è¯•æ‰€æœ‰ç®—æ³•ï¼Œæ‰¾åˆ°æœ€åˆé€‚çš„ç®—æ³•ã€‚ å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>åˆå§‹åŒ–æ‰€æœ‰å¸Œæœ›è°ƒæµ‹çº¿å½¢å›å½’ã€‚</p></li><li><p>å»ºç«‹ä¸€ä¸ªå­—å…¸å®¹å™¨ã€‚{â€œç®—æ³•åç§°â€:[åˆå§‹ç®—æ³•å¯¹è±¡ï¼Œå‚æ•°å­—å…¸ï¼Œè®­ç»ƒå¥½çš„Pipelineæ¨¡å‹å¯¹è±¡ï¼ŒCVçš„æˆç»©}</p></li><li><p>åœ¨è°ƒå‚æ­¥éª¤ï¼Œå°†åˆå§‹ç®—æ³•ç”¨PipelineåŒ…è£…èµ·æ¥ï¼Œåˆ©ç”¨Gridsearchè¿›è¡Œè°ƒå‚ã€‚è°ƒå‚å®Œæˆåå¯ä»¥å¾—åˆ°é’ˆå¯¹ç›¸åº”çš„CVè€Œè·å¾—çš„æœ€åæ¨¡å‹å¯¹è±¡ã€‚ ä¾‹å¦‚ï¼š lasso ç®—æ³•çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p></li></ol><ul><li>åŒ…è£… pipe=Pipeline([(â€œscalerâ€:None),(â€œselectorâ€:None),(â€œclfâ€:Lasso())<ul><li>Pipeå°±æ˜¯åˆšåˆšåŒ…è£…å¥½çš„ç®—æ³•ã€‚å¯ä»¥ç›´æ¥ç”¨äº è®­ç»ƒ(fit)å’Œé¢„æµ‹(predict)</li><li>ä½¿ç”¨Pipeæ¥å¤„ç†è®­ç»ƒé›†å’Œæµ‹è¯•é›†å¯ä»¥é¿å…é”™è¯¯å’Œé—æ¼ï¼Œæé«˜æ•ˆç‡ã€‚</li><li>ä½†æ˜¯Pipeä¸­ç®—æ³•æ˜¯é»˜è®¤çš„å‚æ•°ï¼Œç›´æ¥è®­ç»ƒå‡ºçš„æ¨¡å‹RMSEä¸å¤ªç†æƒ³ã€‚ï¼ˆä¾‹å¦‚ï¼šlocal CV, 0.12~0.14å·¦å³ï¼‰ã€‚è¿™æ—¶å¯ä»¥è€ƒè™‘è°ƒå‚ã€‚</li></ul></li><li>è°ƒå‚ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å‚æ•°å­—å…¸ï¼š<br>  Params_lasso ={<br>  â€œScalerâ€:[RobustScaler(),StandardScaler()], #ä¸¤ä¸ªæ ‡å‡†åŒ–ç®—æ³•ä¾›è°ƒæ¨¡å‹<br>  â€œselector<strong>thresholdâ€:np.logspace(-5,-4,3), #3ä¸ªé€‰æ‹©é—¨é™ä¾›é€‰ç‰¹å¾<br>  â€œclf</strong>alphaâ€:np.logspace(-5,-1,10) }ï¼Œ #10ä¸ªalphaæŒ‡ä¾›è°ƒå‚</li><li>è°ƒå‚ç¬¬äºŒæ­¥ï¼šæš´åŠ›è°ƒå‚å’Œç”Ÿæˆæ¨¡å‹ rsearch = GridSearchCV(pipe, param_grid=Params_lasso,scoring =â€™neg_mean_squared_errorâ€™,verbose=verbose,cv=10,refit =True)<ul><li>GridSearch æ˜¯æš´åŠ›è°ƒå‚ã€‚éå†æ‰€æœ‰å‚æ•°ç»„åˆï¼Œå¦å¤–æœ‰ä¸€ä¸ªRandomedSearch å¯ä»¥éšæœºé€‰æ‹©å‚æ•°ç»„åˆï¼Œç¼©çŸ­è°ƒå‚æ—¶é—´ï¼Œå¹¶ä¸”è·å¾—è¿‘ä¼¼çš„è°ƒå‚æ€§èƒ½</li><li>Pipeå°±æ˜¯åˆšåˆšåŒ…è£…å¥½çš„ç®—æ³•ã€‚GridSearchæŠŠå¯é€‰çš„å‚æ•°å’Œç®—æ³•ï¼ˆæ”¾å…¥ï¼Œæˆ–è€…æ›´å¥½çš„ç»„åˆã€‚</li><li>è°ƒå‚çš„è®­ç»ƒæ ‡å‡†æ˜¯â€œâ€™neg_mean_squared_errorâ€, RMSEçš„è´Ÿæ•°ã€‚ è¿™ç§å¤„ç†æ–¹æ³•ï¼Œè®©æœ€å¤§å€¼ç§°ä¸ºæœ€å°çš„MSEæŒ‡ã€‚åªéœ€è¦å¯¹ç»“æœåšä¸€æ¬¡np.sqrt( ç»“æœè´Ÿæ•°ï¼‰å°±èƒ½è·å¾—RMSEå€¼ã€‚</li><li>cv=10. Cross Validate æ•°æ®é›†ä¸º9ï¼š1ã€‚æ•°æ®é›†å°çš„æƒ…å†µï¼Œä¾‹å¦‚House Price. 3æŠ˜å’Œ10æŠ˜ç»“æœç”šè‡³æ¯”è°ƒå‚å·®å¼‚è¿˜å¤§ã€‚</li><li>refit =True. åœ¨è°ƒå‚å®Œæˆåï¼Œå†éœ€è¦åšä¸€æ¬¡æ‰€æœ‰æ•°æ®é›†çš„fit. ç”Ÿæˆå®Œæ•´çš„è®­ç»ƒæ¨¡å‹</li></ul></li></ul><hr><p>Sklearn æµç¨‹å›¾<br><img src="/images/15161696298310.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15161698020879.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;æš‚å®šä¸ºè®°å½•å„å¼æ•°æ®ç§‘å­¦é¡¹ç›®ã€Kaggleç«èµ›é‡Œé¢å¸¸ç”¨ã€æœ‰ç”¨çš„ä»£ç ç‰‡æ®µã€APIã€ç¥æ“ä½œç­‰ï¼Œé€šå¸¸æ˜¯Numpyã€Pandasã€Matplotlibã€Seabornç­‰ç›¸å…³ï¼Œé€šå¸¸æ¥è¯´ï¼Œé¡¹ç›®åŸºæœ¬æ­¥éª¤å¯ä»¥åˆ†ä¸ºEDAã€ç‰¹å¾å·¥ç¨‹ä»¥åŠè°ƒå‚ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Data Science" scheme="http://frankchen.xyz/tags/Data-Science/"/>
    
      <category term="Python" scheme="http://frankchen.xyz/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>DIYè¿œç¨‹Jupyter NotebookæœåŠ¡å™¨</title>
    <link href="http://frankchen.xyz/2017/12/25/Remote-jupyter-notebook/"/>
    <id>http://frankchen.xyz/2017/12/25/Remote-jupyter-notebook/</id>
    <published>2017-12-25T11:43:17.000Z</published>
    <updated>2017-12-25T11:48:42.351Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15142020075328.jpg" alt="Screen Shot 2017-07-18 at 14.16.18"><br>æ„å»ºè‡ªå·±çš„è¿œç¨‹Jupyter NotebookæœåŠ¡å™¨ï¼Œæ·»åŠ systemå¼€æœºè‡ªå¯ï¼Œè®©Jupyter Notebookæ”¯æŒè·¨ç½‘ç»œè®¿é—®çš„æ–¹æ³•ã€‚<br><a id="more"></a></p><h2 id="å®Œå…¨å¼€æ”¾ï¼Œä¸éœ€å¯†ç "><a href="#å®Œå…¨å¼€æ”¾ï¼Œä¸éœ€å¯†ç " class="headerlink" title="å®Œå…¨å¼€æ”¾ï¼Œä¸éœ€å¯†ç "></a>å®Œå…¨å¼€æ”¾ï¼Œä¸éœ€å¯†ç </h2><h3 id="1-ç™»é™†è¿œç¨‹æœåŠ¡å™¨"><a href="#1-ç™»é™†è¿œç¨‹æœåŠ¡å™¨" class="headerlink" title="1.  ç™»é™†è¿œç¨‹æœåŠ¡å™¨"></a>1.  ç™»é™†è¿œç¨‹æœåŠ¡å™¨</h3><h3 id="2-ç”Ÿæˆé…ç½®æ–‡ä»¶"><a href="#2-ç”Ÿæˆé…ç½®æ–‡ä»¶" class="headerlink" title="2.ç”Ÿæˆé…ç½®æ–‡ä»¶"></a>2.ç”Ÿæˆé…ç½®æ–‡ä»¶</h3><p><code>$jupyter notebook --generate-config</code></p><h3 id="3-ä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶"><a href="#3-ä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶" class="headerlink" title="3. ä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶"></a>3. ä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶</h3><p><code>$vim ~/.jupyter/jupyter_notebook_config.py</code><br>è¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">c.NotebookApp.ip = <span class="string">'0.0.0.0'</span>      <span class="comment">#æ”¯æŒå…¶å®ƒIPè®¿é—®ï¼Œå…³é”®</span></div><div class="line">c.NotebookApp.port = <span class="number">10000</span> <span class="comment">#éšä¾¿æŒ‡å®šä¸€ä¸ªç«¯å£</span></div></pre></td></tr></table></figure><h3 id="4-å¯åŠ¨jupyter-notebookï¼š"><a href="#4-å¯åŠ¨jupyter-notebookï¼š" class="headerlink" title="4. å¯åŠ¨jupyter notebookï¼š"></a>4. å¯åŠ¨jupyter notebookï¼š</h3><p><code>jupyter notebook</code></p><h3 id="5-è¿œç¨‹è®¿é—®"><a href="#5-è¿œç¨‹è®¿é—®" class="headerlink" title="5. è¿œç¨‹è®¿é—®"></a>5. è¿œç¨‹è®¿é—®</h3><p>æ­¤æ—¶åº”è¯¥å¯ä»¥ç›´æ¥ä»æœ¬åœ°æµè§ˆå™¨ç›´æ¥è®¿é—®<code>http://address_of_remote:10000</code>å°±å¯ä»¥çœ‹åˆ°jupyterçš„ç™»é™†ç•Œé¢ï¼Œè¾“å…¥å¯†ç å³å¯ã€‚</p><h2 id="éœ€è¦å¯†ç "><a href="#éœ€è¦å¯†ç " class="headerlink" title="éœ€è¦å¯†ç "></a>éœ€è¦å¯†ç </h2><h3 id="1-ç”Ÿæˆå¯†ç "><a href="#1-ç”Ÿæˆå¯†ç " class="headerlink" title="1. ç”Ÿæˆå¯†ç "></a>1. ç”Ÿæˆå¯†ç </h3><p>æ‰“å¼€ipythonï¼Œåˆ›å»ºä¸€ä¸ªå¯†æ–‡çš„å¯†ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">1</span>]: <span class="keyword">from</span> notebook.auth <span class="keyword">import</span> passwd</div><div class="line">In [<span class="number">2</span>]: passwd()</div><div class="line">Enter password: </div><div class="line">Verify password: </div><div class="line">Out[<span class="number">2</span>]: <span class="string">'sha1:ce23d945972f:34769685a7ccd3d08c84a18c63968a41f1140274'</span></div></pre></td></tr></table></figure><h3 id="2-æ·»åŠ å¯†ç "><a href="#2-æ·»åŠ å¯†ç " class="headerlink" title="2. æ·»åŠ å¯†ç "></a>2. æ·»åŠ å¯†ç </h3><p><code>$vim ~/.jupyter/jupyter_notebook_config.py</code><br>è¿›è¡Œå¦‚ä¸‹ä¿®æ”¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">c.NotebookApp.password = <span class="string">u'sha:ce...åˆšæ‰å¤åˆ¶çš„é‚£ä¸ªå¯†æ–‡'</span></div></pre></td></tr></table></figure><p><img src="/images/Screen%20Shot%202017-07-18%20at%2014.16.18.png" alt="Screen Shot 2017-07-18 at 14.16.18"></p><h3 id="3-å»ºç«‹sshé€šé“"><a href="#3-å»ºç«‹sshé€šé“" class="headerlink" title="3. å»ºç«‹sshé€šé“"></a>3. å»ºç«‹sshé€šé“</h3><p>è‹¥è¿˜æ˜¯æ— æ³•ç™»å½•ï¼Œä¹Ÿå¯ç”¨</p><p><code>ssh username@address_of_remote -L 127.0.0.1:10000:127.0.0.1:10000</code></p><p>å»ºç«‹sshé€šé“ï¼Œä¾¿å¯ä»¥åœ¨localhost:10000ç›´æ¥è®¿é—®è¿œç¨‹çš„jupyteräº†ã€‚</p><h2 id="æ·»åŠ systemå¼€æœºè‡ªå¯"><a href="#æ·»åŠ systemå¼€æœºè‡ªå¯" class="headerlink" title="æ·»åŠ systemå¼€æœºè‡ªå¯"></a>æ·»åŠ systemå¼€æœºè‡ªå¯</h2><p>å°† Jupyter Notebook è®¾å®šä¸ºç³»ç»ŸæœåŠ¡å¹¶ä¸”å¼€æœºè‡ªåŠ¨å¯åŠ¨ï¼Œè¿™é‡Œä»¥ systemd ä¸‹çš„è®¾å®šä¸ºä¾‹ï¼Œåˆ›å»ºæ–‡ä»¶ <code>sudo vim /etc/systemd/system/jupyter.service</code>æ–‡ä»¶ï¼Œå†…å®¹æ˜¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[Unit]</div><div class="line">Description=Jupyter Notebook</div><div class="line">After=network.target</div><div class="line"></div><div class="line">[Service]</div><div class="line">Type=simple</div><div class="line">ExecStart=/home/frank/anaconda3/bin/jupyter-notebook  --config=/home/frank/.jupyter/jupyter_notebook_config.py --no-browser</div><div class="line">User=frank</div><div class="line">Group=frank</div><div class="line">WorkingDirectory=/home/frank/</div><div class="line">Restart=always</div><div class="line">RestartSec=10</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure><p>ä¸Šé¢ä½ éœ€è¦æŠŠæˆ‘çš„ç”¨æˆ·åfrankæ›¿æ¢æ‰ï¼Œä¿å­˜æ–‡ä»¶ä¹‹åæ‰§è¡Œ<br><code>systemctl enable jupyter</code><br>å†æ‰§è¡Œ<br><code>systemctl start jupyter</code><br>å³å¯ï¼Œéœ€è¦è¾“å…¥å‡ æ¬¡å¯†ç ï¼Œä¹‹åé‡å¯Notebookä¼šè‡ªå¯ã€‚</p><p><img src="/images/Screen%20Shot%202017-12-25%20at%2019.32.28.png" alt="Screen Shot 2017-12-25 at 19.32.28"></p><h2 id="å†…ç½‘ç©¿é€"><a href="#å†…ç½‘ç©¿é€" class="headerlink" title="å†…ç½‘ç©¿é€"></a>å†…ç½‘ç©¿é€</h2><p>ç»“åˆä¸‹æ–‡çš„æ–¹æ³•ï¼Œç”¨ftpå³å¯åšåˆ°</p><ul><li><a href="http://frankchen.xyz/2017/11/12/ftp-using/">frpçš„å†…ç½‘ç©¿é€åŠå¤–ç½‘è®¿é—®å†…ç½‘jupyter-notebookçš„å®ç° | ä¸æ­£ç»æ•°æ®ç§‘å­¦å®¶</a></li></ul><h2 id="å‚è€ƒè‡ª"><a href="#å‚è€ƒè‡ª" class="headerlink" title="å‚è€ƒè‡ª"></a>å‚è€ƒè‡ª</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/23110830" target="_blank" rel="external">Jupyter (IPython notebook)ç”¨äºæœåŠ¡å™¨çš„é…ç½®æ–¹æ³•(Windows) - çŸ¥ä¹ä¸“æ </a></li><li><a href="http://blog.leanote.com/post/jevonswang/%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AEjupyter-notebook" target="_blank" rel="external">è¿œç¨‹è®¿é—®jupyter notebook</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15142020075328.jpg&quot; alt=&quot;Screen Shot 2017-07-18 at 14.16.18&quot;&gt;&lt;br&gt;æ„å»ºè‡ªå·±çš„è¿œç¨‹Jupyter NotebookæœåŠ¡å™¨ï¼Œæ·»åŠ systemå¼€æœºè‡ªå¯ï¼Œè®©Jupyter Notebookæ”¯æŒè·¨ç½‘ç»œè®¿é—®çš„æ–¹æ³•ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="python" scheme="http://frankchen.xyz/tags/python/"/>
    
      <category term="Linux" scheme="http://frankchen.xyz/tags/Linux/"/>
    
      <category term="Jupyter Notebook" scheme="http://frankchen.xyz/tags/Jupyter-Notebook/"/>
    
  </entry>
  
  <entry>
    <title>æ·±åº¦å­¦ä¹ ä¸­Kerasä¸­çš„Embeddingå±‚çš„ç†è§£ä¸ä½¿ç”¨</title>
    <link href="http://frankchen.xyz/2017/12/18/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras/"/>
    <id>http://frankchen.xyz/2017/12/18/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras/</id>
    <published>2017-12-18T07:59:41.000Z</published>
    <updated>2018-03-08T08:44:07.373Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15135840798621.jpg" alt=""><br>å•è¯åµŒå…¥æä¾›äº†å•è¯çš„å¯†é›†è¡¨ç¤ºåŠå…¶ç›¸å¯¹å«ä¹‰ï¼Œå®ƒä»¬æ˜¯å¯¹ç®€å•åŒ…æ¨¡å‹è¡¨ç¤ºä¸­ä½¿ç”¨çš„ç¨€ç–è¡¨ç¤ºçš„æ”¹è¿›ï¼Œå¯ä»¥ä»æ–‡æœ¬æ•°æ®ä¸­å­¦ä¹ å­—åµŒå…¥ï¼Œå¹¶åœ¨é¡¹ç›®ä¹‹é—´é‡å¤ä½¿ç”¨ã€‚å®ƒä»¬ä¹Ÿå¯ä»¥ä½œä¸ºæ‹Ÿåˆæ–‡æœ¬æ•°æ®çš„ç¥ç»ç½‘ç»œçš„ä¸€éƒ¨åˆ†æ¥å­¦ä¹ ã€‚<br><a id="more"></a></p><h2 id="Word-Embedding"><a href="#Word-Embedding" class="headerlink" title="Word Embedding"></a>Word Embedding</h2><p>å•è¯åµŒå…¥æ˜¯ä½¿ç”¨å¯†é›†çš„çŸ¢é‡è¡¨ç¤ºæ¥è¡¨ç¤ºå•è¯å’Œæ–‡æ¡£çš„ä¸€ç±»æ–¹æ³•ã€‚</p><p>è¯åµŒå…¥æ˜¯å¯¹ä¼ ç»Ÿçš„è¯è¢‹æ¨¡å‹ç¼–ç æ–¹æ¡ˆçš„æ”¹è¿›ï¼Œä¼ ç»Ÿæ–¹æ³•ä½¿ç”¨å¤§è€Œç¨€ç–çš„çŸ¢é‡æ¥è¡¨ç¤ºæ¯ä¸ªå•è¯æˆ–è€…åœ¨çŸ¢é‡å†…å¯¹æ¯ä¸ªå•è¯è¿›è¡Œè¯„åˆ†ä»¥è¡¨ç¤ºæ•´ä¸ªè¯æ±‡è¡¨ï¼Œè¿™äº›è¡¨ç¤ºæ˜¯ç¨€ç–çš„ï¼Œå› ä¸ºæ¯ä¸ªè¯æ±‡çš„è¡¨ç¤ºæ˜¯å·¨å¤§çš„ï¼Œç»™å®šçš„è¯æˆ–æ–‡æ¡£ä¸»è¦ç”±é›¶å€¼ç»„æˆçš„å¤§å‘é‡è¡¨ç¤ºã€‚</p><p>ç›¸åï¼Œåœ¨åµŒå…¥ä¸­ï¼Œå•è¯ç”±å¯†é›†å‘é‡è¡¨ç¤ºï¼Œå…¶ä¸­å‘é‡è¡¨ç¤ºå°†å•è¯æŠ•å½±åˆ°è¿ç»­å‘é‡ç©ºé—´ä¸­ã€‚</p><p>å‘é‡ç©ºé—´ä¸­çš„å•è¯çš„ä½ç½®æ˜¯ä»æ–‡æœ¬ä¸­å­¦ä¹ çš„ï¼Œå¹¶ä¸”åŸºäºåœ¨ä½¿ç”¨å•è¯æ—¶å›´ç»•å•è¯çš„å•è¯ã€‚</p><p>å­¦ä¹ åˆ°çš„å‘é‡ç©ºé—´ä¸­çš„å•è¯çš„ä½ç½®è¢«ç§°ä¸ºå®ƒçš„åµŒå…¥ï¼šEmbeddingã€‚</p><p>ä»æ–‡æœ¬å­¦ä¹ å•è¯åµŒå…¥æ–¹æ³•çš„ä¸¤ä¸ªæµè¡Œä¾‹å­åŒ…æ‹¬ï¼š</p><ul><li>Word2Vec.</li><li>GloVe.</li></ul><p>é™¤äº†è¿™äº›ç²¾å¿ƒè®¾è®¡çš„æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å°†è¯åµŒå…¥å­¦ä¹ ä½œä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„ä¸€éƒ¨åˆ†ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªè¾ƒæ…¢çš„æ–¹æ³•ï¼Œä½†å¯ä»¥é€šè¿‡è¿™æ ·ä¸ºç‰¹å®šæ•°æ®é›†å®šåˆ¶æ¨¡å‹ã€‚</p><h2 id="Keras-Embedding-Layer"><a href="#Keras-Embedding-Layer" class="headerlink" title="Keras Embedding Layer"></a>Keras Embedding Layer</h2><p>Kerasæä¾›äº†ä¸€ä¸ªåµŒå…¥å±‚ï¼Œé€‚ç”¨äºæ–‡æœ¬æ•°æ®çš„ç¥ç»ç½‘ç»œã€‚</p><p>å®ƒè¦æ±‚è¾“å…¥æ•°æ®æ˜¯æ•´æ•°ç¼–ç çš„ï¼Œæ‰€ä»¥æ¯ä¸ªå­—éƒ½ç”¨ä¸€ä¸ªå”¯ä¸€çš„æ•´æ•°è¡¨ç¤ºã€‚è¿™ä¸ªæ•°æ®å‡†å¤‡æ­¥éª¤å¯ä»¥ä½¿ç”¨Kerasæä¾›çš„Tokenizer APIæ¥æ‰§è¡Œã€‚</p><p>åµŒå…¥å±‚ç”¨éšæœºæƒé‡è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶å°†å­¦ä¹ è®­ç»ƒæ•°æ®é›†ä¸­æ‰€æœ‰å•è¯çš„åµŒå…¥ã€‚</p><p>å®ƒæ˜¯ä¸€ä¸ªçµæ´»çš„å›¾å±‚ï¼Œå¯ä»¥ä»¥å¤šç§æ–¹å¼ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š</p><ul><li>å®ƒå¯ä»¥å•ç‹¬ä½¿ç”¨æ¥å­¦ä¹ ä¸€ä¸ªå•è¯åµŒå…¥ï¼Œä»¥åå¯ä»¥ä¿å­˜å¹¶åœ¨å¦ä¸€ä¸ªæ¨¡å‹ä¸­ä½¿ç”¨ã€‚</li><li>å®ƒå¯ä»¥ç”¨ä½œæ·±åº¦å­¦ä¹ æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸­åµŒå…¥ä¸æ¨¡å‹æœ¬èº«ä¸€èµ·å­¦ä¹ ã€‚</li><li>å®ƒå¯ä»¥ç”¨æ¥åŠ è½½é¢„å…ˆè®­ç»ƒçš„è¯åµŒå…¥æ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ç§è¿ç§»å­¦ä¹ ã€‚</li></ul><p>åµŒå…¥å±‚è¢«å®šä¹‰ä¸ºç½‘ç»œçš„ç¬¬ä¸€ä¸ªéšè—å±‚ã€‚å®ƒå¿…é¡»æŒ‡å®š3ä¸ªå‚æ•°ï¼š</p><ul><li>input_dimï¼šè¿™æ˜¯æ–‡æœ¬æ•°æ®ä¸­è¯æ±‡çš„å–å€¼å¯èƒ½æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„æ•°æ®æ˜¯æ•´æ•°ç¼–ç ä¸º0-9ä¹‹é—´çš„å€¼ï¼Œé‚£ä¹ˆè¯æ±‡çš„å¤§å°å°±æ˜¯10ä¸ªå•è¯ï¼›</li><li>output_dimï¼šè¿™æ˜¯åµŒå…¥å•è¯çš„å‘é‡ç©ºé—´çš„å¤§å°ã€‚å®ƒä¸ºæ¯ä¸ªå•è¯å®šä¹‰äº†è¿™ä¸ªå±‚çš„è¾“å‡ºå‘é‡çš„å¤§å°ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½æ˜¯32æˆ–100ç”šè‡³æ›´å¤§ï¼Œå¯ä»¥è§†ä¸ºå…·ä½“é—®é¢˜çš„è¶…å‚æ•°ï¼›</li><li>input_lengthï¼šè¿™æ˜¯è¾“å…¥åºåˆ—çš„é•¿åº¦ï¼Œå°±åƒæ‚¨ä¸ºKerasæ¨¡å‹çš„ä»»ä½•è¾“å…¥å±‚æ‰€å®šä¹‰çš„ä¸€æ ·ï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡è¾“å…¥å¸¦æœ‰çš„è¯æ±‡ä¸ªæ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„æ‰€æœ‰è¾“å…¥æ–‡æ¡£éƒ½ç”±1000ä¸ªå­—ç»„æˆï¼Œé‚£ä¹ˆinput_lengthå°±æ˜¯1000ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œä¸‹é¢æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè¯æ±‡è¡¨ä¸º200çš„åµŒå…¥å±‚ï¼ˆä¾‹å¦‚ä»0åˆ°199çš„æ•´æ•°ç¼–ç çš„å­—ï¼ŒåŒ…æ‹¬0åˆ°199ï¼‰ï¼Œä¸€ä¸ª32ç»´çš„å‘é‡ç©ºé—´ï¼Œå…¶ä¸­å°†åµŒå…¥å•è¯ï¼Œä»¥åŠè¾“å…¥æ–‡æ¡£ï¼Œæ¯ä¸ªå•è¯æœ‰50ä¸ªå•è¯ã€‚</p><p><code>e = Embedding(input_dim=200, output_dim=32, input_length=50)</code></p><p>åµŒå…¥å±‚è‡ªå¸¦å­¦ä¹ çš„æƒé‡ï¼Œå¦‚æœå°†æ¨¡å‹ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œåˆ™å°†åŒ…å«åµŒå…¥å›¾å±‚çš„æƒé‡ã€‚</p><p>åµŒå…¥å±‚çš„è¾“å‡ºæ˜¯ä¸€ä¸ªäºŒç»´å‘é‡ï¼Œæ¯ä¸ªå•è¯åœ¨è¾“å…¥æ–‡æœ¬ï¼ˆè¾“å…¥æ–‡æ¡£ï¼‰åºåˆ—ä¸­åµŒå…¥ä¸€ä¸ªã€‚</p><p>å¦‚æœæ‚¨å¸Œæœ›ç›´æ¥å°†Denseå±‚æ¥åˆ°Embeddingå±‚åé¢ï¼Œåˆ™å¿…é¡»å…ˆä½¿ç”¨Flattenå±‚å°†Embeddingå±‚çš„2Dè¾“å‡ºçŸ©é˜µå¹³é“ºä¸ºä¸€ç»´çŸ¢é‡ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å¦‚ä½•åœ¨å®è·µä¸­ä½¿ç”¨åµŒå…¥å±‚ã€‚</p><h2 id="å­¦ä¹ -Embeddingçš„ä¾‹å­"><a href="#å­¦ä¹ -Embeddingçš„ä¾‹å­" class="headerlink" title="å­¦ä¹  Embeddingçš„ä¾‹å­"></a>å­¦ä¹  Embeddingçš„ä¾‹å­</h2><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹çœ‹å¦‚ä½•åœ¨æ–‡æœ¬åˆ†ç±»é—®é¢˜ä¸Šæ‹Ÿåˆç¥ç»ç½‘ç»œçš„åŒæ—¶å­¦ä¹ å•è¯åµŒå…¥ã€‚</p><p>æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªå°é—®é¢˜ï¼Œæˆ‘ä»¬æœ‰10ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œæ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸€ä¸ªå­¦ç”Ÿæäº¤çš„å·¥ä½œè¯„è®ºã€‚æ¯ä¸ªæ–‡æœ¬æ–‡æ¡£è¢«åˆ†ç±»ä¸ºæ­£çš„â€œ1â€æˆ–è´Ÿçš„â€œ0â€ã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æƒ…æ„Ÿåˆ†æé—®é¢˜ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†å®šä¹‰æ–‡æ¡£åŠå…¶ç±»åˆ«æ ‡ç­¾ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># define documents å®šä¹‰æ–‡æ¡£</span></div><div class="line">docs = [<span class="string">'Well done!'</span>,</div><div class="line"><span class="string">'Good work'</span>,</div><div class="line"><span class="string">'Great effort'</span>,</div><div class="line"><span class="string">'nice work'</span>,</div><div class="line"><span class="string">'Excellent!'</span>,</div><div class="line"><span class="string">'Weak'</span>,</div><div class="line"><span class="string">'Poor effort!'</span>,</div><div class="line"><span class="string">'not good'</span>,</div><div class="line"><span class="string">'poor work'</span>,</div><div class="line"><span class="string">'Could have done better.'</span>]</div><div class="line"><span class="comment"># define class labels å®šä¹‰åˆ†ç±»æ ‡ç­¾</span></div><div class="line">labels = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</div></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥æ•´æ•°ç¼–ç æ¯ä¸ªæ–‡ä»¶ã€‚è¿™æ„å‘³ç€æŠŠè¾“å…¥ï¼ŒåµŒå…¥å±‚å°†å…·æœ‰æ•´æ•°åºåˆ—ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•å…¶ä»–æ›´å¤æ‚çš„bag of word æ¨¡å‹æ¯”å¦‚è®¡æ•°æˆ–TF-IDFã€‚</p><p>Kerasæä¾›<a href="https://keras.io/preprocessing/text/#one_hot" target="_blank" rel="external">one_hot()</a>å‡½æ•°æ¥åˆ›å»ºæ¯ä¸ªå•è¯çš„æ•£åˆ—ä½œä¸ºä¸€ä¸ªæœ‰æ•ˆçš„æ•´æ•°ç¼–ç ã€‚æˆ‘ä»¬ç”¨ä¼°è®¡50çš„è¯æ±‡è¡¨å¤§å°ï¼Œè¿™å¤§å¤§å‡å°‘äº†hashå‡½æ•°çš„å†²çªæ¦‚ç‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># integer encode the documents ç‹¬çƒ­ç¼–ç </span></div><div class="line">vocab_size = <span class="number">50</span></div><div class="line">encoded_docs = [one_hot(d, vocab_size) <span class="keyword">for</span> d <span class="keyword">in</span> docs]</div><div class="line">print(encoded_docs)</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[[6, 16], [42, 24], [2, 17], [42, 24], [18], [17], [22, 17], [27, 42], [22, 24], [49, 46, 16, 34]]</div></pre></td></tr></table></figure><p>è¿™æ ·ä»¥ååºåˆ—å…·æœ‰ä¸åŒçš„é•¿åº¦ï¼Œä½†æ˜¯Kerasæ›´å–œæ¬¢è¾“å…¥çŸ¢é‡åŒ–å’Œæ‰€æœ‰è¾“å…¥å…·æœ‰ç›¸åŒçš„é•¿åº¦ã€‚æˆ‘ä»¬å°†å¡«å……æ‰€æœ‰è¾“å…¥åºåˆ—çš„é•¿åº¦ä¸º4ï¼ŒåŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…ç½®çš„Keraså‡½æ•°ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸º<a href="https://keras.io/preprocessing/sequence/#pad_sequences" target="_blank" rel="external">pad_sequences()</a>å‡½æ•°ï¼‰æ‰§è¡Œæ­¤æ“ä½œ,</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># pad documents to a max length of 4 words å°†ä¸è¶³é•¿åº¦çš„ç”¨0å¡«å……ä¸ºé•¿åº¦4</span></div><div class="line">max_length = <span class="number">4</span></div><div class="line">padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding=<span class="string">'post'</span>)</div><div class="line">print(padded_docs)</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[[ 6 16  0  0]</div><div class="line"> [42 24  0  0]</div><div class="line"> [ 2 17  0  0]</div><div class="line"> [42 24  0  0]</div><div class="line"> [18  0  0  0]</div><div class="line"> [17  0  0  0]</div><div class="line"> [22 17  0  0]</div><div class="line"> [27 42  0  0]</div><div class="line"> [22 24  0  0]</div><div class="line"> [49 46 16 34]]</div></pre></td></tr></table></figure><p>æˆ‘ä»¬ç°åœ¨å‡†å¤‡å°†æˆ‘ä»¬çš„åµŒå…¥å±‚å®šä¹‰ä¸ºæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œæ¨¡å‹çš„ä¸€éƒ¨åˆ†ã€‚</p><p>åµŒå…¥çš„è¯æ±‡é‡ä¸º50ï¼Œè¾“å…¥é•¿åº¦ä¸º4ï¼Œæˆ‘ä»¬å°†é€‰æ‹©ä¸€ä¸ª8ç»´çš„åµŒå…¥ç©ºé—´ã€‚</p><p>è¯¥æ¨¡å‹æ˜¯ä¸€ä¸ªç®€å•çš„äºŒå…ƒåˆ†ç±»æ¨¡å‹ã€‚é‡è¦çš„æ˜¯ï¼ŒåµŒå…¥å±‚çš„è¾“å‡ºå°†æ˜¯æ¯ä¸ª8ç»´çš„4ä¸ªçŸ¢é‡ï¼Œæ¯ä¸ªå•è¯ä¸€ä¸ªã€‚æˆ‘ä»¬å°†å…¶å¹³é“ºåˆ°ä¸€ä¸ª32ä¸ªå…ƒç´ çš„å‘é‡ä¸Šä»¥ä¼ é€’åˆ°å¯†é›†è¾“å‡ºå±‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># define the model å®šä¹‰æ¨¡å‹</span></div><div class="line">model = Sequential()</div><div class="line">model.add(Embedding(vocab_size, <span class="number">8</span>, input_length=max_length))</div><div class="line">model.add(Flatten())</div><div class="line">model.add(Dense(<span class="number">1</span>, activation=<span class="string">'sigmoid'</span>))</div><div class="line"><span class="comment"># compile the model ç¼–è¯‘</span></div><div class="line">model.compile(optimizer=<span class="string">'adam'</span>, loss=<span class="string">'binary_crossentropy'</span>, metrics=[<span class="string">'acc'</span>])</div><div class="line"><span class="comment"># summarize the model æ‰“å°æ¨¡å‹ä¿¡æ¯</span></div><div class="line">print(model.summary())</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">_________________________________________________________________</div><div class="line">Layer (type)                 Output Shape              Param #</div><div class="line">=================================================================</div><div class="line">embedding_1 (Embedding)      (None, 4, 8)              400</div><div class="line">_________________________________________________________________</div><div class="line">flatten_1 (Flatten)          (None, 32)                0</div><div class="line">_________________________________________________________________</div><div class="line">dense_1 (Dense)              (None, 1)                 33</div><div class="line">=================================================================</div><div class="line">Total params: 433</div><div class="line">Trainable params: 433</div><div class="line">Non-trainable params: 0</div><div class="line">_________________________________________________________________</div></pre></td></tr></table></figure><p>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ‹Ÿåˆå’Œè¯„ä¼°åˆ†ç±»æ¨¡å‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># fit the model æ‹Ÿåˆ</span></div><div class="line">model.fit(padded_docs, labels, epochs=<span class="number">50</span>, verbose=<span class="number">0</span>)</div><div class="line"><span class="comment"># evaluate the model è¯„ä¼°</span></div><div class="line">loss, accuracy = model.evaluate(padded_docs, labels, verbose=<span class="number">0</span>)</div><div class="line">print(<span class="string">'Accuracy: %f'</span> % (accuracy*<span class="number">100</span>))</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Accuracy: 100.000000</div></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨å‡½æ•°å¼APIæ”¹å†™äº†æ¨¡å‹å®šä¹‰ï¼Œä¸è¿‡ç»“æ„å’Œä¸Šé¢æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense, Flatten, Input</div><div class="line"><span class="keyword">from</span> keras.layers.embeddings <span class="keyword">import</span> Embedding</div><div class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Model</div><div class="line"><span class="keyword">from</span> keras.preprocessing.sequence <span class="keyword">import</span> pad_sequences</div><div class="line"><span class="keyword">from</span> keras.preprocessing.text <span class="keyword">import</span> one_hot</div><div class="line"></div><div class="line"><span class="comment"># define documents</span></div><div class="line">docs = [<span class="string">'Well done!'</span>,</div><div class="line">        <span class="string">'Good work'</span>,</div><div class="line">        <span class="string">'Great effort'</span>,</div><div class="line">        <span class="string">'nice work'</span>,</div><div class="line">        <span class="string">'Excellent!'</span>,</div><div class="line">        <span class="string">'Weak'</span>,</div><div class="line">        <span class="string">'Poor effort!'</span>,</div><div class="line">        <span class="string">'not good'</span>,</div><div class="line">        <span class="string">'poor work'</span>,</div><div class="line">        <span class="string">'Could have done better.'</span>]</div><div class="line"><span class="comment"># define class labels</span></div><div class="line">labels = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</div><div class="line"><span class="comment"># integer encode the documents</span></div><div class="line">vocab_size = <span class="number">50</span></div><div class="line">encoded_docs = [one_hot(d, vocab_size) <span class="keyword">for</span> d <span class="keyword">in</span> docs]</div><div class="line">print(encoded_docs)</div><div class="line"><span class="comment"># pad documents to a max length of 4 words</span></div><div class="line">max_length = <span class="number">4</span></div><div class="line">padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding=<span class="string">'post'</span>)</div><div class="line">print(padded_docs)</div><div class="line"><span class="comment"># define the model</span></div><div class="line">input = Input(shape=(<span class="number">4</span>, ))</div><div class="line">x = Embedding(vocab_size, <span class="number">8</span>, input_length=max_length)(input)</div><div class="line">x = Flatten()(x)</div><div class="line">x = Dense(<span class="number">1</span>, activation=<span class="string">'sigmoid'</span>)(x)</div><div class="line">model = Model(inputs=input, outputs=x)</div><div class="line"><span class="comment"># compile the model</span></div><div class="line">model.compile(optimizer=<span class="string">'adam'</span>, loss=<span class="string">'binary_crossentropy'</span>, metrics=[<span class="string">'acc'</span>])</div><div class="line"><span class="comment"># summarize the model</span></div><div class="line">print(model.summary())</div><div class="line"><span class="comment"># fit the model</span></div><div class="line">model.fit(padded_docs, labels, epochs=<span class="number">50</span>, verbose=<span class="number">0</span>)</div><div class="line"><span class="comment"># evaluate the model</span></div><div class="line">loss, accuracy = model.evaluate(padded_docs, labels, verbose=<span class="number">0</span>)</div><div class="line">print(<span class="string">'Accuracy: %f'</span> % (accuracy * <span class="number">100</span>))</div></pre></td></tr></table></figure><p>ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å°†åµŒå…¥å›¾å±‚ä¸­å­¦ä¹ çš„æƒé‡ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿ä»¥ååœ¨å…¶ä»–æ¨¡å‹ä¸­ä½¿ç”¨ã€‚</p><p>é€šå¸¸ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¨¡å‹æ¥åˆ†ç±»åœ¨æµ‹è¯•æ•°æ®é›†ä¸­çœ‹åˆ°çš„åŒç±»è¯æ±‡çš„å…¶ä»–æ–‡æ¡£ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹åœ¨Kerasä¸­åŠ è½½é¢„å…ˆè®­ç»ƒçš„è¯åµŒå…¥ã€‚</p><h2 id="ä½¿ç”¨é¢„è®­ç»ƒGloVEåµŒå…¥çš„ç¤ºä¾‹"><a href="#ä½¿ç”¨é¢„è®­ç»ƒGloVEåµŒå…¥çš„ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨é¢„è®­ç»ƒGloVEåµŒå…¥çš„ç¤ºä¾‹"></a>ä½¿ç”¨é¢„è®­ç»ƒGloVEåµŒå…¥çš„ç¤ºä¾‹</h2><p>KerasåµŒå…¥å±‚ä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨å…¶ä»–åœ°æ–¹å­¦ä¹ çš„åµŒå…¥å­—ã€‚</p><p>åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸï¼Œå­¦ä¹ ï¼Œä¿å­˜å’Œåˆ†äº«æä¾›è¯åµŒå…¥æ˜¯å¾ˆå¸¸è§çš„ã€‚</p><p>ä¾‹å¦‚ï¼ŒGloVeæ–¹æ³•èƒŒåçš„ç ”ç©¶äººå‘˜æä¾›äº†ä¸€å¥—åœ¨å…¬å…±é¢†åŸŸè®¸å¯ä¸‹å‘å¸ƒçš„é¢„å…ˆè®­ç»ƒçš„è¯åµŒå…¥ã€‚çœ‹åˆ°ï¼š</p><ul><li><a href="https://nlp.stanford.edu/projects/glove/" target="_blank" rel="external">GloVe: Global Vectors for Word Representation</a></li></ul><p>æœ€å°çš„åŒ…æ˜¯822Mbï¼Œå«åšâ€œglove.6B.zipâ€ã€‚å®ƒè®­ç»ƒäº†10äº¿ä¸ªè¯æ±‡ï¼ˆå•è¯ï¼‰çš„æ•°æ®é›†ï¼Œè¯æ±‡é‡ä¸º40ä¸‡å­—ï¼Œæœ‰å‡ ç§ä¸åŒçš„åµŒå…¥çŸ¢é‡å°ºå¯¸ï¼ŒåŒ…æ‹¬50,100,200å’Œ300sizeã€‚</p><p>æ‚¨å¯ä»¥ä¸‹è½½è¿™ä¸ªåµŒå…¥çš„é›†åˆï¼Œå¯ä»¥ä½œä¸ºKerasåµŒå…¥å±‚ä¸­è®­ç»ƒæ•°æ®é›†ä¸­çš„å•è¯é¢„å…ˆè®­ç»ƒåµŒå…¥çš„æƒé‡ã€‚</p><p>è¿™ä¸ªä¾‹å­å—Kerasé¡¹ç›®ä¸­çš„ä¸€ä¸ªä¾‹å­çš„å¯å‘ï¼š<a href="https://github.com/keras-team/keras/blob/master/examples/pretrained_word_embeddings.py" target="_blank" rel="external">pretrained_word_embeddings.py</a>ã€‚</p><p>ä¸‹è½½å¹¶è§£å‹ç¼©åï¼Œæ‚¨å°†çœ‹åˆ°å‡ ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯â€œglove.6B.100d.txtâ€ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª100ç»´ç‰ˆæœ¬çš„åµŒå…¥ã€‚</p><p>å¦‚æœä½ åœ¨æ–‡ä»¶å†…éƒ¨å·çœ‹ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªtokenï¼ˆå•è¯ï¼‰ï¼Œåé¢æ˜¯æ¯è¡Œçš„æƒé‡ï¼ˆ100ä¸ªæ•°å­—ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯åµŒå…¥çš„ASCIIæ–‡æœ¬æ–‡ä»¶çš„ç¬¬ä¸€è¡Œï¼Œæ˜¾ç¤ºâ€œtheâ€çš„åµŒå…¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">the -0.038194 -0.24487 0.72812 -0.39961 0.083172 0.043953 -0.39141 0.3344 -0.57545 0.087459 0.28787 -0.06731 0.30906 -0.26384 -0.13231 -0.20757 0.33395 -0.33848 -0.31743 -0.48336 0.1464 -0.37304 0.34577 0.052041 0.44946 -0.46971 0.02628 -0.54155 -0.15518 -0.14107 -0.039722 0.28277 0.14393 0.23464 -0.31021 0.086173 0.20397 0.52624 0.17164 -0.082378 -0.71787 -0.41531 0.20335 -0.12763 0.41367 0.55187 0.57908 -0.33477 -0.36559 -0.54857 -0.062892 0.26584 0.30205 0.99775 -0.80481 -3.0243 0.01254 -0.36942 2.2167 0.72201 -0.24978 0.92136 0.034514 0.46745 1.1079 -0.19358 -0.074575 0.23353 -0.052062 -0.22044 0.057162 -0.15806 -0.30798 -0.41625 0.37972 0.15006 -0.53212 -0.2055 -1.2526 0.071624 0.70565 0.49744 -0.42063 0.26148 -1.538 -0.30223 -0.073438 -0.28312 0.37104 -0.25217 0.016215 -0.017099 -0.38984 0.87424 -0.72569 -0.51058 -0.52028 -0.1459 0.8278 0.27062</div></pre></td></tr></table></figure><p>å¦‚å‰ä¸€èŠ‚æ‰€è¿°ï¼Œç¬¬ä¸€æ­¥æ˜¯å®šä¹‰è¿™äº›ç¤ºä¾‹ï¼Œå°†å®ƒä»¬ç¼–ç ä¸ºæ•´æ•°ï¼Œç„¶åå°†è¿™äº›åºåˆ—å¡«å……ä¸ºç›¸åŒçš„é•¿åº¦ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦èƒ½å¤Ÿå°†å•è¯æ˜ å°„åˆ°æ•´æ•°ä»¥åŠæ•´æ•°åˆ°å•è¯ã€‚</p><p>Kerasæä¾›äº†ä¸€ä¸ª<a href="https://keras.io/preprocessing/text/#tokenizer" target="_blank" rel="external">Tokenizer</a>ç±»ï¼Œå¯ä»¥é€‚åº”è®­ç»ƒæ•°æ®ï¼Œé€šè¿‡è°ƒç”¨Tokenizerç±»çš„texts_to_sequencesï¼ˆï¼‰æ–¹æ³•ï¼Œå¯ä»¥ä¸€è‡´åœ°å°†æ–‡æœ¬è½¬æ¢ä¸ºåºåˆ—ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®å•è¯åœ¨word_indexå±æ€§ä¸­çš„æ•´æ•°å­—å…¸æ˜ å°„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># define documents</span></div><div class="line">docs = [<span class="string">'Well done!'</span>,</div><div class="line"><span class="string">'Good work'</span>,</div><div class="line"><span class="string">'Great effort'</span>,</div><div class="line"><span class="string">'nice work'</span>,</div><div class="line"><span class="string">'Excellent!'</span>,</div><div class="line"><span class="string">'Weak'</span>,</div><div class="line"><span class="string">'Poor effort!'</span>,</div><div class="line"><span class="string">'not good'</span>,</div><div class="line"><span class="string">'poor work'</span>,</div><div class="line"><span class="string">'Could have done better.'</span>]</div><div class="line"><span class="comment"># define class labels</span></div><div class="line">labels = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</div><div class="line"><span class="comment"># prepare tokenizer</span></div><div class="line">t = Tokenizer()</div><div class="line">t.fit_on_texts(docs)</div><div class="line">vocab_size = len(t.word_index) + <span class="number">1</span></div><div class="line"><span class="comment"># integer encode the documents</span></div><div class="line">encoded_docs = t.texts_to_sequences(docs)</div><div class="line">print(encoded_docs)</div><div class="line"><span class="comment"># pad documents to a max length of 4 words</span></div><div class="line">max_length = <span class="number">4</span></div><div class="line">padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding=<span class="string">'post'</span>)</div><div class="line">print(padded_docs)</div></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•´ä¸ªGloveå­—åµŒå…¥æ–‡ä»¶ä½œä¸ºå­—çš„å­—å…¸åŠ è½½åˆ°å†…å­˜ä¸­ä»¥åµŒå…¥æ•°ç»„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># load the whole embedding into memory</span></div><div class="line">embeddings_index = dict()</div><div class="line">f = open(<span class="string">'glove.6B.100d.txt'</span>)</div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f:</div><div class="line">values = line.split()</div><div class="line">word = values[<span class="number">0</span>]</div><div class="line">coefs = asarray(values[<span class="number">1</span>:], dtype=<span class="string">'float32'</span>)</div><div class="line">embeddings_index[word] = coefs</div><div class="line">f.close()</div><div class="line">print(<span class="string">'Loaded %s word vectors.'</span> % len(embeddings_index))</div></pre></td></tr></table></figure><p>è¿™å¾ˆæ…¢ã€‚åœ¨è®­ç»ƒæ•°æ®ä¸­è¿‡æ»¤ç‰¹æ®Šå­—è¯çš„åµŒå…¥å¯èƒ½ä¼šæ›´å¥½ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºè®­ç»ƒæ•°æ®é›†ä¸­çš„æ¯ä¸ªå•è¯åˆ›å»ºä¸€ä¸ªåµŒå…¥çŸ©é˜µã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æšä¸¾Tokenizer.word_indexä¸­çš„æ‰€æœ‰å”¯ä¸€å•è¯å¹¶ä»åŠ è½½çš„GloVeåµŒå…¥ä¸­æ‰¾åˆ°åµŒå…¥æƒé‡å‘é‡æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><p>ç»“æœæ˜¯ä¸€ä¸ªä»…ç”¨äºè®­ç»ƒæœŸé—´å°†ä¼šçœ‹åˆ°çš„å•è¯çš„æƒé‡çŸ©é˜µã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># create a weight matrix for words in training docs</span></div><div class="line">embedding_matrix = zeros((vocab_size, <span class="number">100</span>))</div><div class="line"><span class="keyword">for</span> word, i <span class="keyword">in</span> t.word_index.items():</div><div class="line">embedding_vector = embeddings_index.get(word)</div><div class="line"><span class="keyword">if</span> embedding_vector <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">embedding_matrix[i] = embedding_vector</div></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥åƒä»¥å‰ä¸€æ ·å®šä¹‰æˆ‘ä»¬çš„æ¨¡å‹ï¼Œå¹¶è¿›è¡Œè¯„ä¼°ã€‚</p><p>å…³é”®çš„åŒºåˆ«æ˜¯åµŒå…¥å±‚å¯ä»¥ç”¨GloVeå­—åµŒå…¥æƒé‡æ¥æ’­ç§ã€‚æˆ‘ä»¬é€‰æ‹©äº†100ç»´ç‰ˆæœ¬ï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨output_dimå°†å…¶è®¾ç½®ä¸º100æ¥å®šä¹‰åµŒå…¥å±‚ã€‚æœ€åï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æ›´æ–°æ­¤æ¨¡å‹ä¸­çš„å­¦ä¹ å•è¯æƒé‡ï¼Œå› æ­¤æˆ‘ä»¬å°†è®¾ç½®æ¨¡å‹çš„å¯è®­ç»ƒå±æ€§ä¸ºFalse ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e = Embedding(vocab_size, 100, weights=[embedding_matrix], input_length=4, trainable=False)</div></pre></td></tr></table></figure><p>ä¸‹é¢åˆ—å‡ºäº†å®Œæ•´çš„å·¥ä½œç¤ºä¾‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> asarray</div><div class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> zeros</div><div class="line"><span class="keyword">from</span> keras.preprocessing.text <span class="keyword">import</span> Tokenizer</div><div class="line"><span class="keyword">from</span> keras.preprocessing.sequence <span class="keyword">import</span> pad_sequences</div><div class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</div><div class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense</div><div class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Flatten</div><div class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Embedding</div><div class="line"><span class="comment"># define documents</span></div><div class="line">docs = [<span class="string">'Well done!'</span>,</div><div class="line"><span class="string">'Good work'</span>,</div><div class="line"><span class="string">'Great effort'</span>,</div><div class="line"><span class="string">'nice work'</span>,</div><div class="line"><span class="string">'Excellent!'</span>,</div><div class="line"><span class="string">'Weak'</span>,</div><div class="line"><span class="string">'Poor effort!'</span>,</div><div class="line"><span class="string">'not good'</span>,</div><div class="line"><span class="string">'poor work'</span>,</div><div class="line"><span class="string">'Could have done better.'</span>]</div><div class="line"><span class="comment"># define class labels</span></div><div class="line">labels = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</div><div class="line"><span class="comment"># prepare tokenizer</span></div><div class="line">t = Tokenizer()</div><div class="line">t.fit_on_texts(docs)</div><div class="line">vocab_size = len(t.word_index) + <span class="number">1</span></div><div class="line"><span class="comment"># integer encode the documents</span></div><div class="line">encoded_docs = t.texts_to_sequences(docs)</div><div class="line">print(encoded_docs)</div><div class="line"><span class="comment"># pad documents to a max length of 4 words</span></div><div class="line">max_length = <span class="number">4</span></div><div class="line">padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding=<span class="string">'post'</span>)</div><div class="line">print(padded_docs)</div><div class="line"><span class="comment"># load the whole embedding into memory</span></div><div class="line">embeddings_index = dict()</div><div class="line">f = open(<span class="string">'../glove_data/glove.6B/glove.6B.100d.txt'</span>)</div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f:</div><div class="line">values = line.split()</div><div class="line">word = values[<span class="number">0</span>]</div><div class="line">coefs = asarray(values[<span class="number">1</span>:], dtype=<span class="string">'float32'</span>)</div><div class="line">embeddings_index[word] = coefs</div><div class="line">f.close()</div><div class="line">print(<span class="string">'Loaded %s word vectors.'</span> % len(embeddings_index))</div><div class="line"><span class="comment"># create a weight matrix for words in training docs</span></div><div class="line">embedding_matrix = zeros((vocab_size, <span class="number">100</span>))</div><div class="line"><span class="keyword">for</span> word, i <span class="keyword">in</span> t.word_index.items():</div><div class="line">embedding_vector = embeddings_index.get(word)</div><div class="line"><span class="keyword">if</span> embedding_vector <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">embedding_matrix[i] = embedding_vector</div><div class="line"><span class="comment"># define model</span></div><div class="line">model = Sequential()</div><div class="line">e = Embedding(vocab_size, <span class="number">100</span>, weights=[embedding_matrix], input_length=<span class="number">4</span>, trainable=<span class="keyword">False</span>)</div><div class="line">model.add(e)</div><div class="line">model.add(Flatten())</div><div class="line">model.add(Dense(<span class="number">1</span>, activation=<span class="string">'sigmoid'</span>))</div><div class="line"><span class="comment"># compile the model</span></div><div class="line">model.compile(optimizer=<span class="string">'adam'</span>, loss=<span class="string">'binary_crossentropy'</span>, metrics=[<span class="string">'acc'</span>])</div><div class="line"><span class="comment"># summarize the model</span></div><div class="line">print(model.summary())</div><div class="line"><span class="comment"># fit the model</span></div><div class="line">model.fit(padded_docs, labels, epochs=<span class="number">50</span>, verbose=<span class="number">0</span>)</div><div class="line"><span class="comment"># evaluate the model</span></div><div class="line">loss, accuracy = model.evaluate(padded_docs, labels, verbose=<span class="number">0</span>)</div><div class="line">print(<span class="string">'Accuracy: %f'</span> % (accuracy*<span class="number">100</span>))</div></pre></td></tr></table></figure><p>è¿è¡Œè¿™ä¸ªä¾‹å­å¯èƒ½éœ€è¦æ›´é•¿çš„æ—¶é—´ï¼Œä½†æ˜¯è¿™è¡¨æ˜å®ƒèƒ½å¤Ÿé€‚åº”è¿™ä¸ªç®€å•çš„é—®é¢˜ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">[[6, 2], [3, 1], [7, 4], [8, 1], [9], [10], [5, 4], [11, 3], [5, 1], [12, 13, 2, 14]]</div><div class="line"></div><div class="line">[[ 6  2  0  0]</div><div class="line"> [ 3  1  0  0]</div><div class="line"> [ 7  4  0  0]</div><div class="line"> [ 8  1  0  0]</div><div class="line"> [ 9  0  0  0]</div><div class="line"> [10  0  0  0]</div><div class="line"> [ 5  4  0  0]</div><div class="line"> [11  3  0  0]</div><div class="line"> [ 5  1  0  0]</div><div class="line"> [12 13  2 14]]</div><div class="line"></div><div class="line">Loaded 400000 word vectors.</div><div class="line"></div><div class="line">_________________________________________________________________</div><div class="line">Layer (type)                 Output Shape              Param #</div><div class="line">=================================================================</div><div class="line">embedding_1 (Embedding)      (None, 4, 100)            1500</div><div class="line">_________________________________________________________________</div><div class="line">flatten_1 (Flatten)          (None, 400)               0</div><div class="line">_________________________________________________________________</div><div class="line">dense_1 (Dense)              (None, 1)                 401</div><div class="line">=================================================================</div><div class="line">Total params: 1,901</div><div class="line">Trainable params: 401</div><div class="line">Non-trainable params: 1,500</div><div class="line">_________________________________________________________________</div><div class="line"></div><div class="line"></div><div class="line">Accuracy: 100.000000</div></pre></td></tr></table></figure><p>åœ¨å®è·µä¸­ï¼Œæœ€å¥½è¿˜æ˜¯å°è¯•ä½¿ç”¨é¢„å…ˆè®­ç»ƒå¥½çš„åµŒå…¥æ¥å­¦ä¹ å•è¯åµŒå…¥ï¼Œå› ä¸ºå®ƒæ˜¯å›ºå®šçš„ï¼Œå¹¶å°è¯•åœ¨é¢„å…ˆè®­ç»ƒå¥½çš„åµŒå…¥ä¹‹ä¸Šè¿›è¡Œå­¦ä¹ ï¼Œè¿™å°±ç±»ä¼¼äºè®¡ç®—æœºè§†è§‰é‡Œé¢ç”¨é¢„è®­ç»ƒçš„VGGæˆ–è€…res-netè¿ç§»å…·ä½“é—®é¢˜é‚£æ ·ã€‚</p><p>ä¸è¿‡è¿™å–å†³äºä»€ä¹ˆæœ€é€‚åˆä½ çš„å…·ä½“é—®é¢˜ã€‚</p><h2 id="IMDB-æ•°æ®é›†Embeddingå®ä¾‹"><a href="#IMDB-æ•°æ®é›†Embeddingå®ä¾‹" class="headerlink" title="IMDB æ•°æ®é›†Embeddingå®ä¾‹"></a>IMDB æ•°æ®é›†Embeddingå®ä¾‹</h2><p><img src="/images/15204978301733.jpg" alt=""></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential,Model</div><div class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Flatten, Dense, Embedding, Input</div><div class="line"></div><div class="line">input_layer = Input(shape=(maxlen,)) </div><div class="line">x = Embedding(input_dim=<span class="number">10000</span>,output_dim=<span class="number">8</span>)(input_layer)</div><div class="line"><span class="comment"># å•ç‹¬åšä¸€ä¸ªembeddingæ¨¡å‹ï¼Œåˆ©äºåé¢è§‚å¯Ÿ</span></div><div class="line">embedding = Model(input_layer,x)</div><div class="line">x = Flatten()(x)</div><div class="line">x = Dense(<span class="number">1</span>,activation=<span class="string">'sigmoid'</span>)(x)</div><div class="line">model = Model(input_layer,x)</div><div class="line">model.compile(optimizer=<span class="string">'rmsprop'</span>,loss=<span class="string">'binary_crossentropy'</span>,metrics=[<span class="string">'acc'</span>])</div><div class="line">model.summary()</div><div class="line">history = modhistory = modhistory = mod&gt; history = model.fit(x_train,y_train,epochs=<span class="number">10</span>,batch_size=<span class="number">32</span>,validation_split=<span class="number">0.2</span>)</div><div class="line"></div><div class="line"></div><div class="line">_________________________________________________________________</div><div class="line">Layer (type)                 Output Shape              Param <span class="comment">#   </span></div><div class="line">=================================================================</div><div class="line">input_4 (InputLayer)         (<span class="keyword">None</span>, <span class="number">20</span>)                <span class="number">0</span>         </div><div class="line">_________________________________________________________________</div><div class="line">embedding_5 (Embedding)      (<span class="keyword">None</span>, <span class="number">20</span>, <span class="number">8</span>)             <span class="number">80000</span>     </div><div class="line">_________________________________________________________________</div><div class="line">flatten_5 (Flatten)          (<span class="keyword">None</span>, <span class="number">160</span>)               <span class="number">0</span>         </div><div class="line">_________________________________________________________________</div><div class="line">dense_5 (Dense)              (<span class="keyword">None</span>, <span class="number">1</span>)                 <span class="number">161</span>       </div><div class="line">=================================================================</div><div class="line"></div><div class="line">Total params: <span class="number">80</span>,<span class="number">161</span></div><div class="line">Trainable params: <span class="number">80</span>,<span class="number">161</span></div><div class="line">Non-trainable params: <span class="number">0</span></div><div class="line">_________________________________________________________________</div><div class="line">Train on <span class="number">20000</span> samples, validate on <span class="number">5000</span> samples</div><div class="line">Epoch <span class="number">1</span>/<span class="number">10</span></div><div class="line"><span class="number">20000</span>/<span class="number">20000</span> [==============================] - <span class="number">2</span>s <span class="number">105</span>us/step - loss: <span class="number">0.6772</span> - acc: <span class="number">0.6006</span> - val_loss: <span class="number">0.6448</span> - val_acc: <span class="number">0.6704</span></div><div class="line">Epoch <span class="number">2</span>/<span class="number">10</span></div><div class="line"><span class="number">20000</span>/<span class="number">20000</span> [==============================] - <span class="number">2</span>s <span class="number">93</span>us/step - loss: <span class="number">0.5830</span> - acc: <span class="number">0.7188</span> - val_loss: <span class="number">0.5629</span> - val_acc: <span class="number">0.7046</span></div><div class="line">Epoch <span class="number">3</span>/<span class="number">10</span></div><div class="line"><span class="number">20000</span>/<span class="number">20000</span> [==============================] - <span class="number">2</span>s <span class="number">95</span>us/step - loss: <span class="number">0.5152</span> - acc: <span class="number">0.7464</span> - val_loss: <span class="number">0.5362</span> - val_acc: <span class="number">0.7208</span></div><div class="line">Epoch <span class="number">4</span>/<span class="number">10</span></div><div class="line"><span class="number">20000</span>/<span class="number">20000</span> [==============================] - <span class="number">2</span>s <span class="number">93</span>us/step - loss: <span class="number">0.4879</span> - acc: <span class="number">0.7607</span> - val_loss: <span class="number">0.5299</span> - val_acc: <span class="number">0.7292</span></div><div class="line">Epoch <span class="number">5</span>/<span class="number">10</span></div><div class="line"><span class="number">20000</span>/<span class="number">20000</span> [==============================] - <span class="number">2</span>s <span class="number">97</span>us/step - loss: <span class="number">0.4731</span> - acc: <span class="number">0.7694</span> - val_loss: <span class="number">0.5290</span> - val_acc: <span class="number">0.7334</span></div><div class="line">Epoch <span class="number">6</span>/<span class="number">10</span></div><div class="line"><span class="number">20000</span>/<span class="number">20000</span> [==============================] - <span class="number">2</span>s <span class="number">98</span>us/step - loss: <span class="number">0.4633</span> - acc: <span class="number">0.7773</span> - val_loss: <span class="number">0.5317</span> - val_acc: <span class="number">0.7344</span></div><div class="line">Epoch <span class="number">7</span>/<span class="number">10</span></div><div class="line"><span class="number">20000</span>/<span class="number">20000</span> [==============================] - <span class="number">2</span>s <span class="number">96</span>us/step - loss: <span class="number">0.4548</span> - acc: <span class="number">0.7819</span> - val_loss: <span class="number">0.5333</span> - val_acc: <span class="number">0.7318</span></div><div class="line">Epoch <span class="number">8</span>/<span class="number">10</span></div><div class="line"><span class="number">20000</span>/<span class="number">20000</span> [==============================] - <span class="number">2</span>s <span class="number">93</span>us/step - loss: <span class="number">0.4471</span> - acc: <span class="number">0.7870</span> - val_loss: <span class="number">0.5377</span> - val_acc: <span class="number">0.7288</span></div><div class="line">Epoch <span class="number">9</span>/<span class="number">10</span></div><div class="line"><span class="number">20000</span>/<span class="number">20000</span> [==============================] - <span class="number">2</span>s <span class="number">95</span>us/step - loss: <span class="number">0.4399</span> - acc: <span class="number">0.7924</span> - val_loss: <span class="number">0.5422</span> - val_acc: <span class="number">0.7278</span></div><div class="line">Epoch <span class="number">10</span>/<span class="number">10</span></div><div class="line"><span class="number">20000</span>/<span class="number">20000</span> [==============================] - <span class="number">2</span>s <span class="number">90</span>us/step - loss: <span class="number">0.4328</span> - acc: <span class="number">0.7957</span> - val_loss: <span class="number">0.5458</span> - val_acc: <span class="number">0.7290</span></div></pre></td></tr></table></figure><p>æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹inputçš„shape</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">x_train[<span class="number">1</span>].shape</div><div class="line">x_train[<span class="number">1</span>]</div><div class="line">x_train[:<span class="number">1</span>].shape</div><div class="line">x_train[:<span class="number">1</span>]</div><div class="line"></div><div class="line">(<span class="number">20</span>,)</div><div class="line">array([ <span class="number">23</span>,   <span class="number">4</span>,   <span class="number">2</span>,  <span class="number">15</span>,  <span class="number">16</span>,   <span class="number">4</span>,   <span class="number">2</span>,   <span class="number">5</span>,  <span class="number">28</span>,   <span class="number">6</span>,  <span class="number">52</span>, <span class="number">154</span>, <span class="number">462</span>,</div><div class="line">        <span class="number">33</span>,  <span class="number">89</span>,  <span class="number">78</span>, <span class="number">285</span>,  <span class="number">16</span>, <span class="number">145</span>,  <span class="number">95</span>], dtype=int32)</div><div class="line">(<span class="number">1</span>, <span class="number">20</span>)</div><div class="line">array([[ <span class="number">65</span>,  <span class="number">16</span>,  <span class="number">38</span>,   <span class="number">2</span>,  <span class="number">88</span>,  <span class="number">12</span>,  <span class="number">16</span>, <span class="number">283</span>,   <span class="number">5</span>,  <span class="number">16</span>,   <span class="number">2</span>, <span class="number">113</span>, <span class="number">103</span>,</div><div class="line">         <span class="number">32</span>,  <span class="number">15</span>,  <span class="number">16</span>,   <span class="number">2</span>,  <span class="number">19</span>, <span class="number">178</span>,  <span class="number">32</span>]], dtype=int32)</div></pre></td></tr></table></figure><p>å†çœ‹çœ‹embeddingçš„è¾“å‡ºï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">embedding.predict(x_train[:<span class="number">1</span>]).shape</div><div class="line">embedding.predict(x_train[:<span class="number">1</span>])</div><div class="line"></div><div class="line">(<span class="number">1</span>, <span class="number">20</span>, <span class="number">8</span>)</div><div class="line">array([[[<span class="number">-0.17401133</span>, <span class="number">-0.08743777</span>,  <span class="number">0.15631911</span>, <span class="number">-0.06831486</span>, <span class="number">-0.09105065</span>,</div><div class="line">          <span class="number">0.06253908</span>, <span class="number">-0.0798945</span> ,  <span class="number">0.07671431</span>],</div><div class="line">        [ <span class="number">0.18718374</span>,  <span class="number">0.10347525</span>, <span class="number">-0.06668846</span>,  <span class="number">0.25818944</span>,  <span class="number">0.07522523</span>,</div><div class="line">          <span class="number">0.07082067</span>,  <span class="number">0.05170904</span>,  <span class="number">0.22902426</span>],</div><div class="line">        [ <span class="number">0.06872956</span>, <span class="number">-0.00586612</span>,  <span class="number">0.07713806</span>, <span class="number">-0.00182899</span>,  <span class="number">0.00882899</span>,</div><div class="line">         <span class="number">-0.18892162</span>, <span class="number">-0.13580748</span>, <span class="number">-0.03166043</span>],</div><div class="line">        [<span class="number">-0.01912907</span>, <span class="number">-0.01732869</span>,  <span class="number">0.00391375</span>, <span class="number">-0.02338142</span>,  <span class="number">0.02787969</span>,</div><div class="line">         <span class="number">-0.02744135</span>,  <span class="number">0.0074541</span> ,  <span class="number">0.01806928</span>],</div><div class="line">        [ <span class="number">0.20604047</span>,  <span class="number">0.10910885</span>,  <span class="number">0.06304865</span>, <span class="number">-0.14038748</span>,  <span class="number">0.12123005</span>,</div><div class="line">          <span class="number">0.06124007</span>,  <span class="number">0.0532628</span> ,  <span class="number">0.17591232</span>],</div><div class="line">        [<span class="number">-0.19636872</span>, <span class="number">-0.0027669</span> ,  <span class="number">0.01087157</span>, <span class="number">-0.02332311</span>, <span class="number">-0.04321857</span>,</div><div class="line">         <span class="number">-0.09228673</span>, <span class="number">-0.03061322</span>, <span class="number">-0.13376454</span>],</div><div class="line">        [ <span class="number">0.18718374</span>,  <span class="number">0.10347525</span>, <span class="number">-0.06668846</span>,  <span class="number">0.25818944</span>,  <span class="number">0.07522523</span>,</div><div class="line">          <span class="number">0.07082067</span>,  <span class="number">0.05170904</span>,  <span class="number">0.22902426</span>],</div><div class="line">        [<span class="number">-0.27160701</span>, <span class="number">-0.29296583</span>,  <span class="number">0.1055108</span> ,  <span class="number">0.15896739</span>, <span class="number">-0.24833643</span>,</div><div class="line">         <span class="number">-0.17791845</span>, <span class="number">-0.27316946</span>, <span class="number">-0.241273</span>  ],</div><div class="line">        [<span class="number">-0.02175452</span>, <span class="number">-0.0839383</span> ,  <span class="number">0.04338101</span>,  <span class="number">0.01062139</span>, <span class="number">-0.11473208</span>,</div><div class="line">         <span class="number">-0.18394938</span>, <span class="number">-0.05141308</span>, <span class="number">-0.10405254</span>],</div><div class="line">        [ <span class="number">0.18718374</span>,  <span class="number">0.10347525</span>, <span class="number">-0.06668846</span>,  <span class="number">0.25818944</span>,  <span class="number">0.07522523</span>,</div><div class="line">          <span class="number">0.07082067</span>,  <span class="number">0.05170904</span>,  <span class="number">0.22902426</span>],</div><div class="line">        [<span class="number">-0.01912907</span>, <span class="number">-0.01732869</span>,  <span class="number">0.00391375</span>, <span class="number">-0.02338142</span>,  <span class="number">0.02787969</span>,</div><div class="line">         <span class="number">-0.02744135</span>,  <span class="number">0.0074541</span> ,  <span class="number">0.01806928</span>],</div><div class="line">        [<span class="number">-0.14751843</span>,  <span class="number">0.05572686</span>,  <span class="number">0.20332271</span>, <span class="number">-0.01759946</span>, <span class="number">-0.0946402</span> ,</div><div class="line">         <span class="number">-0.14416233</span>,  <span class="number">0.16961734</span>,  <span class="number">0.01381243</span>],</div><div class="line">        [ <span class="number">0.00282665</span>, <span class="number">-0.17532936</span>, <span class="number">-0.09342033</span>,  <span class="number">0.04514923</span>, <span class="number">-0.04684081</span>,</div><div class="line">          <span class="number">0.1748796</span> , <span class="number">-0.09669576</span>, <span class="number">-0.10699435</span>],</div><div class="line">        [ <span class="number">0.00225757</span>, <span class="number">-0.12751001</span>, <span class="number">-0.12703758</span>,  <span class="number">0.17167819</span>, <span class="number">-0.03712473</span>,</div><div class="line">          <span class="number">0.04252302</span>,  <span class="number">0.04741228</span>, <span class="number">-0.02731293</span>],</div><div class="line">        [ <span class="number">0.02198115</span>,  <span class="number">0.03989581</span>,  <span class="number">0.13165356</span>,  <span class="number">0.06523556</span>,  <span class="number">0.14900513</span>,</div><div class="line">          <span class="number">0.01858517</span>, <span class="number">-0.01644249</span>, <span class="number">-0.02377043</span>],</div><div class="line">        [ <span class="number">0.18718374</span>,  <span class="number">0.10347525</span>, <span class="number">-0.06668846</span>,  <span class="number">0.25818944</span>,  <span class="number">0.07522523</span>,</div><div class="line">          <span class="number">0.07082067</span>,  <span class="number">0.05170904</span>,  <span class="number">0.22902426</span>],</div><div class="line">        [<span class="number">-0.01912907</span>, <span class="number">-0.01732869</span>,  <span class="number">0.00391375</span>, <span class="number">-0.02338142</span>,  <span class="number">0.02787969</span>,</div><div class="line">         <span class="number">-0.02744135</span>,  <span class="number">0.0074541</span> ,  <span class="number">0.01806928</span>],</div><div class="line">        [<span class="number">-0.01993229</span>, <span class="number">-0.04436176</span>,  <span class="number">0.07624088</span>,  <span class="number">0.04268746</span>, <span class="number">-0.00883252</span>,</div><div class="line">          <span class="number">0.00789542</span>, <span class="number">-0.03039453</span>,  <span class="number">0.05851226</span>],</div><div class="line">        [<span class="number">-0.12873659</span>, <span class="number">-0.00083202</span>, <span class="number">-0.03246918</span>,  <span class="number">0.23910245</span>, <span class="number">-0.24635716</span>,</div><div class="line">          <span class="number">0.10966355</span>,  <span class="number">0.02079294</span>, <span class="number">-0.03829115</span>],</div><div class="line">        [ <span class="number">0.00225757</span>, <span class="number">-0.12751001</span>, <span class="number">-0.12703758</span>,  <span class="number">0.17167819</span>, <span class="number">-0.03712473</span>,</div><div class="line">          <span class="number">0.04252302</span>,  <span class="number">0.04741228</span>, <span class="number">-0.02731293</span>]]], dtype=float32)</div></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œembeddingå±‚å°†(1, 20)çš„ä¸€ä¸ªè¾“å…¥sampleï¼ˆæœ€é•¿ä¸º20ä¸ªå•è¯çš„å¥å­ï¼Œå…¶ä¸­æ¯ä¸ªå•è¯è¡¨ç¤ºä¸ºä¸€ä¸ªintæ•°å­—ï¼‰ï¼ŒåµŒå…¥ä¸ºä¸€ä¸ª(1, 20, 8)çš„å‘é‡ï¼Œå³å°†æ¯ä¸ªå•è¯embedä¸ºä¸€ä¸ª8ç»´çš„å‘é‡ï¼Œè€Œæ•´ä¸ªembeddingå±‚çš„å‚æ•°å°±ç”±ç¥ç»ç½‘ç»œå­¦ä¹ å¾—åˆ°ï¼Œæ•°æ®ç»è¿‡embeddingå±‚ä¹‹åå°±æ–¹ä¾¿åœ°è½¬æ¢ä¸ºäº†å¯ä»¥ç”±CNNæˆ–è€…RNNè¿›ä¸€æ­¥å¤„ç†çš„æ ¼å¼ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" target="_blank" rel="external">How to Use Word Embedding Layers for Deep Learning with Keras - Machine Learning Mastery</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15135840798621.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;å•è¯åµŒå…¥æä¾›äº†å•è¯çš„å¯†é›†è¡¨ç¤ºåŠå…¶ç›¸å¯¹å«ä¹‰ï¼Œå®ƒä»¬æ˜¯å¯¹ç®€å•åŒ…æ¨¡å‹è¡¨ç¤ºä¸­ä½¿ç”¨çš„ç¨€ç–è¡¨ç¤ºçš„æ”¹è¿›ï¼Œå¯ä»¥ä»æ–‡æœ¬æ•°æ®ä¸­å­¦ä¹ å­—åµŒå…¥ï¼Œå¹¶åœ¨é¡¹ç›®ä¹‹é—´é‡å¤ä½¿ç”¨ã€‚å®ƒä»¬ä¹Ÿå¯ä»¥ä½œä¸ºæ‹Ÿåˆæ–‡æœ¬æ•°æ®çš„ç¥ç»ç½‘ç»œçš„ä¸€éƒ¨åˆ†æ¥å­¦ä¹ ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="Deep Learning" scheme="http://frankchen.xyz/tags/Deep-Learning/"/>
    
      <category term="Keras" scheme="http://frankchen.xyz/tags/Keras/"/>
    
  </entry>
  
  <entry>
    <title>ç¥ç»ç½‘ç»œæœ¯è¯­å¤§ç™¾ç§‘ï¼šä¼˜åŒ–å‡½æ•°ã€æ¿€æ´»å‡½æ•°ã€æŸå¤±å‡½æ•°ã€æ­£åˆ™æ–¹æ³•çš„ç®€ä»‹</title>
    <link href="http://frankchen.xyz/2017/12/15/Neural-Network-Terms-Introduction-to-Optimization-Functions-Activation-Functions-Loss-Functions-and-Regular-Functions/"/>
    <id>http://frankchen.xyz/2017/12/15/Neural-Network-Terms-Introduction-to-Optimization-Functions-Activation-Functions-Loss-Functions-and-Regular-Functions/</id>
    <published>2017-12-15T04:45:44.000Z</published>
    <updated>2017-12-16T09:21:29.262Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/neuralnetworks.png" alt="neuralnetworks"></p><p>ç®€è¿°å…³äºç¥ç»ç½‘ç»œçš„å„ç§ä¼˜åŒ–å‡½æ•°ï¼ˆSGDï¼ŒAdagradï¼ŒAdadeltaï¼ŒAdamï¼ŒAdamaxï¼ŒNadamï¼‰ã€å„ç§æ¿€æ´»å‡½æ•°ï¼ˆSigmoidï¼ŒTanhã€Hard Sigmoidã€Softplusã€ReLUã€ElUã€PReLUã€RReLUï¼‰ã€å„ç§æŸå¤±å‡½æ•°ä»¥åŠæ­£åˆ™æ–¹æ³•çš„ç®€è¿°ï¼Œå¹¶é™„å¸¦ä»£ç å®ç°ä¾‹å­ã€‚</p><a id="more"></a><h1 id="ä¼˜åŒ–å‡½æ•°"><a href="#ä¼˜åŒ–å‡½æ•°" class="headerlink" title="ä¼˜åŒ–å‡½æ•°"></a>ä¼˜åŒ–å‡½æ•°</h1><p>å…ˆä¸Šä¸¤å¼ å›¾</p><figure class="three"><br>   <img src="/images/2017/05/contours_evaluation_optimizers.gif" title="Logo" width="300"><br>   <img src="/images/2017/05/saddle_point_evaluation_optimizers.gif" title="Logo" width="300"><br></figure><h1 id="æ¿€æ´»å‡½æ•°"><a href="#æ¿€æ´»å‡½æ•°" class="headerlink" title="æ¿€æ´»å‡½æ•°"></a>æ¿€æ´»å‡½æ•°</h1><p>æ²¡æœ‰æ¿€æ´»å‡½æ•°ï¼Œç¥ç»å…ƒå°±åªæ˜¯ä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼Œé‚£ä¹ˆæ— è®ºå¤šå°‘å±‚çš„ç¥ç»å…ƒå åŠ æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚è€Œä¸»æµæ¿€æ´»å‡½æ•°ä¹Ÿéšç€ç¥ç»ç½‘ç»œã€æ·±åº¦å­¦ä¹ çš„å‘å±•è¿­ä»£è¿›åŒ–äº†è®¸å¤šæ¬¡ä»£ã€‚</p><h2 id="Sigmoid"><a href="#Sigmoid" class="headerlink" title="Sigmoid"></a>Sigmoid</h2><p><img src="/images/15134144452960.jpg" alt=""><br>Sigmoidæ˜¯Så½¢çŠ¶çš„æ„æ€ï¼Œåˆå› ä¸ºå®ƒæ˜¯é€»è¾‘å›å½’çš„æ¿€æ´»å‡½æ•°åˆå«logisticå‡½æ•°ï¼Œå‡½æ•°å¼ä¸º$<code>y = 1 / (1 + exp(-x))</code>$æ˜¯å¾ˆæ—©ä»¥å‰æœ€å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°ï¼Œå…¶å®ä¹Ÿæ˜¯æœ‰ä¸€äº›ä¼˜ç‚¹çš„ï¼Œæ¯”å¦‚ï¼Œ</p><ul><li>å€¼åŸŸä½äº0-1ï¼Œé‚£ä¹ˆå¯¹äºé€»è¾‘å›å½’ï¼Œè¿™æ˜¯å¯¹äºäºŒåˆ†ç±»çš„ä¸€ä¸ªå¾ˆè‡ªç„¶çš„è¡¨è¾¾ï¼Œä¹Ÿå°±æ˜¯æ¦‚ç‡</li><li>å¤„å¤„è¿ç»­å¯å¯¼</li></ul><p>ä¸è¿‡å‘¢ï¼Œæˆ‘ä»¬è§‚å¯Ÿå®ƒçš„å½¢çŠ¶ï¼Œå¯ä»¥å¾—å‡ºï¼ŒSigmoidå‡½æ•°åœ¨ä¸¤ç«¯ï¼ˆé è¿‘0å’Œ1çš„éƒ¨åˆ†ï¼‰æ¢¯åº¦å¾ˆå°ï¼Œè¿™ä¹Ÿæ„å‘³ç€ï¼Œå¦‚æœç¥ç»å…ƒçš„è¾“å‡ºè½åˆ°äº†è¿™ä¸ªåœ°æ–¹ï¼Œé‚£ä¹ˆå®ƒå‡ ä¹æ²¡ä»€ä¹ˆæ¢¯åº¦å¯ä»¥ä¼ åˆ°åé¢ï¼Œè€Œéšç€ç¥ç»ç½‘ç»œçš„å±‚å±‚å‰Šå¼±ï¼Œåé¢çš„å±‚ï¼ˆé è¿‘è¾“å…¥çš„å±‚ï¼‰æ²¡æœ‰å¤šå°‘æ¢¯åº¦èƒ½ä¼ è¿‡æ¥ï¼Œå‡ ä¹å°±â€œå­¦ä¸åˆ°ä»€ä¹ˆâ€äº†ã€‚è¿™å«åšæ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œä¸€åº¦æ˜¯é˜»ç¢ç¥ç»ç½‘ç»œå¾€æ›´æ·±çš„å±‚è¿›åŒ–çš„ä¸»è¦å›°éš¾ï¼Œå¯¼è‡´æ·±åº¦å­¦ä¹ ä¸“å®¶ä»¬ç»å°½è„‘æ±æƒ³äº†è®¸å¤šæ–¹æ³•æ¥å¯¹æŠ—è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚â€œXavier and He Initializationâ€ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦æŠŠweightéšæœºåˆå§‹åŒ–ä¸ºå¦‚ä¸‹çš„èŒƒå›´ï¼Œ<br><img src="/images/Screen%20Shot%202017-12-16%20at%2017.03.18.png" alt="Screen Shot 2017-12-16 at 17.03.18"></p><p>sigmoidçš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯å®ƒä¸æ˜¯0å‡å€¼çš„ï¼ŒSigmoidå‡½æ•°çš„è¾“å‡ºå€¼æ’å¤§äº0ï¼Œè¿™ä¼šå¯¼è‡´æ¨¡å‹è®­ç»ƒçš„æ”¶æ•›é€Ÿåº¦å˜æ…¢ã€‚ä¸¾ä¾‹æ¥è®²ï¼Œå¯¹ï¼Œå¦‚æœæ‰€æœ‰å‡ä¸ºæ­£æ•°æˆ–è´Ÿæ•°ï¼Œé‚£ä¹ˆå…¶å¯¹çš„å¯¼æ•°æ€»æ˜¯æ­£æ•°æˆ–è´Ÿæ•°ï¼Œè¿™ä¼šå¯¼è‡´å¦‚ä¸‹å›¾çº¢è‰²ç®­å¤´æ‰€ç¤ºçš„é˜¶æ¢¯å¼æ›´æ–°ï¼Œè¿™æ˜¾ç„¶å¹¶éä¸€ä¸ªå¥½çš„ä¼˜åŒ–è·¯å¾„ã€‚æ·±åº¦å­¦ä¹ å¾€å¾€éœ€è¦å¤§é‡æ—¶é—´æ¥å¤„ç†å¤§é‡æ•°æ®ï¼Œæ¨¡å‹çš„æ”¶æ•›é€Ÿåº¦æ˜¯å°¤ä¸ºé‡è¦çš„ã€‚æ‰€ä»¥ï¼Œæ€»ä½“ä¸Šæ¥è®²ï¼Œè®­ç»ƒæ·±åº¦å­¦ä¹ ç½‘ç»œå°½é‡ä½¿ç”¨zero-centeredæ•°æ® (å¯ä»¥ç»è¿‡æ•°æ®é¢„å¤„ç†å®ç°) å’Œzero-centeredè¾“å‡ºã€‚</p><p><img src="/images/15134157378274.jpg" alt=""></p><p>å¦‚ä»Šï¼Œsigmoidå‡½æ•°åº”ç”¨æœ€å¹¿æ³›çš„åœ¨äºå…¶å˜ç§softmaxåœ¨å¤šå…ƒåˆ†ç±»ä¸­ï¼Œæ¯”å¦‚æ‰‹å†™æ•°å­—è¯†åˆ«ï¼Œç»è¿‡å·ç§¯ç¥ç»ç½‘ç»œçš„å¤„ç†ï¼Œæœ€åæˆ‘ä»¬éœ€è¦ç½‘ç»œè¾“å‡ºæ¯ä¸ªé¢„æµ‹çš„æ¦‚ç‡å€¼ï¼Œæœ€åé¢„æµ‹ä¸ºæŸä¸€ä¸ªæ•°å­—ï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°softmaxï¼Œ<br><img src="/images/15134154076033.jpg" alt=""><br>ä»¥ä¸‹æ˜¯softmaxçš„Kerasä»£ç ï¼Œæ³¨æ„å…¶ä¸­ä¸€ä¸ªtrickï¼Œ<code>e = K.exp(x - K.max(x, axis=axis, keepdims=True))</code>è¿™é‡Œæ¯ä¸ªåˆ†é‡å‡å»æœ€å¤§å€¼æ˜¯ä¸ºäº†å‡å°‘è®¡ç®—é‡ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">softmax</span><span class="params">(x, axis=<span class="number">-1</span>)</span>:</span></div><div class="line">    <span class="string">"""Softmax activation function.</span></div><div class="line"></div><div class="line">    # Arguments</div><div class="line">        x : Tensor.</div><div class="line">        axis: Integer, axis along which the softmax normalization is applied.</div><div class="line"></div><div class="line">    # Returns</div><div class="line">        Tensor, output of softmax transformation.</div><div class="line"></div><div class="line">    # Raises</div><div class="line">        ValueError: In case `dim(x) == 1`.</div><div class="line">    """</div><div class="line">    ndim = K.ndim(x)</div><div class="line">    <span class="keyword">if</span> ndim == <span class="number">2</span>:</div><div class="line">        <span class="keyword">return</span> K.softmax(x)</div><div class="line">    <span class="keyword">elif</span> ndim &gt; <span class="number">2</span>:</div><div class="line">        e = K.exp(x - K.max(x, axis=axis, keepdims=<span class="keyword">True</span>))</div><div class="line">        s = K.sum(e, axis=axis, keepdims=<span class="keyword">True</span>)</div><div class="line">        <span class="keyword">return</span> e / s</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'Cannot apply softmax to a tensor that is 1D'</span>)</div></pre></td></tr></table></figure></p><h2 id="tanh"><a href="#tanh" class="headerlink" title="tanh"></a>tanh</h2><p><img src="/images/15134156685588.jpg" alt=""></p><p>tanh æ˜¯sigmoidçš„å˜å½¢ï¼š $tanh(x)=2sigmoid(2x)-1$ï¼Œä¸ sigmoid ä¸åŒçš„æ˜¯ï¼Œtanh æ˜¯0å‡å€¼çš„ã€‚å› æ­¤ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œtanh ä¼šæ¯” sigmoid æ›´å¥½ä¸€äº›ï¼Œ</p><p><img src="/images/15134156615077.jpg" alt=""></p><h2 id="ReLUå®¶æ—"><a href="#ReLUå®¶æ—" class="headerlink" title="ReLUå®¶æ—"></a>ReLUå®¶æ—</h2><p>ç„¶è€Œæ ‡å‡†ReLUä¸æ˜¯å®Œç¾çš„ï¼Œæ¯”å¦‚å› ä¸ºReLUåœ¨å°äº0çš„åæ ‡æ¢¯åº¦éƒ½æ˜¯0ï¼Œé‚£ä¹ˆä¼šé€ æˆâ€œæ­»äº¡â€çš„ç¥ç»å…ƒçš„é—®é¢˜ï¼šä¸€æ—¦ç¥ç»å…ƒçš„è¾“å…¥ä¸æƒé‡ä¹‹ä¹˜ç§¯æ˜¯è´Ÿçš„ï¼Œé‚£ä¹ˆç»è¿‡ReLUçš„æ¿€æ´»ï¼Œè¾“å‡ºå°±æ˜¯0ï¼Œè€ŒReLUçš„0æ¢¯åº¦è®©â€œæ­»äº¡â€çš„ç¥ç»å…ƒæ— æ³•â€œå¤æ´»â€ï¼šæ²¡åŠæ³•å›åˆ°è¾“å‡ºä¸æ˜¯0çš„çŠ¶æ€ï¼Œè¿™æ ·å°±å‡ºç°äº†è®¸å¤šåœ¨ReLUçš„å˜ç§ï¼Œä¸€èˆ¬éƒ½æ˜¯å¯¹æ ‡å‡†ReLUåæ ‡è½´å·¦è¾¹çš„éƒ¨åˆ†åšæ–‡ç« ï¼Œæ¯”å¦‚<strong>leaky ReLU</strong>ã€‚å…¶å…¬å¼å°±æ˜¯$LeakyReLU_ Î± (z) = max(\alpha z,z)$ã€‚å¦‚å›¾ï¼Œ<br><img src="/images/15134123600394.jpg" alt=""></p><p>è¿™ç¯‡æ–‡ç« <a href="https://arxiv.org/pdf/1505.00853.pdf" target="_blank" rel="external">Empirical Evaluation of Rectified Activations in Convolution Network</a>å¯¹æ¯”äº†å‡ ç§leaky ReLUï¼Œæ¯”å¦‚æŠŠ$\alpha$è®¾ç½®ä¸º0.2æ•ˆæœæ€»æ˜¯å¥½è¿‡0.01ï¼Œå¹¶ä¸”ï¼Œå¯¹äºrandomized leaky ReLU (RReLU)ï¼ˆå…¶ä¸­$\alpha$è®¾ç½®ä¸ºä¸€ä¸ªåœ¨æŒ‡å®šèŒƒå›´å†…çš„éšæœºæ•°ï¼‰ï¼Œæ•ˆæœä¹Ÿä¸é”™ï¼Œè€Œä¸”è¿˜å…·æœ‰ä¸€å®šçš„æ­£åˆ™ä½œç”¨ã€‚å¦å¤–ï¼Œå¯¹äºparametric leaky ReLU (PReLU)ï¼ˆå…¶ä¸­$\alpha$ä½œä¸ºç½‘ç»œçš„ä¸€ä¸ªå‚æ•°ï¼Œè¢«åå‘ä¼ æ’­å­¦ä¹ å‡ºæ¥ï¼Œä¹‹å‰çš„$\alpha$éƒ½æ˜¯è¶…å‚æ•°ï¼Œä¸èƒ½å­¦åªèƒ½è°ƒèŠ‚ï¼‰ï¼Œè¿™ç§å˜ç§å¯¹äºå¤§æ•°æ®é›†ä¸é”™ï¼Œä½†æ˜¯æ•°æ®é‡è¿‡å°å°±æœ‰è¿‡æ‹Ÿåˆçš„é£é™©ã€‚ä»¥ä¸‹æ˜¯Kerasé‡Œé¢reluçš„ä»£ç ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">relu</span><span class="params">(x, alpha=<span class="number">0.</span>, max_value=None)</span>:</span></div><div class="line">    <span class="string">"""Rectified linear unit.</span></div><div class="line"></div><div class="line">    With default values, it returns element-wise `max(x, 0)`.</div><div class="line"></div><div class="line">    # Arguments</div><div class="line">        x: A tensor or variable.</div><div class="line">        alpha: A scalar, slope of negative section (default=`0.`).</div><div class="line">        max_value: Saturation threshold.</div><div class="line"></div><div class="line">    # Returns</div><div class="line">        A tensor.</div><div class="line">    """</div><div class="line">    <span class="keyword">if</span> alpha != <span class="number">0.</span>:</div><div class="line">        negative_part = tf.nn.relu(-x)</div><div class="line">    x = tf.nn.relu(x)</div><div class="line">    <span class="keyword">if</span> max_value <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">        max_value = _to_tensor(max_value, x.dtype.base_dtype)</div><div class="line">        zero = _to_tensor(<span class="number">0.</span>, x.dtype.base_dtype)</div><div class="line">        x = tf.clip_by_value(x, zero, max_value)</div><div class="line">    <span class="keyword">if</span> alpha != <span class="number">0.</span>:</div><div class="line">        alpha = _to_tensor(alpha, x.dtype.base_dtype)</div><div class="line">        x -= alpha * negative_part</div><div class="line">    <span class="keyword">return</span> x</div></pre></td></tr></table></figure><p>å¦å¤–ï¼Œåœ¨è¿™ç¯‡æ–‡ç« é‡Œé¢<a href="https://arxiv.org/pdf/1511.07289v5.pdf" target="_blank" rel="external">FAST AND ACCURATE DEEP NETWORK LEARNING BY EXPONENTIAL LINEAR UNITS (ELUS)</a>ï¼Œå¼•å…¥äº†ä¸€ç§æ–°çš„ReLUï¼Œexponential linear unit (ELU)ï¼Œå…¬å¼å¦‚ä¸‹ï¼Œ<br>$$<br>ELU_{\alpha}(z) = \alpha (\exp(z)-1) \ if \ z \lt 0 ; \ z \ if \ z \gt 0;<br>$$<br><img src="/images/15134129990682.jpg" alt=""></p><p>ä¸æ ‡å‡†ReLUæœ€å¤§çš„åŒºåˆ«åœ¨äºå®ƒå¤„å¤„è¿ç»­å¯å¯¼ï¼Œè¿™ä½¿å¾—æ¢¯åº¦ä¸‹é™å¾—åˆ°åŠ é€Ÿï¼Œæ”¶æ•›å¾—åˆ°äº†åŠ é€Ÿï¼Œè€Œä½¿ç”¨äº†æŒ‡æ•°å‡½æ•°ä½¿å¾—å…¶æµ‹è¯•é˜¶æ®µçš„è®¡ç®—ä»£ä»·æ›´é«˜ã€‚Kerasé‡Œeluçš„å®ç°ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">elu</span><span class="params">(x, alpha=<span class="number">1.</span>)</span>:</span></div><div class="line">    <span class="string">"""Exponential linear unit.</span></div><div class="line"></div><div class="line">    # Arguments</div><div class="line">        x: A tenor or variable to compute the activation function for.</div><div class="line">        alpha: A scalar, slope of positive section.</div><div class="line"></div><div class="line">    # Returns</div><div class="line">        A tensor.</div><div class="line">    """</div><div class="line">    res = tf.nn.elu(x)</div><div class="line">    <span class="keyword">if</span> alpha == <span class="number">1</span>:</div><div class="line">        <span class="keyword">return</span> res</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> tf.where(x &gt; <span class="number">0</span>, res, alpha * res)</div></pre></td></tr></table></figure><h2 id="æ¿€æ´»å‡½æ•°çš„é€‰æ‹©"><a href="#æ¿€æ´»å‡½æ•°çš„é€‰æ‹©" class="headerlink" title="æ¿€æ´»å‡½æ•°çš„é€‰æ‹©"></a>æ¿€æ´»å‡½æ•°çš„é€‰æ‹©</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬çš„é€‰æ‹©é¡ºåºå¯ä»¥ç†è§£ä¸ºï¼š<br>ELU &gt; leaky ReLU (ä»¥åŠå…¶å˜ç§) &gt; ReLU &gt; tanh &gt; logisticã€‚ä½†æ˜¯ï¼Œ</p><ul><li>å¦‚æœæˆ‘ä»¬æ›´é¡¾è™‘æ¨¡å‹è¿è¡Œé€Ÿåº¦ï¼Œé‚£ä¹ˆleaky ReLUå¯èƒ½æ¯”ELUæ›´å¥½ï¼›</li><li>å¦‚æœæˆ‘ä»¬ä¸æƒ³è°ƒèŠ‚è¶…å‚æ•°ï¼Œé‚£ä¹ˆç”¨é»˜è®¤çš„$\alpha$å°±è¡Œï¼ŒReLUå’ŒELUçš„åˆ†åˆ«æ˜¯0.01å’Œ1ï¼› </li><li>å¦‚æœç®—åŠ›è¶³å¤Ÿå¯ä»¥ç”¨æ¥è°ƒå‚ï¼Œé‚£ä¹ˆå¦‚æœç½‘ç»œè¿‡æ‹Ÿåˆæˆ‘ä»¬ä¼šé€‰æ‹©RReLUï¼Œå¦‚æœè®­ç»ƒé›†æ•°æ®è¶³å¤Ÿå¤šï¼Œé‚£å¯ä»¥ç”¨PReLUã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/neuralnetworks.png&quot; alt=&quot;neuralnetworks&quot;&gt;&lt;/p&gt;
&lt;p&gt;ç®€è¿°å…³äºç¥ç»ç½‘ç»œçš„å„ç§ä¼˜åŒ–å‡½æ•°ï¼ˆSGDï¼ŒAdagradï¼ŒAdadeltaï¼ŒAdamï¼ŒAdamaxï¼ŒNadamï¼‰ã€å„ç§æ¿€æ´»å‡½æ•°ï¼ˆSigmoidï¼ŒTanhã€Hard Sigmoidã€Softplusã€ReLUã€ElUã€PReLUã€RReLUï¼‰ã€å„ç§æŸå¤±å‡½æ•°ä»¥åŠæ­£åˆ™æ–¹æ³•çš„ç®€è¿°ï¼Œå¹¶é™„å¸¦ä»£ç å®ç°ä¾‹å­ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Deep Learning" scheme="http://frankchen.xyz/tags/Deep-Learning/"/>
    
      <category term="Algorithm" scheme="http://frankchen.xyz/tags/Algorithm/"/>
    
      <category term="Data Science" scheme="http://frankchen.xyz/tags/Data-Science/"/>
    
      <category term="Python" scheme="http://frankchen.xyz/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ç†è§£Pandas å’Œ Numpyé‡Œçš„axis</title>
    <link href="http://frankchen.xyz/2017/12/12/Understanding-the-axis-parameter-in-Pandas-and-Numpy/"/>
    <id>http://frankchen.xyz/2017/12/12/Understanding-the-axis-parameter-in-Pandas-and-Numpy/</id>
    <published>2017-12-12T10:36:04.000Z</published>
    <updated>2018-03-09T11:12:08.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15130766716183.jpg" alt=""></p><p>ç®€è¿°ä¸€ç§å¦‚ä½•ç›´è§‚çš„ç†è§£Pandas å’Œ Numpyé‡Œé¢çš„axiså‚æ•°çš„æ–¹æ³•ã€‚<br><a id="more"></a></p><p>Numpy å’Œ Pandasé‡Œçš„sortã€meanã€dropç­‰æ“ä½œï¼Œä¸æ˜¯åˆ†è¡Œæˆ–è€…åˆ—åˆ†åˆ«ç”¨ä¸€ä¸ªmethodæ¥å®šä¹‰ï¼Œè€Œæ˜¯ä¸€ä¸ªmethodé‡Œé¢ç”¨æˆ·æŒ‡å®šaxisæ¥æ“ä½œçš„ï¼Œä¸¾ä¾‹æ¥è¯´ï¼š</p><p>æˆ‘ä»¬å…ˆåœ¨<a href="https://raw.githubusercontent.com/justmarkham/pandas-videos/master/data/drinks.csv" target="_blank" rel="external">æ­¤å¤„</a>ä¸‹è½½äº†ä¸€ä»½å„å›½é…’ç±»æ¶ˆè´¹çš„csvæ–‡ä»¶ä¸ºä¾‹ã€‚<br><img src="/images/Screen%20Shot%202017-12-12%20at%2018.46.14.png" alt="Screen Shot 2017-12-12 at 18.46.14"><br>å¦‚ä¸‹æ˜¯pandasé‡ŒæŒ‰axis 0å’Œ1è¿›è¡Œdropçš„æ“ä½œç¤ºä¾‹ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œaxis 0æ˜¯æŒ‰è¡Œdropï¼Œè€Œaxis 1æ˜¯æŒ‰åˆ—dropï¼š<br><img src="/images/Screen%20Shot%202017-12-12%20at%2018.46.22.png" alt="Screen Shot 2017-12-12 at 18.46.22"></p><p>ä½†æ˜¯ï¼Œmeanæ“ä½œå‘¢ï¼Ÿ<br><img src="/images/Screen%20Shot%202017-12-12%20at%2018.49.18.png" alt="Screen Shot 2017-12-12 at 18.49.18"></p><p>å®¹æ˜“çœ‹å‡ºï¼Œaxis 0å¾—å‡ºäº†æ¯ä¸€åˆ—çš„å‡å€¼ï¼Œè€Œaxis 1å¾—å‡ºäº†åˆ™æ˜¯æ¯ä¸€è¡Œçš„å‡å€¼ã€‚<br>é‚£ä¹ˆï¼Œåœ¨Numpyé‡Œå‘¢ï¼Ÿ</p><p><img src="/images/Screen%20Shot%202017-12-12%20at%2019.06.17.png" alt="Screen Shot 2017-12-12 at 19.06.17"></p><p>å®¹æ˜“çœ‹å‡ºï¼Œaxisä¸º1çš„æ—¶å€™å¾—å‡ºçš„æ˜¯æ¯è¡Œçš„sumï¼Œaxisä¸º0çš„æ—¶å€™å¾—å‡ºäº†æ¯åˆ—çš„sumã€‚</p><p>ç”±ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬ä¼¼ä¹å¯ä»¥çœ‹å‡ºï¼Œaxisä¸º1ä»£è¡¨æ°´å¹³æ–¹å‘ä¸Šçš„æ“ä½œï¼Œaxisä¸º0ä»£è¡¨å‚ç›´æ–¹å‘ä¸Šçš„æ“ä½œï¼Œæ¯”å¦‚axisä¸º1çš„sumå¾—å‡ºçš„å°±æ˜¯æ¯ä¸€è¡Œçš„å’Œã€‚</p><p><img src="/images/15130760734631.jpg" alt=""></p><p>ä½†æ˜¯ï¼Œåœ¨Pandasçš„Dataframeé‡Œé¢ï¼Œä¸ºä»€ä¹ˆaxis=1ä»£è¡¨çš„æ˜¯dropæ•´ä¸ªåˆ—å‘¢ï¼Ÿä»¥ä¸‹è¿™ä¸ªä¾‹å­ä¹Ÿå¯ä»¥è¯´æ˜ä¸€äº›æƒ…å†µï¼š</p><p><img src="/images/Screen%20Shot%202017-12-12%20at%2018.56.53.png" alt="Screen Shot 2017-12-12 at 18.56.53"></p><p>è”ç³»è¿™ä¸ªè§†é¢‘<a href="https://www.youtube.com/watch?v=PtO3t6ynH-8" target="_blank" rel="external">How do I use the â€œaxisâ€ parameter in pandas? - YouTube</a>ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å¾—åˆ°ä¸€äº›ç»“è®ºï¼Œä½œè€…è¯´ï¼š</p><blockquote><p>0 is the row axis, and 1 is the column axis. When you drop with axis=1, that means drop a column. When you take the mean with axis=1, that means the operation should â€œmove acrossâ€ the column axis, which produces row means.<br>æŒ‡çš„å°±æ˜¯ä¸€ç§æ›´åŠ å®¹æ˜“ç†è§£çš„æ–¹å¼ï¼Œâ€œ0å°±æ˜¯è¡Œçš„axisï¼Œ1å°±æ˜¯åˆ—çš„axisï¼Œå½“ä»¥axis=1æ¥dropï¼Œé‚£ä¹ˆå°±æ˜¯dropä¸€ä¸ªcolumnï¼Œè€Œaxis=1 æ¥å–meanï¼Œé‚£ä¹ˆå°±æ˜¯è¿™ä¸ªæ“ä½œâ€˜ç©¿è¶Šâ€™äº†åˆ—çš„axisï¼Œäº§ç”Ÿäº†è¡Œä¸Šçš„meanâ€ã€‚</p></blockquote><p>å¦å¤–ï¼Œå…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·æ¥æ“ä½œï¼Œ<br><img src="/images/Screen%20Shot%202017-12-12%20at%2019.01.27.png" alt="Screen Shot 2017-12-12 at 19.01.27"><br><img src="/images/Screen%20Shot%202017-12-12%20at%2019.01.45.png" alt="Screen Shot 2017-12-12 at 19.01.45"></p><p>å¯ä»¥çœ‹å‡ºï¼Œaxis=0ä¸axis=â€™rowsâ€™æ˜¯ä¸€æ ·çš„ï¼ˆåœ¨Pandasé‡Œï¼‰ï¼Œæ˜¯ä¸æ˜¯æ›´åŠ å®¹æ˜“ç†è§£äº†ï¼Ÿ</p><p><a href="https://distill.pub/2016/misread-tsne/" target="_blank" rel="external">How to Use t-SNE Effectively</a>è¿™ä¸ªç½‘ç«™ç»™äº†ä¸€ä¸ªéå¸¸å½¢è±¡çš„t-SNEåœ¨çº¿å®éªŒç¯å¢ƒï¼Œæ¨èå¤§å®¶å»çœ‹ä¸€çœ‹ï¼<br><img src="/images/15205939273866.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15130766716183.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;ç®€è¿°ä¸€ç§å¦‚ä½•ç›´è§‚çš„ç†è§£Pandas å’Œ Numpyé‡Œé¢çš„axiså‚æ•°çš„æ–¹æ³•ã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="python" scheme="http://frankchen.xyz/tags/python/"/>
    
      <category term="Data Science" scheme="http://frankchen.xyz/tags/Data-Science/"/>
    
      <category term="Numpy" scheme="http://frankchen.xyz/tags/Numpy/"/>
    
      <category term="Pandas" scheme="http://frankchen.xyz/tags/Pandas/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£triplet loss</title>
    <link href="http://frankchen.xyz/2017/12/01/understanding-triplet-loss-and-example-code/"/>
    <id>http://frankchen.xyz/2017/12/01/understanding-triplet-loss-and-example-code/</id>
    <published>2017-12-01T09:19:05.000Z</published>
    <updated>2018-05-23T07:43:15.095Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15121200710041.jpg" alt=""><br>ç†è§£triplet lossï¼Œä¸ç»™å‡ºTensorFlowå’Œnumpyä¸¤ç§å½¢å¼çš„example codeã€‚<br><a id="more"></a></p><p>Triplet Loss æ˜¯å½“å‰åº”ç”¨çš„å¾ˆå¹¿æ³›çš„ä¸€ç§æŸå¤±å‡½æ•°ï¼Œåœ¨äººè„¸è¯†åˆ«å’Œèšç±»é¢†åŸŸï¼Œè¿™æ˜¯ä¸€ç§å¾ˆè‡ªç„¶çš„æ˜ å°„ä¸è®¡ç®—æŸå¤±çš„æ–¹å¼ï¼Œæ¯”å¦‚<a href="https://arxiv.org/abs/1503.03832" target="_blank" rel="external">FaceNet</a>é‡Œï¼Œé€šè¿‡æ„å»ºä¸€ç§embedding æ–¹å¼ï¼Œå°†äººè„¸å›¾åƒç›´æ¥æ˜ å°„åˆ°æ¬§å¼ç©ºé—´ï¼Œè€Œä¼˜åŒ–è¿™ç§embeddingçš„æ–¹æ³•å¯ä»¥æ¦‚æ‹¬ä¸ºï¼Œæ„å»ºè®¸å¤šç»„ä¸‰å…ƒç»„ï¼ˆAnchorï¼ŒPositiveï¼ŒNegativeï¼‰ï¼Œå…¶ä¸­Anchorä¸PositiveåŒlabelï¼ŒAnchorä¸Negativeä¸åŒlabelï¼ˆåœ¨äººè„¸è¯†åˆ«é‡Œé¢ï¼Œå°±æ˜¯Anchorä¸Positiveæ˜¯åŒä¸€ä¸ªä¸ªä½“ï¼Œè€Œä¸Negativeæ˜¯ä¸åŒä¸ªä½“ï¼‰ï¼Œé€šè¿‡å­¦ä¹ ä¼˜åŒ–è¿™ä¸ªembeddingï¼Œä½¿å¾—æ¬§å¼ç©ºé—´å†…çš„Anchorä¸Positive çš„è·ç¦»æ¯”ä¸Negativeçš„è·ç¦»è¦è¿‘ã€‚</p><h2 id="å…¬å¼è¡¨ç¤º"><a href="#å…¬å¼è¡¨ç¤º" class="headerlink" title="å…¬å¼è¡¨ç¤º"></a>å…¬å¼è¡¨ç¤º</h2><p>ç”¨å…¬å¼è¡¨ç¤ºå°±æ˜¯ï¼Œæˆ‘ä»¬å¸Œæœ›ï¼š</p><p>$$<br>\left\lVert  f(x^a_i) - f(x^p_i) \right\rVert ^2_2  +<br>\alpha \lt \left\lVert  f(x^a_i) - f(x^n_i) \right\rVert ^2_2 , \<br>\forall (f(x^a_i) , f(x^p_i) , f(x^n_i))  \in \mathscr T<br>$$</p><p>å…¶ä¸­$\alpha$ æ˜¯å¼ºåˆ¶çš„æ­£ä¾‹å’Œè´Ÿä¾‹ä¹‹é—´çš„marginï¼Œ$\mathscr T$æ˜¯å…·æœ‰åŸºæ•°ä¸º$N$çš„è®­ç»ƒé›†ä¸­çš„ä¸‰å…ƒç»„çš„é›†åˆã€‚</p><p>é‚£ä¹ˆï¼ŒæŸå¤±å‡½æ•°å¾ˆè‡ªç„¶çš„å¯ä»¥å†™ä¸ºï¼š</p><p>$$<br>\sum^N_i<br>\Bigl [<br>\left\lVert  f(x^a_i) - f(x^p_i) \right\rVert ^2_2   -<br> \left\lVert  f(x^a_i) - f(x^n_i) \right\rVert ^2_2 + \alpha<br> \Bigr ] _ +<br>$$</p><p>å…¶ä¸­åŠ å·æŒ‡çš„ï¼Œå¦‚æœä¸­æ‹¬å·å†…éƒ¨åˆ†å°äº0ï¼Œåˆ™æ²¡æœ‰æŸå¤±ï¼ˆAnchorä¸Positiveçš„è·ç¦»åŠ ä¸Šmarginå°äºä¸Negativeçš„è·ç¦»ï¼‰ï¼Œå¦åˆ™è®¡ç®—è¿™ä¸ªè·ç¦»ä¸ºæŸå¤±ã€‚</p><h2 id="ä»£ç è¡¨ç¤º"><a href="#ä»£ç è¡¨ç¤º" class="headerlink" title="ä»£ç è¡¨ç¤º"></a>ä»£ç è¡¨ç¤º</h2><p>Numpy å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line">batch_size = <span class="number">3</span>*<span class="number">12</span></div><div class="line">embedding_size = <span class="number">16</span></div><div class="line"></div><div class="line"><span class="comment"># æ„é€ batch_size * embedding_size ç»´åº¦çš„éšæœºçŸ©é˜µ</span></div><div class="line">emb = np.random.uniform(size=[])</div><div class="line"></div><div class="line"><span class="comment"># å¯¹embé€¢ä¸‰å–1ã€2ã€3è¡Œåˆ†åˆ«ä¸ºAnchorã€Positiveã€Negative</span></div><div class="line"><span class="comment"># è®¡ç®—å…¶2èŒƒæ•°çš„è·ç¦»å³æ¬§æ°è·ç¦»</span></div><div class="line">pos_dist_sqr = np.sum(np.square(emb[<span class="number">0</span>::<span class="number">3</span>,:]-emb[<span class="number">1</span>::<span class="number">3</span>,:]), axis=<span class="number">1</span>)        </div><div class="line">neg_dist_sqr = np.sum(np.square(emb[<span class="number">0</span>::<span class="number">3</span>,:]-emb[<span class="number">2</span>::<span class="number">3</span>,:]), axis=<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="comment"># è¿™é‡Œå°±æ˜¯ç…§æŠ„å…¬å¼äº†ï¼Œæ³¨æ„meanå’Œsumæ˜¯ä¸€æ ·çš„</span></div><div class="line">np_triplet_loss = np.mean(np.maximum(<span class="number">0.</span>, pos_dist_sqr-neg_dist_sqr+alpha))</div></pre></td></tr></table></figure><p>TensorFlow å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"></div><div class="line">batch_size = <span class="number">3</span>*<span class="number">12</span></div><div class="line">embedding_size = <span class="number">16</span></div><div class="line">alpha = <span class="number">0.2</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">triplet_loss</span><span class="params">(anchor, positive, negative, alpha)</span>:</span>   </div><div class="line">    <span class="keyword">with</span> tf.variable_scope(<span class="string">'triplet_loss'</span>):</div><div class="line">        pos_dist = tf.reduce_sum(tf.square(tf.subtract(anchor, positive)), <span class="number">1</span>)</div><div class="line">        neg_dist = tf.reduce_sum(tf.square(tf.subtract(anchor, negative)), <span class="number">1</span>)</div><div class="line">        basic_loss = tf.add(tf.subtract(pos_dist, neg_dist), alpha)</div><div class="line">        loss = tf.reduce_mean(tf.maximum(basic_loss, <span class="number">0.0</span>), <span class="keyword">None</span>)</div><div class="line">    <span class="keyword">return</span> loss</div><div class="line"></div><div class="line"><span class="comment"># æ„å»ºçŸ©é˜µ</span></div><div class="line">embeddings = tf.placeholder(np.float64, shape=(batch_size, embedding_size), name=<span class="string">'embeddings'</span>)</div><div class="line"><span class="comment"># å…ˆå°†embeddingsçŸ©é˜µç¬¬0ç»´resizeä¸º(?, 3)ç»´ï¼Œç¬¬1ç»´ä¸å˜ï¼Œå˜ä¸ºä¸‰ç»´çŸ©é˜µ(-1, 3, embedding_size)ï¼Œå†åœ¨å…¶ç¬¬äºŒç»´åº¦ä¸º3ä¸Šunstackä¸ºä¸‰ä»½</span></div><div class="line">anchor, positive, negative = tf.unstack(tf.reshape(embeddings, shape=(<span class="number">-1</span>, <span class="number">3</span>, embedding_size)), axis=<span class="number">1</span>)</div></pre></td></tr></table></figure><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼Œè¿™é‡Œæµ‹è¯•å¯¹æ¯”äº†ä¸¤ç§å®ç°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line">batch_size = <span class="number">3</span>*<span class="number">12</span></div><div class="line">embedding_size = <span class="number">16</span></div><div class="line">alpha = <span class="number">0.2</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">triplet_loss</span><span class="params">(anchor, positive, negative, alpha)</span>:</span>   </div><div class="line">    <span class="keyword">with</span> tf.variable_scope(<span class="string">'triplet_loss'</span>):</div><div class="line">        pos_dist = tf.reduce_sum(tf.square(tf.subtract(anchor, positive)), <span class="number">1</span>)</div><div class="line">        neg_dist = tf.reduce_sum(tf.square(tf.subtract(anchor, negative)), <span class="number">1</span>)</div><div class="line">        basic_loss = tf.add(tf.subtract(pos_dist, neg_dist), alpha)</div><div class="line">        loss = tf.reduce_mean(tf.maximum(basic_loss, <span class="number">0.0</span>), <span class="keyword">None</span>)</div><div class="line">    <span class="keyword">return</span> loss</div><div class="line"></div><div class="line"><span class="keyword">with</span> tf.Graph().as_default():</div><div class="line">    embeddings = tf.placeholder(np.float64, shape=(batch_size, embedding_size), name=<span class="string">'embeddings'</span>)</div><div class="line">    anchor, positive, negative = tf.unstack(tf.reshape(embeddings, shape=(<span class="number">-1</span>, <span class="number">3</span>, embedding_size)), axis=<span class="number">1</span>)</div><div class="line">    triplet_loss = triplet_loss(anchor, positive, negative, alpha)</div><div class="line">    </div><div class="line">    sess = tf.Session()</div><div class="line">    <span class="keyword">with</span> sess.as_default():</div><div class="line">        np.random.seed(<span class="number">666</span>)</div><div class="line">        emb = np.random.uniform(size=[batch_size, embedding_size])</div><div class="line">        tf_triplet_loss = sess.run(triplet_loss, feed_dict=&#123;embeddings:emb&#125;)</div><div class="line">        </div><div class="line">        pos_dist_sqr = np.sum(np.square(emb[<span class="number">0</span>::<span class="number">3</span>,:]-emb[<span class="number">1</span>::<span class="number">3</span>,:]), axis=<span class="number">1</span>)        </div><div class="line">        neg_dist_sqr = np.sum(np.square(emb[<span class="number">0</span>::<span class="number">3</span>,:]-emb[<span class="number">2</span>::<span class="number">3</span>,:]), axis=<span class="number">1</span>)</div><div class="line">        np_triplet_loss = np.mean(np.maximum(<span class="number">0.</span>, pos_dist_sqr-neg_dist_sqr+alpha))</div><div class="line">        </div><div class="line">        np.testing.assert_almost_equal(tf_triplet_loss, np_triplet_loss, decimal=<span class="number">5</span>, err_msg=<span class="string">'Triplet loss is incorrect'</span>)</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15121200710041.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;ç†è§£triplet lossï¼Œä¸ç»™å‡ºTensorFlowå’Œnumpyä¸¤ç§å½¢å¼çš„example codeã€‚&lt;br&gt;
    
    </summary>
    
    
      <category term="python" scheme="http://frankchen.xyz/tags/python/"/>
    
      <category term="Algorithm" scheme="http://frankchen.xyz/tags/Algorithm/"/>
    
      <category term="TensorFlow" scheme="http://frankchen.xyz/tags/TensorFlow/"/>
    
  </entry>
  
  <entry>
    <title>æ•°æ®çš„æ ‡å‡†åŒ–ä¸å½’ä¸€åŒ–</title>
    <link href="http://frankchen.xyz/2017/11/29/Data-Normalization-and-Standardization/"/>
    <id>http://frankchen.xyz/2017/11/29/Data-Normalization-and-Standardization/</id>
    <published>2017-11-29T03:53:57.000Z</published>
    <updated>2017-12-01T11:10:13.685Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/15119359203487.png" alt=""><br>èŠä¸€èŠNormalization and Standardization<br><a id="more"></a></p><h2 id="ä»€ä¹ˆæ˜¯"><a href="#ä»€ä¹ˆæ˜¯" class="headerlink" title="ä»€ä¹ˆæ˜¯"></a>ä»€ä¹ˆæ˜¯</h2><p>Normalizationå°±æ˜¯å½’ä¸€åŒ–ï¼Œæ˜¯æœ€å°-æœ€å¤§ç¼©æ”¾(min-max scaling)çš„ç‰¹ä¾‹ï¼ŒæŒ‡çš„æ˜¯å°†æ•°æ®ç¼©æ”¾åˆ°æŒ‡å®šrangeï¼Œè¿™ä¸ªrangeé€šå¸¸æ˜¯0~1æˆ–è€…-1~+1ï¼Œç›´è§‚æ¥è®²å°±æ˜¯ä¸‹å›¾ï¼Œåœ¨æ•°æ®ä¸åŒ…å«ç¦»ç¾¤ç‚¹æ—¶å¾ˆæœ‰ç”¨ï¼Œ<br><img src="/images/Screen%20Shot%202017-11-29%20at%2012.35.41.png" alt="Screen Shot 2017-11-29 at 12.35.41"></p><p>å…¬å¼åˆ™æ˜¯</p><p>$$<br>x^{(i)}_{norm} = \frac {x^{(i)} - x_{min}} {x_{max} - x_{min}}<br>$$</p><p>è‹¥è¦ç¼©æ”¾è‡³-1~+1ï¼Œåˆ™æ˜¯<br>$$<br>xâ€™ = \frac{x - min}{max - min}<br>$$</p><p>ä»£ç å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#å¯¼å…¥æ•°æ®é¢„å¤„ç†åº“</span></div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</div><div class="line"></div><div class="line"><span class="comment">#èŒƒå›´ç¼©æ”¾æ ‡å‡†åŒ–</span></div><div class="line">min_max_scaler = preprocessing.MinMaxScaler()</div><div class="line"></div><div class="line"><span class="comment">#è®­ç»ƒé›†ç¼©æ”¾æ ‡å‡†åŒ–</span></div><div class="line">min_max_scaler.fit_transform(X_train)</div></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#æµ‹è¯•é›†ç¼©æ”¾æ ‡å‡†åŒ–</span></div><div class="line">min_max_scaler.fit_transform(X_test)</div></pre></td></tr></table></figure><p>Z-score æ ‡å‡†åŒ–æŒ‡çš„æ˜¯ï¼Œé€šè¿‡ç¼©æ”¾è®©æ•°æ®çš„å‡å€¼ä¸º0ï¼ˆç§»é™¤å‡å€¼ï¼‰ï¼Œæ ‡å‡†å·®ä¸ºå›ºå®šå€¼ï¼ˆæ¯”å¦‚1ï¼‰ã€‚åœ¨è®¸å¤šæ¨¡å‹é‡Œï¼Œå¦‚SVMçš„RBFã€çº¿æ€§æ¨¡å‹çš„ L1 &amp; L2 æ­£åˆ™é¡¹å¯¹äºæ‰€æœ‰çš„featureéƒ½æœ‰è¿™æ ·çš„å‡è®¾ã€‚<br>$$<br>x^{(i)}_{std} = \frac{x^{(i)} - \mu_x}{\sigma_x}<br>$$</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­å±•ç¤ºäº†ä¸¤è€…çš„åŒºåˆ«ï¼š</p><p><img src="/images/Screen%20Shot%202017-11-29%20at%2012.41.13.png" alt="Screen Shot 2017-11-29 at 12.41.13"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#å¯¼å…¥æ•°æ®é¢„å¤„ç†åº“</span></div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</div><div class="line"></div><div class="line"><span class="comment">#æ•°æ®æ ‡å‡†åŒ–</span></div><div class="line">scaler = preprocessing.StandardScaler().fit(X_train)</div><div class="line"></div><div class="line"><span class="comment">#è®­ç»ƒé›†æ•°æ®æ ‡å‡†åŒ–</span></div><div class="line">scaler.transform(X_train)</div></pre></td></tr></table></figure><p>åŒæ—¶å¯¹æµ‹è¯•é›†çš„æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œä»¥ä¿è¯è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„å˜æ¢æ–¹å¼ç›¸åŒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#æµ‹è¯•é›†æ•°æ®æ ‡å‡†åŒ–</span></div><div class="line">scaler.transform(X_test)</div></pre></td></tr></table></figure><h2 id="å€¼å¾—æ³¨æ„"><a href="#å€¼å¾—æ³¨æ„" class="headerlink" title="å€¼å¾—æ³¨æ„"></a>å€¼å¾—æ³¨æ„</h2><p>ä»æµç¨‹ä¸Šè®²ï¼Œæ ‡å‡†åŒ–å’Œå½’ä¸€åŒ–åº”è¯¥åœ¨è¯»å…¥æ•°æ®ã€å¤„ç†ç¼ºå¤±å€¼ï¼Œåˆ‡åˆ†è®­ç»ƒæµ‹è¯•é›†ä¹‹åï¼Œè€Œä¸”æˆ‘ä»¬è¦åšçš„æ˜¯åœ¨åˆ‡åˆ†ä¹‹åï¼Œåœ¨è®­ç»ƒé›†fitï¼Œå†å»transformæµ‹è¯•é›†ï¼Œè€Œä¸æ˜¯åœ¨æ•´ä¸ªæ•°æ®ä¸Šè½¬æ¢ä»¥åå†åˆ‡åˆ†ï¼Œå› ä¸º<strong>æ— è®ºæ˜¯æ ‡å‡†åŒ–è¿˜æ˜¯å½’ä¸€åŒ–ï¼Œæˆ‘ä»¬è¦ä¹ˆåˆ©ç”¨åˆ°äº†æ•°æ®çš„max minå€¼ï¼Œè¦ä¹ˆåˆ©ç”¨åˆ°äº†æ•°æ®çš„å‡å€¼å’Œæ ‡å‡†å·®ï¼Œè¿™äº›æ•°å€¼åœ¨è®­ç»ƒä¹‹å‰æ˜¯ä¸èƒ½è¢«æµ‹è¯•é›†æ‰€å½±å“çš„ã€‚</strong></p><p>ç±»ä¼¼äºç¼ºå¤±å€¼çš„å¡«å……ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä½¿ç”¨å‡å€¼å¡«å……ä»¥ä¸‹æ•°æ®ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#ä½¿ç”¨å‡å€¼å¡«å……ç¼ºå¤±å€¼</span></div><div class="line">imp = Imputer(missing_values=<span class="string">"NaN"</span>, strategy=<span class="string">'mean'</span>, axis=<span class="number">0</span>)</div><div class="line">imp.fit(X_train)</div><div class="line"></div><div class="line"><span class="comment">#å¡«å……è®­ç»ƒé›†</span></div><div class="line">X_train=imp.transform(X_train)</div></pre></td></tr></table></figure><p>ä»¥åŒæ ·çš„æ–¹å¼å¡«å……æµ‹è¯•é›†ï¼Œä»¥ä¿è¯æµ‹è¯•é›†å’Œè®­ç»ƒé›†çš„æ•°æ®å¡«å……æ–¹å¼ä¿æŒä¸€è‡´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#å¡«å……æµ‹è¯•é›†</span></div><div class="line">X_test=imp.transform(X_test)</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/images/15119359203487.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;èŠä¸€èŠNormalization and Standardization&lt;br&gt;
    
    </summary>
    
    
      <category term="python" scheme="http://frankchen.xyz/tags/python/"/>
    
      <category term="Data Science" scheme="http://frankchen.xyz/tags/Data-Science/"/>
    
  </entry>
  
</feed>
